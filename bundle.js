/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t,e,i={7118:function(t,e){!function(t){"use strict";var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},e(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}function n(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function r(t,e,i){if(i||2===arguments.length)for(var n,r=0,s=e.length;r<s;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var s,o=255,a=213;t.OPERATION=void 0,(s=t.OPERATION||(t.OPERATION={}))[s.ADD=128]="ADD",s[s.REPLACE=0]="REPLACE",s[s.DELETE=64]="DELETE",s[s.DELETE_AND_ADD=192]="DELETE_AND_ADD",s[s.TOUCH=1]="TOUCH",s[s.CLEAR=10]="CLEAR";var l=function(){function e(t,e,i){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=t,this.setParent(e,i)}return e.prototype.setParent=function(t,e,i){var n=this;if(this.indexes||(this.indexes=this.ref instanceof It?this.ref._definition.indexes:{}),this.parent=t,this.parentIndex=i,e)if(this.root=e,this.ref instanceof It){var r=this.ref._definition;for(var s in r.schema){var o=this.ref[s];if(o&&o.$changes){var a=r.indexes[s];o.$changes.setParent(this.ref,e,a)}}}else"object"==typeof this.ref&&this.ref.forEach((function(t,e){if(t instanceof It){var i=t.$changes,r=n.ref.$changes.indexes[e];i.setParent(n.ref,n.root,r)}}))},e.prototype.operation=function(t){this.changes.set(--this.currentCustomOperation,t)},e.prototype.change=function(e,i){void 0===i&&(i=t.OPERATION.ADD);var n="number"==typeof e?e:this.indexes[e];this.assertValidIndex(n,e);var r=this.changes.get(n);r&&r.op!==t.OPERATION.DELETE&&r.op!==t.OPERATION.TOUCH||this.changes.set(n,{op:r&&r.op===t.OPERATION.DELETE?t.OPERATION.DELETE_AND_ADD:i,index:n}),this.allChanges.add(n),this.changed=!0,this.touchParents()},e.prototype.touch=function(e){var i="number"==typeof e?e:this.indexes[e];this.assertValidIndex(i,e),this.changes.has(i)||this.changes.set(i,{op:t.OPERATION.TOUCH,index:i}),this.allChanges.add(i),this.touchParents()},e.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},e.prototype.getType=function(t){if(this.ref._definition)return(e=this.ref._definition).schema[e.fieldsByIndex[t]];var e,i=(e=this.parent._definition).schema[e.fieldsByIndex[this.parentIndex]];return Object.values(i)[0]},e.prototype.getChildrenFilter=function(){var t=this.parent._definition.childFilters;return t&&t[this.parentIndex]},e.prototype.getValue=function(t){return this.ref.getByIndex(t)},e.prototype.delete=function(e){var i="number"==typeof e?e:this.indexes[e];if(void 0!==i){var n=this.getValue(i);this.changes.set(i,{op:t.OPERATION.DELETE,index:i}),this.allChanges.delete(i),delete this.caches[i],n&&n.$changes&&(n.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema ".concat(this.ref.constructor.name,": trying to delete non-existing index: ").concat(e," (").concat(i,")"))},e.prototype.discard=function(e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=!1),this.ref instanceof It||this.changes.forEach((function(e){if(e.op===t.OPERATION.DELETE){var i=n.ref.getIndex(e.index);delete n.indexes[i]}})),this.changes.clear(),this.changed=e,i&&this.allChanges.clear(),this.currentCustomOperation=0},e.prototype.discardAll=function(){var t=this;this.changes.forEach((function(e){var i=t.getValue(e.index);i&&i.$changes&&i.$changes.discardAll()})),this.discard()},e.prototype.cache=function(t,e){this.caches[t]=e},e.prototype.clone=function(){return new e(this.ref,this.parent,this.root)},e.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},e.prototype.assertValidIndex=function(t,e){if(void 0===t)throw new Error('ChangeTree: missing index for field "'.concat(e,'"'))},e}();function u(t,e,i,n){return t[e]||(t[e]=[]),t[e].push(i),null==n||n.forEach((function(t,e){return i(t,e)})),function(){return c(t[e],t[e].indexOf(i))}}function h(e){var i=this,n="string"!=typeof this.$changes.getType();this.$items.forEach((function(r,s){e.push({refId:i.$changes.refId,op:t.OPERATION.DELETE,field:s,value:void 0,previousValue:r}),n&&i.$changes.root.removeRef(r.$changes.refId)}))}function c(t,e){if(-1===e||e>=t.length)return!1;for(var i=t.length-1,n=e;n<i;n++)t[n]=t[n+1];return t.length=i,!0}var d=function(t,e){var i=t.toString(),n=e.toString();return i<n?-1:i>n?1:0};function f(t){return t.$proxy=!0,t=new Proxy(t,{get:function(t,e){return"symbol"==typeof e||isNaN(e)?t[e]:t.at(e)},set:function(t,e,i){if("symbol"==typeof e||isNaN(e))t[e]=i;else{var n=Array.from(t.$items.keys()),r=parseInt(n[e]||e);null==i?t.deleteAt(r):t.setAt(r,i)}return!0},deleteProperty:function(t,e){return"number"==typeof e?t.deleteAt(e):delete t[e],!0},has:function(t,e){return"symbol"==typeof e||isNaN(Number(e))?Reflect.has(t,e):t.$items.has(Number(e))}})}var p=function(){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$changes=new l(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,t)}return e.prototype.onAdd=function(e,i){return void 0===i&&(i=!0),u(this.$callbacks||(this.$callbacks={}),t.OPERATION.ADD,e,i?this.$items:void 0)},e.prototype.onRemove=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},e.prototype.onChange=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},e.is=function(t){return Array.isArray(t)||void 0!==t.array},Object.defineProperty(e.prototype,"length",{get:function(){return this.$items.size},set:function(t){0===t?this.clear():this.splice(t,this.length-t)},enumerable:!1,configurable:!0}),e.prototype.push=function(){for(var t,e=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.forEach((function(i){t=e.$refId++,e.setAt(t,i)})),t},e.prototype.pop=function(){var t=Array.from(this.$indexes.values()).pop();if(void 0!==t){this.$changes.delete(t),this.$indexes.delete(t);var e=this.$items.get(t);return this.$items.delete(t),e}},e.prototype.at=function(t){if((t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length)){var e=Array.from(this.$items.keys())[t];return this.$items.get(e)}},e.prototype.setAt=function(e,i){var n,r;if(null!=i){if(this.$items.get(e)!==i){void 0!==i.$changes&&i.$changes.setParent(this,this.$changes.root,e);var s=null!==(r=null===(n=this.$changes.indexes[e])||void 0===n?void 0:n.op)&&void 0!==r?r:t.OPERATION.ADD;this.$changes.indexes[e]=e,this.$indexes.set(e,e),this.$items.set(e,i),this.$changes.change(e,s)}}else console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.")},e.prototype.deleteAt=function(t){var e=Array.from(this.$items.keys())[t];return void 0!==e&&this.$deleteAt(e)},e.prototype.$deleteAt=function(t){return this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t)},e.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&h.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.concat=function(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return new(e.bind.apply(e,r([void 0],(t=Array.from(this.$items.values())).concat.apply(t,i),!1)))},e.prototype.join=function(t){return Array.from(this.$items.values()).join(t)},e.prototype.reverse=function(){var t=this,e=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(i,n){t.setAt(e[n],i)})),this},e.prototype.shift=function(){var t=Array.from(this.$items.keys()).shift();if(void 0!==t){var e=this.$items.get(t);return this.$deleteAt(t),e}},e.prototype.slice=function(t,i){var n=new e;return n.push.apply(n,Array.from(this.$items.values()).slice(t,i)),n},e.prototype.sort=function(t){var e=this;void 0===t&&(t=d);var i=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(t).forEach((function(t,n){e.setAt(i[n],t)})),this},e.prototype.splice=function(t,e){void 0===e&&(e=this.length-t);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var r=Array.from(this.$items.keys()),s=[],o=t;o<t+e;o++)s.push(this.$items.get(r[o])),this.$deleteAt(r[o]);for(o=0;o<i.length;o++)this.setAt(t+o,i[o]);return s},e.prototype.unshift=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=this.length,r=e.length,s=Array.from(this.$items.values());return e.forEach((function(e,i){t.setAt(i,e)})),s.forEach((function(e,i){t.setAt(r+i,e)})),n+r},e.prototype.indexOf=function(t,e){return Array.from(this.$items.values()).indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return void 0===e&&(e=this.length-1),Array.from(this.$items.values()).lastIndexOf(t,e)},e.prototype.every=function(t,e){return Array.from(this.$items.values()).every(t,e)},e.prototype.some=function(t,e){return Array.from(this.$items.values()).some(t,e)},e.prototype.forEach=function(t,e){Array.from(this.$items.values()).forEach(t,e)},e.prototype.map=function(t,e){return Array.from(this.$items.values()).map(t,e)},e.prototype.filter=function(t,e){return Array.from(this.$items.values()).filter(t,e)},e.prototype.reduce=function(t,e){return Array.prototype.reduce.apply(Array.from(this.$items.values()),arguments)},e.prototype.reduceRight=function(t,e){return Array.prototype.reduceRight.apply(Array.from(this.$items.values()),arguments)},e.prototype.find=function(t,e){return Array.from(this.$items.values()).find(t,e)},e.prototype.findIndex=function(t,e){return Array.from(this.$items.values()).findIndex(t,e)},e.prototype.fill=function(t,e,i){throw new Error("ArraySchema#fill() not implemented")},e.prototype.copyWithin=function(t,e,i){throw new Error("ArraySchema#copyWithin() not implemented")},e.prototype.toString=function(){return this.$items.toString()},e.prototype.toLocaleString=function(){return this.$items.toLocaleString()},e.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.entries=function(){return this.$items.entries()},e.prototype.keys=function(){return this.$items.keys()},e.prototype.values=function(){return this.$items.values()},e.prototype.includes=function(t,e){return Array.from(this.$items.values()).includes(t,e)},e.prototype.flatMap=function(t,e){throw new Error("ArraySchema#flatMap() is not supported.")},e.prototype.flat=function(t){throw new Error("ArraySchema#flat() is not supported.")},e.prototype.findLast=function(){var t=Array.from(this.$items.values());return t.findLast.apply(t,arguments)},e.prototype.findLastIndex=function(){var t=Array.from(this.$items.values());return t.findLastIndex.apply(t,arguments)},e.prototype.with=function(t,i){var n=Array.from(this.$items.values());return n[t]=i,new(e.bind.apply(e,r([void 0],n,!1)))},e.prototype.toReversed=function(){return Array.from(this.$items.values()).reverse()},e.prototype.toSorted=function(t){return Array.from(this.$items.values()).sort(t)},e.prototype.toSpliced=function(t,e){var i=Array.from(this.$items.values());return i.toSpliced.apply(i,arguments)},e.prototype.setIndex=function(t,e){this.$indexes.set(t,e)},e.prototype.getIndex=function(t){return this.$indexes.get(t)},e.prototype.getByIndex=function(t){return this.$items.get(this.$indexes.get(t))},e.prototype.deleteByIndex=function(t){var e=this.$indexes.get(t);this.$items.delete(e),this.$indexes.delete(t)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){return this.toArray().map((function(t){return"function"==typeof t.toJSON?t.toJSON():t}))},e.prototype.clone=function(t){return t?new(e.bind.apply(e,r([void 0],Array.from(this.$items.values()),!1))):new(e.bind.apply(e,r([void 0],this.map((function(t){return t.$changes?t.clone():t})),!1)))},e}();function m(t){return t.$proxy=!0,t=new Proxy(t,{get:function(t,e){return"symbol"!=typeof e&&void 0===t[e]?t.get(e):t[e]},set:function(t,e,i){return"symbol"!=typeof e&&-1===e.indexOf("$")&&"onAdd"!==e&&"onRemove"!==e&&"onChange"!==e?t.set(e,i):t[e]=i,!0},deleteProperty:function(t,e){return t.delete(e),!0}})}var g=function(){function e(t){var i=this;if(this.$changes=new l(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,t)if(t instanceof Map||t instanceof e)t.forEach((function(t,e){return i.set(e,t)}));else for(var n in t)this.set(n,t[n])}return e.prototype.onAdd=function(e,i){return void 0===i&&(i=!0),u(this.$callbacks||(this.$callbacks={}),t.OPERATION.ADD,e,i?this.$items:void 0)},e.prototype.onRemove=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},e.prototype.onChange=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},e.is=function(t){return void 0!==t.map},e.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.set=function(e,i){if(null==i)throw new Error("MapSchema#set('".concat(e,"', ").concat(i,"): trying to set ").concat(i," value on '").concat(e,"'."));e=e.toString();var n=void 0!==this.$changes.indexes[e],r=n?this.$changes.indexes[e]:this.$refId++,s=n?t.OPERATION.REPLACE:t.OPERATION.ADD,o=void 0!==i.$changes;if(o&&i.$changes.setParent(this,this.$changes.root,r),n){if(!o&&this.$items.get(e)===i)return;o&&this.$items.get(e)!==i&&(s=t.OPERATION.ADD)}else this.$changes.indexes[e]=r,this.$indexes.set(r,e);return this.$items.set(e,i),this.$changes.change(e,s),this},e.prototype.get=function(t){return this.$items.get(t)},e.prototype.delete=function(t){return this.$changes.delete(t.toString()),this.$items.delete(t)},e.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&h.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(t){return this.$items.has(t)},e.prototype.forEach=function(t){this.$items.forEach(t)},e.prototype.entries=function(){return this.$items.entries()},e.prototype.keys=function(){return this.$items.keys()},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(t,e){this.$indexes.set(t,e)},e.prototype.getIndex=function(t){return this.$indexes.get(t)},e.prototype.getByIndex=function(t){return this.$items.get(this.$indexes.get(t))},e.prototype.deleteByIndex=function(t){var e=this.$indexes.get(t);this.$items.delete(e),this.$indexes.delete(t)},e.prototype.toJSON=function(){var t={};return this.forEach((function(e,i){t[i]="function"==typeof e.toJSON?e.toJSON():e})),t},e.prototype.clone=function(t){var i;return t?i=Object.assign(new e,this):(i=new e,this.forEach((function(t,e){t.$changes?i.set(e,t.clone()):i.set(e,t)}))),i},e}(),v={};function y(t,e){v[t]=e}function x(t){return v[t]}var _=function(){function t(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return t.create=function(e){var i=new t;return i.schema=Object.assign({},e&&e.schema||{}),i.indexes=Object.assign({},e&&e.indexes||{}),i.fieldsByIndex=Object.assign({},e&&e.fieldsByIndex||{}),i.descriptors=Object.assign({},e&&e.descriptors||{}),i.deprecated=Object.assign({},e&&e.deprecated||{}),i},t.prototype.addField=function(t,e){var i=this.getNextFieldIndex();this.fieldsByIndex[i]=t,this.indexes[t]=i,this.schema[t]=Array.isArray(e)?{array:e[0]}:e},t.prototype.hasField=function(t){return void 0!==this.indexes[t]},t.prototype.addFilter=function(t,e){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[t]]=e,this.indexesWithFilters.push(this.indexes[t]),!0},t.prototype.addChildrenFilter=function(t,e){var i=this.indexes[t],n=this.schema[t];if(x(Object.keys(n)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[i]=e,!0;console.warn("@filterChildren: field '".concat(t,"' can't have children. Ignoring filter."))},t.prototype.getChildrenFilter=function(t){return this.childFilters&&this.childFilters[this.indexes[t]]},t.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},t}();function b(t){return t._context&&t._context.useFilters}var w=function(){function t(){this.types={},this.schemas=new Map,this.useFilters=!1}return t.prototype.has=function(t){return this.schemas.has(t)},t.prototype.get=function(t){return this.types[t]},t.prototype.add=function(t,e){void 0===e&&(e=this.schemas.size),t._definition=_.create(t._definition),t._typeid=e,this.types[e]=t,this.schemas.set(t,e)},t.create=function(e){return void 0===e&&(e={}),function(i){return e.context||(e.context=new t),C(i,e)}},t}(),S=new w;function C(t,e){return void 0===e&&(e={}),function(i,n){var s=e.context||S,o=i.constructor;if(o._context=s,!t)throw new Error("".concat(o.name,': @type() reference provided for "').concat(n,"\" is undefined. Make sure you don't have any circular dependencies."));s.has(o)||s.add(o);var a=o._definition;if(a.addField(n,t),a.descriptors[n]){if(a.deprecated[n])return;try{throw new Error("@colyseus/schema: Duplicate '".concat(n,"' definition on '").concat(o.name,"'.\nCheck @type() annotation"))}catch(t){var l=t.stack.split("\n")[4].trim();throw new Error("".concat(t.message," ").concat(l))}}var u=p.is(t),h=!u&&g.is(t);if("string"!=typeof t&&!It.is(t)){var c=Object.values(t)[0];"string"==typeof c||s.has(c)||s.add(c)}if(e.manual)a.descriptors[n]={enumerable:!0,configurable:!0,writable:!0};else{var d="_".concat(n);a.descriptors[d]={enumerable:!1,configurable:!1,writable:!0},a.descriptors[n]={get:function(){return this[d]},set:function(t){t!==this[d]&&(null!=t?(!u||t instanceof p||(t=new(p.bind.apply(p,r([void 0],t,!1)))),!h||t instanceof g||(t=new g(t)),void 0===t.$proxy&&(h?t=m(t):u&&(t=f(t))),this.$changes.change(n),t.$changes&&t.$changes.setParent(this,this.$changes.root,this._definition.indexes[n])):this[d]&&this.$changes.delete(n),this[d]=t)},enumerable:!0,configurable:!0}}}}function A(t){return function(e,i){var n=e.constructor;n._definition.addFilter(i,t)&&(n._context.useFilters=!0)}}function T(t){return function(e,i){var n=e.constructor;n._definition.addChildrenFilter(i,t)&&(n._context.useFilters=!0)}}function P(t){return void 0===t&&(t=!0),function(e,i){var n=e.constructor._definition;n.deprecated[i]=!0,t&&(n.descriptors[i]={get:function(){throw new Error("".concat(i," is deprecated."))},set:function(t){},enumerable:!1,configurable:!0})}}function M(t,e,i){for(var n in void 0===i&&(i={}),i.context||(i.context=t._context||i.context||S),e)C(e[n],i)(t.prototype,n);return t}function I(t){for(var e=0,i=0,n=0,r=t.length;n<r;n++)(e=t.charCodeAt(n))<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(n++,i+=4);return i}function O(t,e,i){for(var n=0,r=0,s=i.length;r<s;r++)(n=i.charCodeAt(r))<128?t[e++]=n:n<2048?(t[e++]=192|n>>6,t[e++]=128|63&n):n<55296||n>=57344?(t[e++]=224|n>>12,t[e++]=128|n>>6&63,t[e++]=128|63&n):(r++,n=65536+((1023&n)<<10|1023&i.charCodeAt(r)),t[e++]=240|n>>18,t[e++]=128|n>>12&63,t[e++]=128|n>>6&63,t[e++]=128|63&n)}function k(t,e){t.push(255&e)}function E(t,e){t.push(255&e)}function R(t,e){t.push(255&e),t.push(e>>8&255)}function z(t,e){t.push(255&e),t.push(e>>8&255)}function F(t,e){t.push(255&e),t.push(e>>8&255),t.push(e>>16&255),t.push(e>>24&255)}function U(t,e){var i=e>>24,n=e>>16,r=e>>8,s=e;t.push(255&s),t.push(255&r),t.push(255&n),t.push(255&i)}function D(t,e){var i=Math.floor(e/Math.pow(2,32));U(t,e>>>0),U(t,i)}function B(t,e){var i=e/Math.pow(2,32)|0;U(t,e>>>0),U(t,i)}function L(t,e){j(t,e)}function N(t,e){H(t,e)}var $=new Int32Array(2),V=new Float32Array($.buffer),G=new Float64Array($.buffer);function j(t,e){V[0]=e,F(t,$[0])}function H(t,e){G[0]=e,F(t,$[0]),F(t,$[1])}function W(t,e){return E(t,e?1:0)}function X(t,e){e||(e="");var i=I(e),n=0;if(i<32)t.push(160|i),n=1;else if(i<256)t.push(217),E(t,i),n=2;else if(i<65536)t.push(218),z(t,i),n=3;else{if(!(i<4294967296))throw new Error("String too long");t.push(219),U(t,i),n=5}return O(t,t.length,e),n+i}function Y(t,e){return isNaN(e)?Y(t,0):isFinite(e)?e!==(0|e)?(t.push(203),H(t,e),9):e>=0?e<128?(E(t,e),1):e<256?(t.push(204),E(t,e),2):e<65536?(t.push(205),z(t,e),3):e<4294967296?(t.push(206),U(t,e),5):(t.push(207),B(t,e),9):e>=-32?(t.push(224|e+32),1):e>=-128?(t.push(208),k(t,e),2):e>=-32768?(t.push(209),R(t,e),3):e>=-2147483648?(t.push(210),F(t,e),5):(t.push(211),D(t,e),9):Y(t,e>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var q=Object.freeze({__proto__:null,boolean:W,float32:L,float64:N,int16:R,int32:F,int64:D,int8:k,number:Y,string:X,uint16:z,uint32:U,uint64:B,uint8:E,utf8Write:O,writeFloat32:j,writeFloat64:H});function K(t,e,i){for(var n="",r=0,s=e,o=e+i;s<o;s++){var a=t[s];128&a?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(r=(7&a)<<18|(63&t[++s])<<12|(63&t[++s])<<6|63&t[++s])>=65536?(r-=65536,n+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):n+=String.fromCharCode(r):n+=String.fromCharCode((15&a)<<12|(63&t[++s])<<6|63&t[++s]):n+=String.fromCharCode((31&a)<<6|63&t[++s]):n+=String.fromCharCode(a)}return n}function Z(t,e){return Q(t,e)<<24>>24}function Q(t,e){return t[e.offset++]}function J(t,e){return tt(t,e)<<16>>16}function tt(t,e){return t[e.offset++]|t[e.offset++]<<8}function et(t,e){return t[e.offset++]|t[e.offset++]<<8|t[e.offset++]<<16|t[e.offset++]<<24}function it(t,e){return et(t,e)>>>0}function nt(t,e){return ht(t,e)}function rt(t,e){return ct(t,e)}function st(t,e){var i=it(t,e);return et(t,e)*Math.pow(2,32)+i}function ot(t,e){var i=it(t,e);return it(t,e)*Math.pow(2,32)+i}var at=new Int32Array(2),lt=new Float32Array(at.buffer),ut=new Float64Array(at.buffer);function ht(t,e){return at[0]=et(t,e),lt[0]}function ct(t,e){return at[0]=et(t,e),at[1]=et(t,e),ut[0]}function dt(t,e){return Q(t,e)>0}function ft(t,e){var i,n=t[e.offset++];n<192?i=31&n:217===n?i=Q(t,e):218===n?i=tt(t,e):219===n&&(i=it(t,e));var r=K(t,e.offset,i);return e.offset+=i,r}function pt(t,e){var i=t[e.offset];return i<192&&i>160||217===i||218===i||219===i}function mt(t,e){var i=t[e.offset++];return i<128?i:202===i?ht(t,e):203===i?ct(t,e):204===i?Q(t,e):205===i?tt(t,e):206===i?it(t,e):207===i?ot(t,e):208===i?Z(t,e):209===i?J(t,e):210===i?et(t,e):211===i?st(t,e):i>223?-1*(255-i+1):void 0}function gt(t,e){var i=t[e.offset];return i<128||i>=202&&i<=211}function vt(t,e){return t[e.offset]<160}function yt(t,e){return t[e.offset-1]===o&&(t[e.offset]<128||t[e.offset]>=202&&t[e.offset]<=211)}var xt=Object.freeze({__proto__:null,arrayCheck:vt,boolean:dt,float32:nt,float64:rt,int16:J,int32:et,int64:st,int8:Z,number:mt,numberCheck:gt,readFloat32:ht,readFloat64:ct,string:ft,stringCheck:pt,switchStructureCheck:yt,uint16:tt,uint32:it,uint64:ot,uint8:Q}),_t=function(){function e(t){var e=this;this.$changes=new l(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,t&&t.forEach((function(t){return e.add(t)}))}return e.prototype.onAdd=function(e,i){return void 0===i&&(i=!0),u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.ADD,e,i?this.$items:void 0)},e.prototype.onRemove=function(e){return u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.DELETE,e)},e.prototype.onChange=function(e){return u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.REPLACE,e)},e.is=function(t){return void 0!==t.collection},e.prototype.add=function(t){var e=this.$refId++;return void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,e),this.$changes.indexes[e]=e,this.$indexes.set(e,e),this.$items.set(e,t),this.$changes.change(e),e},e.prototype.at=function(t){var e=Array.from(this.$items.keys())[t];return this.$items.get(e)},e.prototype.entries=function(){return this.$items.entries()},e.prototype.delete=function(t){for(var e,i,n=this.$items.entries();(i=n.next())&&!i.done;)if(t===i.value[1]){e=i.value[0];break}return void 0!==e&&(this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e))},e.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&h.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(t){return Array.from(this.$items.values()).some((function(e){return e===t}))},e.prototype.forEach=function(t){var e=this;this.$items.forEach((function(i,n,r){return t(i,n,e)}))},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(t,e){this.$indexes.set(t,e)},e.prototype.getIndex=function(t){return this.$indexes.get(t)},e.prototype.getByIndex=function(t){return this.$items.get(this.$indexes.get(t))},e.prototype.deleteByIndex=function(t){var e=this.$indexes.get(t);this.$items.delete(e),this.$indexes.delete(t)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){var t=[];return this.forEach((function(e,i){t.push("function"==typeof e.toJSON?e.toJSON():e)})),t},e.prototype.clone=function(t){var i;return t?i=Object.assign(new e,this):(i=new e,this.forEach((function(t){t.$changes?i.add(t.clone()):i.add(t)}))),i},e}(),bt=function(){function e(t){var e=this;this.$changes=new l(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,t&&t.forEach((function(t){return e.add(t)}))}return e.prototype.onAdd=function(e,i){return void 0===i&&(i=!0),u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.ADD,e,i?this.$items:void 0)},e.prototype.onRemove=function(e){return u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.DELETE,e)},e.prototype.onChange=function(e){return u(this.$callbacks||(this.$callbacks=[]),t.OPERATION.REPLACE,e)},e.is=function(t){return void 0!==t.set},e.prototype.add=function(e){var i,n;if(this.has(e))return!1;var r=this.$refId++;void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,r);var s=null!==(n=null===(i=this.$changes.indexes[r])||void 0===i?void 0:i.op)&&void 0!==n?n:t.OPERATION.ADD;return this.$changes.indexes[r]=r,this.$indexes.set(r,r),this.$items.set(r,e),this.$changes.change(r,s),r},e.prototype.entries=function(){return this.$items.entries()},e.prototype.delete=function(t){for(var e,i,n=this.$items.entries();(i=n.next())&&!i.done;)if(t===i.value[1]){e=i.value[0];break}return void 0!==e&&(this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e))},e.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&h.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(t){for(var e,i=this.$items.values(),n=!1;(e=i.next())&&!e.done;)if(t===e.value){n=!0;break}return n},e.prototype.forEach=function(t){var e=this;this.$items.forEach((function(i,n,r){return t(i,n,e)}))},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(t,e){this.$indexes.set(t,e)},e.prototype.getIndex=function(t){return this.$indexes.get(t)},e.prototype.getByIndex=function(t){return this.$items.get(this.$indexes.get(t))},e.prototype.deleteByIndex=function(t){var e=this.$indexes.get(t);this.$items.delete(e),this.$indexes.delete(t)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){var t=[];return this.forEach((function(e,i){t.push("function"==typeof e.toJSON?e.toJSON():e)})),t},e.prototype.clone=function(t){var i;return t?i=Object.assign(new e,this):(i=new e,this.forEach((function(t){t.$changes?i.add(t.clone()):i.add(t)}))),i},e}(),wt=function(){function t(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return t.prototype.addRefId=function(t){this.refIds.has(t)||(this.refIds.add(t),this.containerIndexes.set(t,new Set))},t.get=function(e){return void 0===e.$filterState&&(e.$filterState=new t),e.$filterState},t}(),St=function(){function t(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return t.prototype.getNextUniqueId=function(){return this.nextUniqueId++},t.prototype.addRef=function(t,e,i){void 0===i&&(i=!0),this.refs.set(t,e),i&&(this.refCounts[t]=(this.refCounts[t]||0)+1)},t.prototype.removeRef=function(t){var e=this.refCounts[t];void 0!==e?0!==e?(this.refCounts[t]=e-1,this.deletedRefs.add(t)):console.warn("trying to remove reference ".concat(t," with 0 refCount")):console.warn("trying to remove reference ".concat(t," that doesn't exist"))},t.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},t.prototype.garbageCollectDeletedRefs=function(){var t=this;this.deletedRefs.forEach((function(e){if(!(t.refCounts[e]>0)){var i=t.refs.get(e);if(i instanceof It)for(var n in i._definition.schema)"string"!=typeof i._definition.schema[n]&&i[n]&&i[n].$changes&&t.removeRef(i[n].$changes.refId);else{var r=i.$changes.parent._definition,s=r.schema[r.fieldsByIndex[i.$changes.parentIndex]];"function"==typeof Object.values(s)[0]&&Array.from(i.values()).forEach((function(e){return t.removeRef(e.$changes.refId)}))}t.refs.delete(e),delete t.refCounts[e]}})),this.deletedRefs.clear()},t}(),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Error);function At(t,e,i,n){var r,s=!1;switch(e){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":r="number",isNaN(t)&&console.log('trying to encode "NaN" in '.concat(i.constructor.name,"#").concat(n));break;case"string":r="string",s=!0;break;case"boolean":return}if(typeof t!==r&&(!s||s&&null!==t)){var o="'".concat(JSON.stringify(t),"'").concat(t&&t.constructor&&" (".concat(t.constructor.name,")")||"");throw new Ct("a '".concat(r,"' was expected, but ").concat(o," was provided in ").concat(i.constructor.name,"#").concat(n))}}function Tt(t,e,i,n){if(!(t instanceof e))throw new Ct("a '".concat(e.name,"' was expected, but '").concat(t.constructor.name,"' was provided in ").concat(i.constructor.name,"#").concat(n))}function Pt(t,e,i,n,r){At(i,t,n,r);var s=q[t];if(!s)throw new Ct("a '".concat(t,"' was expected, but ").concat(i," was provided in ").concat(n.constructor.name,"#").concat(r));s(e,i)}function Mt(t,e,i){return xt[t](e,i)}var It=function(){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Object.defineProperties(this,{$changes:{value:new l(this,void 0,new St),enumerable:!1,writable:!0},$callbacks:{value:void 0,enumerable:!1,writable:!0}});var i=this._definition.descriptors;i&&Object.defineProperties(this,i),t[0]&&this.assign(t[0])}return e.onError=function(t){console.error(t)},e.is=function(t){return t._definition&&void 0!==t._definition.schema},e.prototype.onChange=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},e.prototype.onRemove=function(e){return u(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},e.prototype.assign=function(t){return Object.assign(this,t),this},Object.defineProperty(e.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),e.prototype.setDirty=function(t,e){this.$changes.change(t,e)},e.prototype.listen=function(t,e,i){var n=this;return void 0===i&&(i=!0),this.$callbacks||(this.$callbacks={}),this.$callbacks[t]||(this.$callbacks[t]=[]),this.$callbacks[t].push(e),i&&void 0!==this[t]&&e(this[t],void 0),function(){return c(n.$callbacks[t],n.$callbacks[t].indexOf(e))}},e.prototype.decode=function(i,n,r){void 0===n&&(n={offset:0}),void 0===r&&(r=this);var s=[],a=this.$changes.root,l=i.length,u=0;for(a.refs.set(u,this);n.offset<l;){var h=i[n.offset++];if(h!=o){var c=r.$changes,d=void 0!==r._definition,f=d?h>>6<<6:h;if(f!==t.OPERATION.CLEAR){var m=d?h%(f||255):mt(i,n),v=d?r._definition.fieldsByIndex[m]:"",y=c.getType(m),_=void 0,b=void 0,w=void 0;if(d?b=r["_".concat(v)]:(b=r.getByIndex(m),(f&t.OPERATION.ADD)===t.OPERATION.ADD?(w=r instanceof g?ft(i,n):m,r.setIndex(m,w)):w=r.getIndex(m)),(f&t.OPERATION.DELETE)===t.OPERATION.DELETE&&(f!==t.OPERATION.DELETE_AND_ADD&&r.deleteByIndex(m),b&&b.$changes&&a.removeRef(b.$changes.refId),_=null),void 0!==v){if(f===t.OPERATION.DELETE);else if(e.is(y)){var S=mt(i,n);if(_=a.refs.get(S),f!==t.OPERATION.REPLACE){var C=this.getSchemaType(i,n,y);_||((_=this.createTypeInstance(C)).$changes.refId=S,b&&(_.$callbacks=b.$callbacks,b.$changes.refId&&S!==b.$changes.refId&&a.removeRef(b.$changes.refId))),a.addRef(S,_,_!==b)}}else if("string"==typeof y)_=Mt(y,i,n);else{var A=x(Object.keys(y)[0]),T=mt(i,n),P=a.refs.has(T)?b||a.refs.get(T):new A.constructor;if((_=P.clone(!0)).$changes.refId=T,b&&(_.$callbacks=b.$callbacks,b.$changes.refId&&T!==b.$changes.refId)){a.removeRef(b.$changes.refId);for(var M=b.entries(),I=void 0;(I=M.next())&&!I.done;){var O=I.value,k=O[0],E=O[1];s.push({refId:T,op:t.OPERATION.DELETE,field:k,value:void 0,previousValue:E})}}a.addRef(T,_,P!==b)}if(null!=_)if(_.$changes&&_.$changes.setParent(c.ref,c.root,m),r instanceof e)r[v]=_;else if(r instanceof g)k=w,r.$items.set(k,_),r.$changes.allChanges.add(m);else if(r instanceof p)r.setAt(m,_);else if(r instanceof _t){var R=r.add(_);r.setIndex(m,R)}else r instanceof bt&&!1!==(R=r.add(_))&&r.setIndex(m,R);b!==_&&s.push({refId:u,op:f,field:v,dynamicIndex:w,value:_,previousValue:b})}else{console.warn("@colyseus/schema: definition mismatch");for(var z={offset:n.offset};n.offset<l&&(!yt(i,n)||(z.offset=n.offset+1,!a.refs.has(mt(i,z))));)n.offset++}}else r.clear(s)}else{u=mt(i,n);var F=a.refs.get(u);if(!F)throw new Error('"refId" not found: '.concat(u));r=F}}return this._triggerChanges(s),a.garbageCollectDeletedRefs(),s},e.prototype.encode=function(i,n,r){void 0===i&&(i=!1),void 0===n&&(n=[]),void 0===r&&(r=!1);for(var s=this.$changes,a=new WeakSet,l=[s],u=1,h=0;h<u;h++){var c=l[h],d=c.ref,f=d instanceof e;c.ensureRefId(),a.add(c),c!==s&&(c.changed||i)&&(E(n,o),Y(n,c.refId));for(var p=i?Array.from(c.allChanges):Array.from(c.changes.values()),m=0,v=p.length;m<v;m++){var y=i?{op:t.OPERATION.ADD,index:p[m]}:p[m],_=y.index,b=f?d._definition.fieldsByIndex&&d._definition.fieldsByIndex[_]:_,w=n.length;if(y.op!==t.OPERATION.TOUCH)if(f)E(n,_|y.op);else{if(E(n,y.op),y.op===t.OPERATION.CLEAR)continue;Y(n,_)}if(f||(y.op&t.OPERATION.ADD)!=t.OPERATION.ADD||d instanceof g&&X(n,c.ref.$indexes.get(_)),y.op!==t.OPERATION.DELETE){var S=c.getType(_),C=c.getValue(_);if(C&&C.$changes&&!a.has(C.$changes)&&(l.push(C.$changes),C.$changes.ensureRefId(),u++),y.op!==t.OPERATION.TOUCH){if(e.is(S))Tt(C,S,d,b),Y(n,C.$changes.refId),(y.op&t.OPERATION.ADD)===t.OPERATION.ADD&&this.tryEncodeTypeId(n,S,C.constructor);else if("string"==typeof S)Pt(S,n,C,d,b);else{var A=x(Object.keys(S)[0]);Tt(d["_".concat(b)],A.constructor,d,b),Y(n,C.$changes.refId)}r&&c.cache(_,n.slice(w))}}}i||r||c.discard()}return n},e.prototype.encodeAll=function(t){return this.encode(!0,[],t)},e.prototype.applyFilters=function(i,n){var r,s;void 0===n&&(n=!1);for(var a=this,l=new Set,u=wt.get(i),h=[this.$changes],c=1,d=[],f=function(f){var p=h[f];if(l.has(p.refId))return"continue";var m=p.ref,v=m instanceof e;E(d,o),Y(d,p.refId);var y=u.refIds.has(p),x=n||!y;u.addRefId(p);var _=u.containerIndexes.get(p),b=x?Array.from(p.allChanges):Array.from(p.changes.values());!n&&v&&m._definition.indexesWithFilters&&m._definition.indexesWithFilters.forEach((function(e){!_.has(e)&&p.allChanges.has(e)&&(x?b.push(e):b.push({op:t.OPERATION.ADD,index:e}))}));for(var w=0,S=b.length;w<S;w++){var C=x?{op:t.OPERATION.ADD,index:b[w]}:b[w];if(C.op!==t.OPERATION.CLEAR){var A=C.index;if(C.op!==t.OPERATION.DELETE){var T=p.getValue(A),P=p.getType(A);if(v){if((M=m._definition.filters&&m._definition.filters[A])&&!M.call(m,i,T,a)){T&&T.$changes&&l.add(T.$changes.refId);continue}}else{var M,I=p.parent;if((M=p.getChildrenFilter())&&!M.call(I,i,m.$indexes.get(A),T,a)){T&&T.$changes&&l.add(T.$changes.refId);continue}}if(T.$changes&&(h.push(T.$changes),c++),C.op!==t.OPERATION.TOUCH)if(C.op===t.OPERATION.ADD||v)d.push.apply(d,null!==(r=p.caches[A])&&void 0!==r?r:[]),_.add(A);else if(_.has(A))d.push.apply(d,null!==(s=p.caches[A])&&void 0!==s?s:[]);else{if(_.add(A),E(d,t.OPERATION.ADD),Y(d,A),m instanceof g){var O=p.ref.$indexes.get(A);X(d,O)}T.$changes?Y(d,T.$changes.refId):q[P](d,T)}else T.$changes&&!v&&(E(d,t.OPERATION.ADD),Y(d,A),m instanceof g&&(O=p.ref.$indexes.get(A),X(d,O)),Y(d,T.$changes.refId))}else v?E(d,C.op|A):(E(d,C.op),Y(d,A))}else E(d,C.op)}},p=0;p<c;p++)f(p);return d},e.prototype.clone=function(){var t,e=new this.constructor,i=this._definition.schema;for(var n in i)"object"==typeof this[n]&&"function"==typeof(null===(t=this[n])||void 0===t?void 0:t.clone)?e[n]=this[n].clone():e[n]=this[n];return e},e.prototype.toJSON=function(){var t=this._definition.schema,e=this._definition.deprecated,i={};for(var n in t)e[n]||null===this[n]||void 0===this[n]||(i[n]="function"==typeof this[n].toJSON?this[n].toJSON():this["_".concat(n)]);return i},e.prototype.discardAllChanges=function(){this.$changes.discardAll()},e.prototype.getByIndex=function(t){return this[this._definition.fieldsByIndex[t]]},e.prototype.deleteByIndex=function(t){this[this._definition.fieldsByIndex[t]]=void 0},e.prototype.tryEncodeTypeId=function(t,e,i){e._typeid!==i._typeid&&(E(t,a),Y(t,i._typeid))},e.prototype.getSchemaType=function(t,e,i){var n;return t[e.offset]===a&&(e.offset++,n=this.constructor._context.get(mt(t,e))),n||i},e.prototype.createTypeInstance=function(t){var e=new t;return e.$changes.root=this.$changes.root,e},e.prototype._triggerChanges=function(i){for(var n,r,s,o,a,l,u,h,c,d=new Set,f=this.$changes.root.refs,p=function(p){var m=i[p],g=m.refId,v=f.get(g),y=v.$callbacks;if((m.op&t.OPERATION.DELETE)===t.OPERATION.DELETE&&m.previousValue instanceof e&&(null===(r=null===(n=m.previousValue.$callbacks)||void 0===n?void 0:n[t.OPERATION.DELETE])||void 0===r||r.forEach((function(t){return t()}))),!y)return"continue";if(v instanceof e){if(!d.has(g))try{null===(s=null==y?void 0:y[t.OPERATION.REPLACE])||void 0===s||s.forEach((function(t){return t()}))}catch(t){e.onError(t)}try{y.hasOwnProperty(m.field)&&(null===(o=y[m.field])||void 0===o||o.forEach((function(t){return t(m.value,m.previousValue)})))}catch(t){e.onError(t)}}else m.op===t.OPERATION.ADD&&void 0===m.previousValue?null===(a=y[t.OPERATION.ADD])||void 0===a||a.forEach((function(t){var e;return t(m.value,null!==(e=m.dynamicIndex)&&void 0!==e?e:m.field)})):m.op===t.OPERATION.DELETE?void 0!==m.previousValue&&(null===(l=y[t.OPERATION.DELETE])||void 0===l||l.forEach((function(t){var e;return t(m.previousValue,null!==(e=m.dynamicIndex)&&void 0!==e?e:m.field)}))):m.op===t.OPERATION.DELETE_AND_ADD&&(void 0!==m.previousValue&&(null===(u=y[t.OPERATION.DELETE])||void 0===u||u.forEach((function(t){var e;return t(m.previousValue,null!==(e=m.dynamicIndex)&&void 0!==e?e:m.field)}))),null===(h=y[t.OPERATION.ADD])||void 0===h||h.forEach((function(t){var e;return t(m.value,null!==(e=m.dynamicIndex)&&void 0!==e?e:m.field)}))),m.value!==m.previousValue&&(null===(c=y[t.OPERATION.REPLACE])||void 0===c||c.forEach((function(t){var e;return t(m.value,null!==(e=m.dynamicIndex)&&void 0!==e?e:m.field)})));d.add(g)},m=0;m<i.length;m++)p(m)},e._definition=_.create(),e}();function Ot(t){for(var e=[t.$changes],i=1,n={},r=n,s=function(t){var i=e[t];i.changes.forEach((function(t){var e=i.ref,n=t.index,s=e._definition?e._definition.fieldsByIndex[n]:e.$indexes.get(n);r[s]=i.getValue(n)}))},o=0;o<i;o++)s(o);return n}var kt={context:new w},Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),n([C("string",kt)],e.prototype,"name",void 0),n([C("string",kt)],e.prototype,"type",void 0),n([C("number",kt)],e.prototype,"referencedType",void 0),e}(It),Rt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fields=new p,e}return i(e,t),n([C("number",kt)],e.prototype,"id",void 0),n([C([Et],kt)],e.prototype,"fields",void 0),e}(It),zt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.types=new p,e}return i(e,t),e.encode=function(t){var i,n=t.constructor,r=new e;r.rootType=n._typeid;var s=function(t,e){for(var i in e){var n=new Et;n.name=i;var s=void 0;if("string"==typeof e[i])s=e[i];else{var o=e[i],a=void 0;It.is(o)?(s="ref",a=e[i]):"string"==typeof o[s=Object.keys(o)[0]]?s+=":"+o[s]:a=o[s],n.referencedType=a?a._typeid:-1}n.type=s,t.fields.push(n)}r.types.push(t)},o=null===(i=n._context)||void 0===i?void 0:i.types;for(var a in o){var l=new Rt;l.id=Number(a),s(l,o[a]._definition.schema)}return r.encodeAll()},e.decode=function(t,n){var r=new w,s=new e;s.decode(t,n);var o=s.types.reduce((function(t,e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(It),s=e.id;return t[s]=n,r.add(n,s),t}),{});s.types.forEach((function(t){var e=o[t.id];t.fields.forEach((function(t){var i;if(void 0!==t.referencedType){var n=t.type,s=o[t.referencedType];if(!s){var a=t.type.split(":");n=a[0],s=a[1]}"ref"===n?C(s,{context:r})(e.prototype,t.name):C(((i={})[n]=s,i),{context:r})(e.prototype,t.name)}else C(t.type,{context:r})(e.prototype,t.name)}))}));var a=o[s.rootType],l=new a;for(var u in a._definition.schema){var h=a._definition.schema[u];"string"!=typeof h&&(l[u]="function"==typeof h?new h:new(x(Object.keys(h)[0]).constructor))}return l},n([C([Rt],kt)],e.prototype,"types",void 0),n([C("number",kt)],e.prototype,"rootType",void 0),e}(It);y("map",{constructor:g}),y("array",{constructor:p}),y("set",{constructor:bt}),y("collection",{constructor:_t}),t.ArraySchema=p,t.CollectionSchema=_t,t.Context=w,t.MapSchema=g,t.Reflection=zt,t.ReflectionField=Et,t.ReflectionType=Rt,t.Schema=It,t.SchemaDefinition=_,t.SetSchema=bt,t.decode=xt,t.defineTypes=M,t.deprecated=P,t.dumpChanges=Ot,t.encode=q,t.filter=A,t.filterChildren=T,t.hasFilter=b,t.registerType=y,t.type=C}(e)},8998:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.discordURLBuilder=void 0,e.discordURLBuilder=function(t){var e;const i=(null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.hostname)||"localhost",n=t.hostname.split("."),r=!t.hostname.includes("trycloudflare.com")&&!t.hostname.includes("discordsays.com")&&n.length>2?`/${n[0]}`:"";return t.pathname.startsWith("/.proxy")?`${t.protocol}//${i}${r}${t.pathname}${t.search}`:`${t.protocol}//${i}/.proxy/colyseus${r}${t.pathname}${t.search}`}},2831:function(t,e,i){"use strict";var n,r,s,o,a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))},l=this&&this.__classPrivateFieldGet||function(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)},u=this&&this.__classPrivateFieldSet||function(t,e,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(t,i):r?r.value=i:e.set(t,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Auth=void 0;const h=i(4724),c=i(7850);e.Auth=class{constructor(t){this.http=t,this.settings={path:"/auth",key:"colyseus-auth-token"},n.set(this,!1),r.set(this,void 0),s.set(this,void 0),o.set(this,(0,c.createNanoEvents)()),(0,h.getItem)(this.settings.key,(t=>this.token=t))}set token(t){this.http.authToken=t}get token(){return this.http.authToken}onChange(t){const e=l(this,o,"f").on("change",t);return l(this,n,"f")||u(this,r,new Promise(((t,e)=>{this.getUserData().then((t=>{this.emitChange(Object.assign(Object.assign({},t),{token:this.token}))})).catch((t=>{this.emitChange({user:null,token:void 0})})).finally((()=>{t()}))})),"f"),u(this,n,!0,"f"),e}getUserData(){return a(this,void 0,void 0,(function*(){if(this.token)return(yield this.http.get(`${this.settings.path}/userdata`)).data;throw new Error("missing auth.token")}))}registerWithEmailAndPassword(t,e,i){return a(this,void 0,void 0,(function*(){const n=(yield this.http.post(`${this.settings.path}/register`,{body:{email:t,password:e,options:i}})).data;return this.emitChange(n),n}))}signInWithEmailAndPassword(t,e){return a(this,void 0,void 0,(function*(){const i=(yield this.http.post(`${this.settings.path}/login`,{body:{email:t,password:e}})).data;return this.emitChange(i),i}))}signInAnonymously(t){return a(this,void 0,void 0,(function*(){const e=(yield this.http.post(`${this.settings.path}/anonymous`,{body:{options:t}})).data;return this.emitChange(e),e}))}sendPasswordResetEmail(t){return a(this,void 0,void 0,(function*(){return(yield this.http.post(`${this.settings.path}/forgot-password`,{body:{email:t}})).data}))}signInWithProvider(t,e={}){return a(this,void 0,void 0,(function*(){return new Promise(((i,n)=>{const r=e.width||480,o=e.height||768,a=this.token?`?token=${this.token}`:"",h=`Login with ${t[0].toUpperCase()+t.substring(1)}`,c=this.http.client.getHttpEndpoint(`${e.prefix||`${this.settings.path}/provider`}/${t}${a}`),d=screen.width/2-r/2,f=screen.height/2-o/2;u(this,s,window.open(c,h,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+r+", height="+o+", top="+f+", left="+d),"f");const p=t=>{void 0===t.data.user&&void 0===t.data.token||(clearInterval(m),l(this,s,"f").close(),u(this,s,void 0,"f"),window.removeEventListener("message",p),void 0!==t.data.error?n(t.data.error):(i(t.data),this.emitChange(t.data)))},m=setInterval((()=>{l(this,s,"f")&&!l(this,s,"f").closed||(u(this,s,void 0,"f"),n("cancelled"),window.removeEventListener("message",p))}),200);window.addEventListener("message",p)}))}))}signOut(){return a(this,void 0,void 0,(function*(){this.emitChange({user:null,token:null})}))}emitChange(t){void 0!==t.token&&(this.token=t.token,null===t.token?(0,h.removeItem)(this.settings.key):(0,h.setItem)(this.settings.key,t.token)),l(this,o,"f").emit("change",t)}},n=new WeakMap,r=new WeakMap,s=new WeakMap,o=new WeakMap},5218:function(t,e,i){"use strict";var n,r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Client=e.MatchMakeError=void 0;const s=i(2438),o=i(2650),a=i(1477),l=i(2831),u=i(8998);class h extends Error{constructor(t,e){super(t),this.code=e,Object.setPrototypeOf(this,h.prototype)}}e.MatchMakeError=h;const c="undefined"!=typeof window&&void 0!==(null===(n=null===window||void 0===window?void 0:window.location)||void 0===n?void 0:n.hostname)?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567";e.Client=class{constructor(t=c,e){var i,n;if("string"==typeof t){const e=t.startsWith("/")?new URL(t,c):new URL(t),i="https:"===e.protocol||"wss:"===e.protocol,n=Number(e.port||(i?443:80));this.settings={hostname:e.hostname,pathname:e.pathname,port:n,secure:i}}else void 0===t.port&&(t.port=t.secure?443:80),void 0===t.pathname&&(t.pathname=""),this.settings=t;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new a.HTTP(this),this.auth=new l.Auth(this.http),this.urlBuilder=e,!this.urlBuilder&&"undefined"!=typeof window&&(null===(n=null===(i=null===window||void 0===window?void 0:window.location)||void 0===i?void 0:i.hostname)||void 0===n?void 0:n.includes("discordsays.com"))&&(this.urlBuilder=u.discordURLBuilder,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}joinOrCreate(t,e={},i){return r(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("joinOrCreate",t,e,i)}))}create(t,e={},i){return r(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("create",t,e,i)}))}join(t,e={},i){return r(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("join",t,e,i)}))}joinById(t,e={},i){return r(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("joinById",t,e,i)}))}reconnect(t,e){return r(this,void 0,void 0,(function*(){if("string"==typeof t&&"string"==typeof e)throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");const[i,n]=t.split(":");if(!i||!n)throw new Error("Invalid reconnection token format.\nThe format should be roomId:reconnectionToken");return yield this.createMatchMakeRequest("reconnect",i,{reconnectionToken:n},e)}))}getAvailableRooms(t=""){return r(this,void 0,void 0,(function*(){return(yield this.http.get(`matchmake/${t}`,{headers:{Accept:"application/json"}})).data}))}consumeSeatReservation(t,e,i){return r(this,void 0,void 0,(function*(){const n=this.createRoom(t.room.name,e);n.roomId=t.room.roomId,n.sessionId=t.sessionId;const o={sessionId:n.sessionId};t.reconnectionToken&&(o.reconnectionToken=t.reconnectionToken);const a=i||n;return n.connect(this.buildEndpoint(t.room,o),t.devMode&&(()=>r(this,void 0,void 0,(function*(){console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${n.roomId}'...`);let i=0;const s=()=>r(this,void 0,void 0,(function*(){i++;try{yield this.consumeSeatReservation(t,e,a),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${n.roomId}'`)}catch(t){i<8?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${i} out of 8)`),setTimeout(s,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}}));setTimeout(s,2e3)}))),a),new Promise(((t,e)=>{const i=(t,i)=>e(new s.ServerError(t,i));a.onError.once(i),a.onJoin.once((()=>{a.onError.remove(i),t(a)}))}))}))}createMatchMakeRequest(t,e,i={},n,s){return r(this,void 0,void 0,(function*(){const r=(yield this.http.post(`matchmake/${t}/${e}`,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)})).data;if(r.error)throw new h(r.error,r.code);return"reconnect"===t&&(r.reconnectionToken=i.reconnectionToken),yield this.consumeSeatReservation(r,n,s)}))}createRoom(t,e){return new o.Room(t,e)}buildEndpoint(t,e={}){const i=[];for(const t in e)e.hasOwnProperty(t)&&i.push(`${t}=${e[t]}`);let n=this.settings.secure?"wss://":"ws://";t.publicAddress?n+=`${t.publicAddress}`:n+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;const r=`${n}/${t.processId}/${t.roomId}?${i.join("&")}`;return this.urlBuilder?this.urlBuilder(new URL(r)):r}getHttpEndpoint(t=""){const e=t.startsWith("/")?t:`/${t}`,i=`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${e}`;return this.urlBuilder?this.urlBuilder(new URL(i)):i}getEndpointPort(){return 80!==this.settings.port&&443!==this.settings.port?`:${this.settings.port}`:""}}},4033:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Connection=void 0;const n=i(9611);e.Connection=class{constructor(){this.events={},this.transport=new n.WebSocketTransport(this.events)}send(t){this.transport.send(t)}connect(t){this.transport.connect(t)}close(t,e){this.transport.close(t,e)}get isOpen(){return this.transport.isOpen}}},1477:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.HTTP=void 0;const o=i(2438),a=s(i(1790));e.HTTP=class{constructor(t){this.client=t}get(t,e={}){return this.request("get",t,e)}post(t,e={}){return this.request("post",t,e)}del(t,e={}){return this.request("del",t,e)}put(t,e={}){return this.request("put",t,e)}request(t,e,i={}){return a[t](this.client.getHttpEndpoint(e),this.getOptions(i)).catch((t=>{var e;const i=t.statusCode,n=(null===(e=t.data)||void 0===e?void 0:e.error)||t.statusMessage||t.message;if(!i&&!n)throw t;throw new o.ServerError(i,n)}))}getOptions(t){return this.authToken&&(t.headers||(t.headers={}),t.headers.Authorization=`Bearer ${this.authToken}`),"undefined"!=typeof cc&&cc.sys&&cc.sys.isNative||(t.withCredentials=!0),t}}},837:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.utf8Length=e.utf8Read=e.ErrorCode=e.Protocol=void 0,function(t){t[t.HANDSHAKE=9]="HANDSHAKE",t[t.JOIN_ROOM=10]="JOIN_ROOM",t[t.ERROR=11]="ERROR",t[t.LEAVE_ROOM=12]="LEAVE_ROOM",t[t.ROOM_DATA=13]="ROOM_DATA",t[t.ROOM_STATE=14]="ROOM_STATE",t[t.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",t[t.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",t[t.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES"}(e.Protocol||(e.Protocol={})),function(t){t[t.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",t[t.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",t[t.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",t[t.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",t[t.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",t[t.AUTH_FAILED=4215]="AUTH_FAILED",t[t.APPLICATION_ERROR=4216]="APPLICATION_ERROR"}(e.ErrorCode||(e.ErrorCode={})),e.utf8Read=function(t,e){const i=t[e++];for(var n="",r=0,s=e,o=e+i;s<o;s++){var a=t[s];if(128&a)if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(r=(7&a)<<18|(63&t[++s])<<12|(63&t[++s])<<6|63&t[++s])>=65536?(r-=65536,n+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):n+=String.fromCharCode(r)}else n+=String.fromCharCode((15&a)<<12|(63&t[++s])<<6|63&t[++s]);else n+=String.fromCharCode((31&a)<<6|63&t[++s]);else n+=String.fromCharCode(a)}return n},e.utf8Length=function(t=""){let e=0,i=0;for(let n=0,r=t.length;n<r;n++)e=t.charCodeAt(n),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(n++,i+=4);return i+1}},2650:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Room=void 0;const o=s(i(4654)),a=i(4033),l=i(837),u=i(1204),h=i(7850),c=i(2513),d=i(7118),f=i(2438);class p{constructor(t,e){this.onStateChange=(0,c.createSignal)(),this.onError=(0,c.createSignal)(),this.onLeave=(0,c.createSignal)(),this.onJoin=(0,c.createSignal)(),this.hasJoined=!1,this.onMessageHandlers=(0,h.createNanoEvents)(),this.roomId=null,this.name=t,e&&(this.serializer=new((0,u.getSerializer)("schema")),this.rootSchema=e,this.serializer.state=new e),this.onError(((t,e)=>{var i;return null===(i=console.warn)||void 0===i?void 0:i.call(console,`colyseus.js - onError => (${t}) ${e}`)})),this.onLeave((()=>this.removeAllListeners()))}get id(){return this.roomId}connect(t,e,i=this){const n=new a.Connection;i.connection=n,n.events.onmessage=p.prototype.onMessageCallback.bind(i),n.events.onclose=function(t){var n;if(!i.hasJoined)return null===(n=console.warn)||void 0===n||n.call(console,`Room connection was closed unexpectedly (${t.code}): ${t.reason}`),void i.onError.invoke(t.code,t.reason);t.code===f.CloseCode.DEVMODE_RESTART&&e?e():(i.onLeave.invoke(t.code),i.destroy())},n.events.onerror=function(t){var e;null===(e=console.warn)||void 0===e||e.call(console,`Room, onError (${t.code}): ${t.reason}`),i.onError.invoke(t.code,t.reason)},n.connect(t)}leave(t=!0){return new Promise((e=>{this.onLeave((t=>e(t))),this.connection?t?this.connection.send([l.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(f.CloseCode.CONSENTED)}))}onMessage(t,e){return this.onMessageHandlers.on(this.getMessageHandlerKey(t),e)}send(t,e){const i=[l.Protocol.ROOM_DATA];let n;if("string"==typeof t?d.encode.string(i,t):d.encode.number(i,t),void 0!==e){const t=o.encode(e);n=new Uint8Array(i.length+t.byteLength),n.set(new Uint8Array(i),0),n.set(new Uint8Array(t),i.length)}else n=new Uint8Array(i);this.connection.send(n.buffer)}sendBytes(t,e){const i=[l.Protocol.ROOM_DATA_BYTES];let n;"string"==typeof t?d.encode.string(i,t):d.encode.number(i,t),n=new Uint8Array(i.length+(e.byteLength||e.length)),n.set(new Uint8Array(i),0),n.set(new Uint8Array(e),i.length),this.connection.send(n.buffer)}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}}onMessageCallback(t){const e=Array.from(new Uint8Array(t.data)),i=e[0];if(i===l.Protocol.JOIN_ROOM){let t=1;const i=(0,l.utf8Read)(e,t);if(t+=(0,l.utf8Length)(i),this.serializerId=(0,l.utf8Read)(e,t),t+=(0,l.utf8Length)(this.serializerId),!this.serializer){const t=(0,u.getSerializer)(this.serializerId);this.serializer=new t}e.length>t&&this.serializer.handshake&&this.serializer.handshake(e,{offset:t}),this.reconnectionToken=`${this.roomId}:${i}`,this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([l.Protocol.JOIN_ROOM])}else if(i===l.Protocol.ERROR){const t={offset:1},i=d.decode.number(e,t),n=d.decode.string(e,t);this.onError.invoke(i,n)}else if(i===l.Protocol.LEAVE_ROOM)this.leave();else if(i===l.Protocol.ROOM_DATA_SCHEMA){const t={offset:1},i=this.serializer.getState().constructor._context.get(d.decode.number(e,t)),n=new i;n.decode(e,t),this.dispatchMessage(i,n)}else if(i===l.Protocol.ROOM_STATE)e.shift(),this.setState(e);else if(i===l.Protocol.ROOM_STATE_PATCH)e.shift(),this.patch(e);else if(i===l.Protocol.ROOM_DATA){const i={offset:1},n=d.decode.stringCheck(e,i)?d.decode.string(e,i):d.decode.number(e,i),r=e.length>i.offset?o.decode(t.data,i.offset):void 0;this.dispatchMessage(n,r)}else if(i===l.Protocol.ROOM_DATA_BYTES){const t={offset:1},i=d.decode.stringCheck(e,t)?d.decode.string(e,t):d.decode.number(e,t);this.dispatchMessage(i,new Uint8Array(e.slice(t.offset)))}}setState(t){this.serializer.setState(t),this.onStateChange.invoke(this.serializer.getState())}patch(t){this.serializer.patch(t),this.onStateChange.invoke(this.serializer.getState())}dispatchMessage(t,e){var i;const n=this.getMessageHandlerKey(t);this.onMessageHandlers.events[n]?this.onMessageHandlers.emit(n,e):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",t,e):null===(i=console.warn)||void 0===i||i.call(console,`colyseus.js: onMessage() not registered for type '${t}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(t){switch(typeof t){case"function":return`$${t._typeid}`;case"string":return t;case"number":return`i${t}`;default:throw new Error("invalid message type.")}}}e.Room=p},4724:(t,e)=>{"use strict";let i;function n(){if(!i)try{i="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch(t){}return i||(i={cache:{},setItem:function(t,e){this.cache[t]=e},getItem:function(t){this.cache[t]},removeItem:function(t){delete this.cache[t]}}),i}Object.defineProperty(e,"__esModule",{value:!0}),e.getItem=e.removeItem=e.setItem=void 0,e.setItem=function(t,e){n().setItem(t,e)},e.removeItem=function(t){n().removeItem(t)},e.getItem=function(t,e){const i=n().getItem(t);"undefined"!=typeof Promise&&i instanceof Promise?i.then((t=>e(t))):e(i)}},7850:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createNanoEvents=void 0;e.createNanoEvents=()=>({emit(t,...e){let i=this.events[t]||[];for(let t=0,n=i.length;t<n;t++)i[t](...e)},events:{},on(t,e){var i;return(null===(i=this.events[t])||void 0===i?void 0:i.push(e))||(this.events[t]=[e]),()=>{var i;this.events[t]=null===(i=this.events[t])||void 0===i?void 0:i.filter((t=>e!==t))}}})},2513:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createSignal=e.EventEmitter=void 0;class i{constructor(){this.handlers=[]}register(t,e=!1){return this.handlers.push(t),this}invoke(...t){this.handlers.forEach((e=>e.apply(this,t)))}invokeAsync(...t){return Promise.all(this.handlers.map((e=>e.apply(this,t))))}remove(t){const e=this.handlers.indexOf(t);this.handlers[e]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}}e.EventEmitter=i,e.createSignal=function(){const t=new i;function e(e){return t.register(e,null===this)}return e.once=e=>{const i=function(...n){e.apply(this,n),t.remove(i)};t.register(i)},e.remove=e=>t.remove(e),e.invoke=(...e)=>t.invoke(...e),e.invokeAsync=(...e)=>t.invokeAsync(...e),e.clear=()=>t.clear(),e}},2438:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ServerError=e.CloseCode=void 0,function(t){t[t.CONSENTED=4e3]="CONSENTED",t[t.DEVMODE_RESTART=4010]="DEVMODE_RESTART"}(e.CloseCode||(e.CloseCode={}));class i extends Error{constructor(t,e){super(e),this.name="ServerError",this.code=t}}e.ServerError=i},8249:(t,e,i)=>{"use strict";e.Kj=void 0,i(5554);var n=i(5218);Object.defineProperty(e,"Kj",{enumerable:!0,get:function(){return n.Client}});var r=i(837);var s=i(2650);var o=i(2831);const a=i(9127);const l=i(194),u=i(1204);(0,u.registerSerializer)("schema",a.SchemaSerializer),(0,u.registerSerializer)("none",l.NoneSerializer)},5554:()=>{ArrayBuffer.isView||(ArrayBuffer.isView=t=>null!==t&&"object"==typeof t&&t.buffer instanceof ArrayBuffer),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window)},4654:(t,e)=>{"use strict";function i(t,e){if(this._offset=e,t instanceof ArrayBuffer)this._buffer=t,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(t))throw new Error("Invalid argument");this._buffer=t.buffer,this._view=new DataView(this._buffer,t.byteOffset,t.byteLength)}}Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0,i.prototype._array=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this._parse();return e},i.prototype._map=function(t){for(var e={},i=0;i<t;i++)e[this._parse()]=this._parse();return e},i.prototype._str=function(t){var e=function(t,e,i){for(var n="",r=0,s=e,o=e+i;s<o;s++){var a=t.getUint8(s);if(128&a)if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(r=(7&a)<<18|(63&t.getUint8(++s))<<12|(63&t.getUint8(++s))<<6|63&t.getUint8(++s))>=65536?(r-=65536,n+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):n+=String.fromCharCode(r)}else n+=String.fromCharCode((15&a)<<12|(63&t.getUint8(++s))<<6|63&t.getUint8(++s));else n+=String.fromCharCode((31&a)<<6|63&t.getUint8(++s));else n+=String.fromCharCode(a)}return n}(this._view,this._offset,t);return this._offset+=t,e},i.prototype._bin=function(t){var e=this._buffer.slice(this._offset,this._offset+t);return this._offset+=t,e},i.prototype._parse=function(){var t,e=this._view.getUint8(this._offset++),i=0,n=0,r=0,s=0;if(e<192)return e<128?e:e<144?this._map(15&e):e<160?this._array(15&e):this._str(31&e);if(e>223)return-1*(255-e+1);switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 196:return i=this._view.getUint8(this._offset),this._offset+=1,this._bin(i);case 197:return i=this._view.getUint16(this._offset),this._offset+=2,this._bin(i);case 198:return i=this._view.getUint32(this._offset),this._offset+=4,this._bin(i);case 199:if(i=this._view.getUint8(this._offset),n=this._view.getInt8(this._offset+1),this._offset+=2,-1===n){var o=this._view.getUint32(this._offset);return r=this._view.getInt32(this._offset+4),s=this._view.getUint32(this._offset+8),this._offset+=12,new Date(1e3*(4294967296*r+s)+o/1e6)}return[n,this._bin(i)];case 200:return i=this._view.getUint16(this._offset),n=this._view.getInt8(this._offset+2),this._offset+=3,[n,this._bin(i)];case 201:return i=this._view.getUint32(this._offset),n=this._view.getInt8(this._offset+4),this._offset+=5,[n,this._bin(i)];case 202:return t=this._view.getFloat32(this._offset),this._offset+=4,t;case 203:return t=this._view.getFloat64(this._offset),this._offset+=8,t;case 204:return t=this._view.getUint8(this._offset),this._offset+=1,t;case 205:return t=this._view.getUint16(this._offset),this._offset+=2,t;case 206:return t=this._view.getUint32(this._offset),this._offset+=4,t;case 207:return r=this._view.getUint32(this._offset)*Math.pow(2,32),s=this._view.getUint32(this._offset+4),this._offset+=8,r+s;case 208:return t=this._view.getInt8(this._offset),this._offset+=1,t;case 209:return t=this._view.getInt16(this._offset),this._offset+=2,t;case 210:return t=this._view.getInt32(this._offset),this._offset+=4,t;case 211:return r=this._view.getInt32(this._offset)*Math.pow(2,32),s=this._view.getUint32(this._offset+4),this._offset+=8,r+s;case 212:return n=this._view.getInt8(this._offset),this._offset+=1,0===n?void(this._offset+=1):[n,this._bin(1)];case 213:return n=this._view.getInt8(this._offset),this._offset+=1,[n,this._bin(2)];case 214:return n=this._view.getInt8(this._offset),this._offset+=1,-1===n?(t=this._view.getUint32(this._offset),this._offset+=4,new Date(1e3*t)):[n,this._bin(4)];case 215:return n=this._view.getInt8(this._offset),this._offset+=1,0===n?(r=this._view.getInt32(this._offset)*Math.pow(2,32),s=this._view.getUint32(this._offset+4),this._offset+=8,new Date(r+s)):-1===n?(r=this._view.getUint32(this._offset),s=this._view.getUint32(this._offset+4),this._offset+=8,new Date(1e3*(4294967296*(3&r)+s)+(r>>>2)/1e6)):[n,this._bin(8)];case 216:return n=this._view.getInt8(this._offset),this._offset+=1,[n,this._bin(16)];case 217:return i=this._view.getUint8(this._offset),this._offset+=1,this._str(i);case 218:return i=this._view.getUint16(this._offset),this._offset+=2,this._str(i);case 219:return i=this._view.getUint32(this._offset),this._offset+=4,this._str(i);case 220:return i=this._view.getUint16(this._offset),this._offset+=2,this._array(i);case 221:return i=this._view.getUint32(this._offset),this._offset+=4,this._array(i);case 222:return i=this._view.getUint16(this._offset),this._offset+=2,this._map(i);case 223:return i=this._view.getUint32(this._offset),this._offset+=4,this._map(i)}throw new Error("Could not parse")},e.decode=function(t,e=0){var n=new i(t,e),r=n._parse();if(n._offset!==t.byteLength)throw new Error(t.byteLength-n._offset+" trailing bytes");return r};function n(t,e,i){for(var n=0,r=0,s=i.length;r<s;r++)(n=i.charCodeAt(r))<128?t.setUint8(e++,n):n<2048?(t.setUint8(e++,192|n>>6),t.setUint8(e++,128|63&n)):n<55296||n>=57344?(t.setUint8(e++,224|n>>12),t.setUint8(e++,128|n>>6&63),t.setUint8(e++,128|63&n)):(r++,n=65536+((1023&n)<<10|1023&i.charCodeAt(r)),t.setUint8(e++,240|n>>18),t.setUint8(e++,128|n>>12&63),t.setUint8(e++,128|n>>6&63),t.setUint8(e++,128|63&n))}function r(t,e,i){var n=typeof i,s=0,o=0,a=0,l=0,u=0,h=0;if("string"===n){if(u=function(t){for(var e=0,i=0,n=0,r=t.length;n<r;n++)(e=t.charCodeAt(n))<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(n++,i+=4);return i}(i),u<32)t.push(160|u),h=1;else if(u<256)t.push(217,u),h=2;else if(u<65536)t.push(218,u>>8,u),h=3;else{if(!(u<4294967296))throw new Error("String too long");t.push(219,u>>24,u>>16,u>>8,u),h=5}return e.push({_str:i,_length:u,_offset:t.length}),h+u}if("number"===n)return Math.floor(i)===i&&isFinite(i)?i>=0?i<128?(t.push(i),1):i<256?(t.push(204,i),2):i<65536?(t.push(205,i>>8,i),3):i<4294967296?(t.push(206,i>>24,i>>16,i>>8,i),5):(a=i/Math.pow(2,32)|0,l=i>>>0,t.push(207,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):i>=-32?(t.push(i),1):i>=-128?(t.push(208,i),2):i>=-32768?(t.push(209,i>>8,i),3):i>=-2147483648?(t.push(210,i>>24,i>>16,i>>8,i),5):(a=Math.floor(i/Math.pow(2,32)),l=i>>>0,t.push(211,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):(t.push(203),e.push({_float:i,_length:8,_offset:t.length}),9);if("object"===n){if(null===i)return t.push(192),1;if(Array.isArray(i)){if((u=i.length)<16)t.push(144|u),h=1;else if(u<65536)t.push(220,u>>8,u),h=3;else{if(!(u<4294967296))throw new Error("Array too large");t.push(221,u>>24,u>>16,u>>8,u),h=5}for(s=0;s<u;s++)h+=r(t,e,i[s]);return h}if(i instanceof Date){var c=i.getTime(),d=Math.floor(c/1e3),f=1e6*(c-1e3*d);return d>=0&&f>=0&&d<=17179869183?0===f&&d<=4294967295?(t.push(214,255,d>>24,d>>16,d>>8,d),6):(a=d/4294967296,l=4294967295&d,t.push(215,255,f>>22,f>>14,f>>6,a,l>>24,l>>16,l>>8,l),10):(a=Math.floor(d/4294967296),l=d>>>0,t.push(199,12,255,f>>24,f>>16,f>>8,f,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),15)}if(i instanceof ArrayBuffer){if((u=i.byteLength)<256)t.push(196,u),h=2;else if(u<65536)t.push(197,u>>8,u),h=3;else{if(!(u<4294967296))throw new Error("Buffer too large");t.push(198,u>>24,u>>16,u>>8,u),h=5}return e.push({_bin:i,_length:u,_offset:t.length}),h+u}if("function"==typeof i.toJSON)return r(t,e,i.toJSON());var p=[],m="",g=Object.keys(i);for(s=0,o=g.length;s<o;s++)void 0!==i[m=g[s]]&&"function"!=typeof i[m]&&p.push(m);if((u=p.length)<16)t.push(128|u),h=1;else if(u<65536)t.push(222,u>>8,u),h=3;else{if(!(u<4294967296))throw new Error("Object too large");t.push(223,u>>24,u>>16,u>>8,u),h=5}for(s=0;s<u;s++)h+=r(t,e,m=p[s]),h+=r(t,e,i[m]);return h}if("boolean"===n)return t.push(i?195:194),1;if("undefined"===n)return t.push(192),1;if("function"==typeof i.toJSON)return r(t,e,i.toJSON());throw new Error("Could not encode")}e.encode=function(t){var e=[],i=[],s=r(e,i,t),o=new ArrayBuffer(s),a=new DataView(o),l=0,u=0,h=-1;i.length>0&&(h=i[0]._offset);for(var c,d=0,f=0,p=0,m=e.length;p<m;p++)if(a.setUint8(u+p,e[p]),p+1===h){if(d=(c=i[l])._length,f=u+h,c._bin)for(var g=new Uint8Array(c._bin),v=0;v<d;v++)a.setUint8(f+v,g[v]);else c._str?n(a,f,c._str):void 0!==c._float&&a.setFloat64(f,c._float);u+=d,i[++l]&&(h=i[l]._offset)}return o}},194:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoneSerializer=void 0;e.NoneSerializer=class{setState(t){}getState(){return null}patch(t){}teardown(){}handshake(t){}}},9127:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SchemaSerializer=void 0;const n=i(7118);e.SchemaSerializer=class{setState(t){return this.state.decode(t)}getState(){return this.state}patch(t){return this.state.decode(t)}teardown(){var t,e;null===(e=null===(t=this.state)||void 0===t?void 0:t.$changes)||void 0===e||e.root.clearRefs()}handshake(t,e){if(this.state){(new n.Reflection).decode(t,e)}else this.state=n.Reflection.decode(t,e)}}},1204:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSerializer=e.registerSerializer=void 0;const i={};e.registerSerializer=function(t,e){i[t]=e},e.getSerializer=function(t){const e=i[t];if(!e)throw new Error("missing serializer: "+t);return e}},9611:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebSocketTransport=void 0;const r=n(i(1591)),s=globalThis.WebSocket||r.default;e.WebSocketTransport=class{constructor(t){this.events=t}send(t){t instanceof ArrayBuffer?this.ws.send(t):Array.isArray(t)&&this.ws.send(new Uint8Array(t).buffer)}connect(t){this.ws=new s(t,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(t,e){this.ws.close(t,e)}get isOpen(){return this.ws.readyState===s.OPEN}}},6570:t=>{"use strict";function e(t,e,n){n=n||2;var s,o,a,l,c,d,p,m=e&&e.length,g=m?e[0]*n:t.length,v=i(t,0,g,n,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,n,r){var s,o,a,l=[];for(s=0,o=e.length;s<o;s++)(a=i(t,e[s]*r,s<o-1?e[s+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(u),s=0;s<l.length;s++)n=h(l[s],n);return n}(t,e,v,n)),t.length>80*n){s=a=t[0],o=l=t[1];for(var x=n;x<g;x+=n)(c=t[x])<s&&(s=c),(d=t[x+1])<o&&(o=d),c>a&&(a=c),d>l&&(l=d);p=0!==(p=Math.max(a-s,l-o))?32767/p:0}return r(v,y,n,s,o,p,0),y}function i(t,e,i,n,r){var s,o;if(r===T(t,e,i,n)>0)for(s=e;s<i;s+=n)o=S(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=S(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(C(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!v(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(C(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function r(t,e,i,u,h,c,f){if(t){!f&&c&&function(t,e,i,n){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,s,o,a,l,u=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<u&&(a++,n=n.nextZ);e++);for(l=u;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,u*=2}while(o>1)}(r)}(t,u,h,c);for(var p,m,g=t;t.prev!==t.next;)if(p=t.prev,m=t.next,c?o(t,u,h,c):s(t))e.push(p.i/i|0),e.push(t.i/i|0),e.push(m.i/i|0),C(t),t=m.next,g=m.next;else if((t=m)===g){f?1===f?r(t=a(n(t),e,i),e,i,u,h,c,2):2===f&&l(t,e,i,u,h,c):r(n(t),e,i,u,h,c,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(g(e,i,n)>=0)return!1;for(var r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,u=n.y,h=r<s?r<o?r:o:s<o?s:o,c=a<l?a<u?a:u:l<u?l:u,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=c&&m.y<=f&&p(r,a,s,l,o,u,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function o(t,e,i,n){var r=t.prev,s=t,o=t.next;if(g(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,u=o.x,h=r.y,c=s.y,f=o.y,m=a<l?a<u?a:u:l<u?l:u,v=h<c?h<f?h:f:c<f?c:f,y=a>l?a>u?a:u:l>u?l:u,x=h>c?h>f?h:f:c>f?c:f,_=d(m,v,e,i,n),b=d(y,x,e,i,n),w=t.prevZ,S=t.nextZ;w&&w.z>=_&&S&&S.z<=b;){if(w.x>=m&&w.x<=y&&w.y>=v&&w.y<=x&&w!==r&&w!==o&&p(a,h,l,c,u,f,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==r&&S!==o&&p(a,h,l,c,u,f,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;w&&w.z>=_;){if(w.x>=m&&w.x<=y&&w.y>=v&&w.y<=x&&w!==r&&w!==o&&p(a,h,l,c,u,f,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=b;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==r&&S!==o&&p(a,h,l,c,u,f,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(t,e,i){var r=t;do{var s=r.prev,o=r.next.next;!v(s,o)&&y(s,r,r.next,o)&&b(s,o)&&b(o,s)&&(e.push(s.i/i|0),e.push(r.i/i|0),e.push(o.i/i|0),C(r),C(r.next),r=t=o),r=r.next}while(r!==t);return n(r)}function l(t,e,i,s,o,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var h=w(l,u);return l=n(l,l.next),h=n(h,h.next),r(l,e,i,s,o,a,0),void r(h,e,i,s,o,a,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function h(t,e){var i=function(t,e){var i,n=e,r=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o&&(o=a,i=n.x<n.next.x?n:n.next,a===r))return i}n=n.next}while(n!==e);if(!i)return null;var l,u=i,h=i.x,d=i.y,f=1/0;n=i;do{r>=n.x&&n.x>=h&&r!==n.x&&p(s<d?r:o,s,h,d,s<d?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),b(n,t)&&(l<f||l===f&&(n.x>i.x||n.x===i.x&&c(i,n)))&&(i=n,f=l)),n=n.next}while(n!==u);return i}(t,e);if(!i)return e;var r=w(i,t);return n(r,r.next),n(i,i.next)}function c(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function p(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&y(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,i,n){var r=_(g(t,e,i)),s=_(g(t,e,n)),o=_(g(i,n,t)),a=_(g(i,n,e));return r!==s&&o!==a||(!(0!==r||!x(t,i,e))||(!(0!==s||!x(t,n,e))||(!(0!==o||!x(i,t,n))||!(0!==a||!x(i,e,n)))))}function x(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function _(t){return t>0?1:t<0?-1:0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function w(t,e){var i=new A(t.i,t.x,t.y),n=new A(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function S(t,e,i,n){var r=new A(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,i,n){for(var r=0,s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,i,n){var r=e&&e.length,s=r?e[0]*i:t.length,o=Math.abs(T(t,0,s,i));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*i,h=a<l-1?e[a+1]*i:t.length;o-=Math.abs(T(t,u,h,i))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,f=n[a+1]*i,p=n[a+2]*i;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[r][s][o]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},8133:t=>{t.exports=function(t){var r=[];return t.replace(i,(function(t,i,s){var o=i.toLowerCase();for(s=function(t){var e=t.match(n);return e?e.map(Number):[]}(s),"m"==o&&s.length>2&&(r.push([i].concat(s.splice(0,2))),o="l",i="m"==i?"l":"L");;){if(s.length==e[o])return s.unshift(i),r.push(s);if(s.length<e[o])throw new Error("malformed path data");r.push([i].concat(s.splice(0,e[o])))}})),r};var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/gi;var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},5585:t=>{"use strict";var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new r(n,s||t,o),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),a.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,o=new Array(s);r<s;r++)o[r]=n[r].fn;return o},a.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,r,s,o){var a=i?i+t:t;if(!this._events[a])return!1;var l,u,h=this._events[a],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,r),!0;case 5:return h.fn.call(h.context,e,n,r,s),!0;case 6:return h.fn.call(h.context,e,n,r,s,o),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var d,f=h.length;for(u=0;u<f;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),c){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,n);break;case 4:h[u].fn.call(h[u].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];h[u].fn.apply(h[u].context,l)}}return!0},a.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},a.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},a.prototype.removeListener=function(t,e,n,r){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||o(this,s);else{for(var l=0,u=[],h=a.length;l<h;l++)(a[l].fn!==e||r&&!a[l].once||n&&a[l].context!==n)&&u.push(a[l]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a},6908:function(t,e,i){var n,r;r="undefined"!=typeof window?window:this,void 0===(n=function(){return function(t,e){"use strict";function i(i){if(this.hasDeviceMotion="ondevicemotion"in t,this.options={threshold:15,timeout:1e3},"object"==typeof i)for(var n in i)i.hasOwnProperty(n)&&(this.options[n]=i[n]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof e.CustomEvent)this.event=new e.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof e.createEvent)return!1;this.event=e.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return i.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},i.prototype.start=function(){this.reset(),this.hasDeviceMotion&&t.addEventListener("devicemotion",this,!1)},i.prototype.stop=function(){this.hasDeviceMotion&&t.removeEventListener("devicemotion",this,!1),this.reset()},i.prototype.devicemotion=function(e){var i=e.accelerationIncludingGravity,n=0,r=0,s=0;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=i.x,this.lastY=i.y,void(this.lastZ=i.z);n=Math.abs(this.lastX-i.x),r=Math.abs(this.lastY-i.y),s=Math.abs(this.lastZ-i.z),(n>this.options.threshold&&r>this.options.threshold||n>this.options.threshold&&s>this.options.threshold||r>this.options.threshold&&s>this.options.threshold)&&(new Date).getTime()-this.lastTime.getTime()>this.options.timeout&&(t.dispatchEvent(this.event),this.lastTime=new Date),this.lastX=i.x,this.lastY=i.y,this.lastZ=i.z},i.prototype.handleEvent=function(t){if("function"==typeof this[t.type])return this[t.type](t)},i}(r,r.document)}.call(e,i,e,t))||(t.exports=n)},6723:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Collector=void 0;e.Collector=class{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}},7474:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CollectorArray=void 0;const n=i(6723);class r extends n.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}e.CollectorArray=r},5491:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CollectorLast=void 0;const n=i(6723);class r extends n.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}e.CollectorLast=r},7355:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CollectorUntil0=void 0;const n=i(6723);class r extends n.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}e.CollectorUntil0=r},7696:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CollectorWhile0=void 0;const n=i(6723);class r extends n.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}e.CollectorWhile0=r},6750:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Signal=void 0;const n=i(2738),r=i(3290);e.Signal=class{constructor(){this.head=new r.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const i=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,i.newLink=!0),new n.SignalConnectionImpl(i,(()=>this.decrementConnectionCount()))}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let i=this.head.next;i!==this.head;i=i.next)if(i.isEnabled()&&i.callback){const n=i.callback.apply(null,e);if(!t.handleResult(n))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&0===this.emitDepth){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}},2738:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignalConnectionImpl=void 0;e.SignalConnectionImpl=class{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return null!==this.link&&(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0)}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return null!==this.link&&this.link.isEnabled()}}},5473:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignalConnections=void 0;e.SignalConnections=class{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return 0===this.list.length}}},3290:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignalLink=void 0;class i{constructor(t=null,e=null,i=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=null!=t?t:this,this.next=null!=e?e:this,this.order=i}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let n=this.prev;for(;n!==this&&!(n.order<=e);)n=n.prev;const r=new i(n,n.next,e);return r.callback=t,n.next=r,r.next.prev=r,r}}e.SignalLink=i},1852:(t,e,i)=>{"use strict";e.HN=void 0;var n=i(6723);var r=i(7474);var s=i(5491);var o=i(7355);var a=i(7696);var l=i(6750);Object.defineProperty(e,"HN",{enumerable:!0,get:function(){return l.Signal}});var u=i(5473)},1591:t=>{"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},1790:(t,e,i)=>{"use strict";function n(t,e){e.headers=t.headers||{},e.statusMessage=t.statusText,e.statusCode=t.status,e.data=t.response}function r(t,e,i){return new Promise((function(r,s){i=i||{};var o,a,l,u=new XMLHttpRequest,h=i.body,c=i.headers||{};for(o in i.timeout&&(u.timeout=i.timeout),u.ontimeout=u.onerror=function(t){t.timeout="timeout"==t.type,s(t)},u.open(t,e.href||e),u.onload=function(){for(l=u.getAllResponseHeaders().trim().split(/[\r\n]+/),n(u,u);a=l.shift();)a=a.split(": "),u.headers[a.shift().toLowerCase()]=a.join(": ");if((a=u.headers["content-type"])&&~a.indexOf("application/json"))try{u.data=JSON.parse(u.data,i.reviver)}catch(t){return n(u,t),s(t)}(u.status>=400?s:r)(u)},typeof FormData<"u"&&h instanceof FormData||h&&"object"==typeof h&&(c["content-type"]="application/json",h=JSON.stringify(h)),u.withCredentials=!!i.withCredentials,c)u.setRequestHeader(o,c[o]);u.send(h)}))}i.r(e),i.d(e,{del:()=>l,get:()=>s,patch:()=>a,post:()=>o,put:()=>u,send:()=>r});var s=r.bind(r,"GET"),o=r.bind(r,"POST"),a=r.bind(r,"PATCH"),l=r.bind(r,"DELETE"),u=r.bind(r,"PUT")},1979:(t,e,i)=>{"use strict";i.d(e,{l:()=>s});var n=i(268),r=i(2406);const s=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||(0,n.R)(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=(0,r.z)(t);let s;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];if(n.test(e)){s=n.getCacheableAssets(i,e);break}}const o=new Map(Object.entries(s||{}));s||i.forEach((t=>{o.set(t,e)}));const a=[...o.keys()],l={cacheKeys:a,keys:i};i.forEach((t=>{this._cacheMap.set(t,l)})),a.forEach((t=>{const i=s?s[t]:e;this._cache.has(t)&&this._cache.get(t)!==i&&(0,n.R)("[Cache] already has key:",t),this._cache.set(t,o.get(t))}))}remove(t){if(!this._cacheMap.has(t))return void(0,n.R)(`[Assets] Asset id ${t} was not found in the Cache`);const e=this._cacheMap.get(t);e.cacheKeys.forEach((t=>{this._cache.delete(t)})),e.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}}},4589:(t,e,i)=>{"use strict";i.d(e,{T:()=>n});var n=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(n||{})},1173:(t,e,i)=>{"use strict";i.d(e,{x:()=>u});var n=i(268),r=i(2927),s=i(2406);function o(t,e,i,n,r){const s=e[i];for(let a=0;a<s.length;a++){const l=s[a];i<e.length-1?o(t.replace(n[i],l),e,i+1,n,r):r.push(t.replace(n[i],l))}}function a(t){const e=t.match(/\{(.*?)\}/g),i=[];if(e){const n=[];e.forEach((t=>{const e=t.substring(1,t.length-1).split(",");n.push(e)})),o(t,n,0,e,i)}else i.push(t);return i}var l=i(2217);class u{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}}getAlias(t){const{alias:e,src:i}=t;return(0,s.z)(e||i,(t=>"string"==typeof t?t:Array.isArray(t)?t.map((t=>t?.src??t)):t?.src?t.src:t),!0)}addManifest(t){this._manifest&&(0,n.R)("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,e){const i=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map((([t,e])=>"string"==typeof e||Array.isArray(e)?{alias:t,src:e}:{alias:t,...e}))),n.forEach((e=>{const n=e.src,r=e.alias;let s;if("string"==typeof r){const e=this._createBundleAssetId(t,r);i.push(e),s=[r,e]}else{const e=r.map((e=>this._createBundleAssetId(t,e)));i.push(...e),s=[...r,...e]}this.add({...e,alias:s,src:n})})),this._bundles[t]=i}add(t){const e=[];let i;Array.isArray(t)?e.push(...t):e.push(t),i=t=>{this.hasKey(t)&&(0,n.R)(`[Resolver] already has key: ${t} overwriting`)};(0,s.z)(e).forEach((t=>{const{src:e}=t;let{data:n,format:r,loadParser:o}=t;const l=(0,s.z)(e).map((t=>"string"==typeof t?a(t):Array.isArray(t)?t:[t])),u=this.getAlias(t);Array.isArray(u)?u.forEach(i):i(u);const h=[];l.forEach((t=>{t.forEach((t=>{let e={};if("object"!=typeof t){e.src=t;for(let i=0;i<this._parsers.length;i++){const n=this._parsers[i];if(n.test(t)){e=n.parse(t);break}}}else n=t.data??n,r=t.format??r,o=t.loadParser??o,e={...e,...t};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${e.src}`);e=this._buildResolvedAsset(e,{aliases:u,data:n,format:r,loadParser:o}),h.push(e)}))})),u.forEach((t=>{this._assetMap[t]=h}))}))}resolveBundle(t){const e=(0,l.a)(t);t=(0,s.z)(t);const i={};return t.forEach((t=>{const e=this._bundles[t];if(e){const n=this.resolve(e),r={};for(const e in n){const i=n[e];r[this._extractAssetIdFromBundle(t,e)]=i}i[t]=r}})),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const i in e)t[i]=e[i].src;return t}return e.src}resolve(t){const e=(0,l.a)(t);t=(0,s.z)(t);const i={};return t.forEach((t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const i=this._getPreferredOrder(e);i?.priority.forEach((t=>{i.params[t].forEach((i=>{const n=e.filter((e=>!!e[t]&&e[t]===i));n.length&&(e=n)}))})),this._resolverHash[t]=e[0]}else this._resolverHash[t]=this._buildResolvedAsset({alias:[t],src:t},{});i[t]=this._resolverHash[t]})),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],i=this._preferredOrder.find((t=>t.params.format.includes(e.format)));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;return`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:n,loadParser:s,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=r.A.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=s??t.loadParser,t.format=o??t.format??t.src.split(".").pop().split("?").shift().split("#").shift(),t}}u.RETINA_PREFIX=/@([0-9\.]+)x/},2406:(t,e,i)=>{"use strict";i.d(e,{z:()=>n});const n=(t,e,i=!1)=>(Array.isArray(t)||(t=[t]),e?t.map((t=>"string"==typeof t||i?e(t):t)):t)},2233:(t,e,i)=>{"use strict";i.d(e,{Y:()=>n});const n=(t,e)=>{const i=e.split("?")[1];return i&&(t+=`?${i}`),t}},2217:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});const n=t=>!Array.isArray(t)},2577:(t,e,i)=>{"use strict";i.d(e,{Q:()=>E});var n={grad:.9,turn:360,rad:360/(2*Math.PI)},r=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},s=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=Math.pow(10,e)),Math.round(i*t)/i+0},o=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),t>i?i:t>e?t:e},a=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},l=function(t){return{r:o(t.r,0,255),g:o(t.g,0,255),b:o(t.b,0,255),a:o(t.a)}},u=function(t){return{r:s(t.r),g:s(t.g),b:s(t.b),a:s(t.a,3)}},h=/^#([0-9a-f]{3,8})$/i,c=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},d=function(t){var e=t.r,i=t.g,n=t.b,r=t.a,s=Math.max(e,i,n),o=s-Math.min(e,i,n),a=o?s===e?(i-n)/o:s===i?2+(n-e)/o:4+(e-i)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:r}},f=function(t){var e=t.h,i=t.s,n=t.v,r=t.a;e=e/360*6,i/=100,n/=100;var s=Math.floor(e),o=n*(1-i),a=n*(1-(e-s)*i),l=n*(1-(1-e+s)*i),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:r}},p=function(t){return{h:a(t.h),s:o(t.s,0,100),l:o(t.l,0,100),a:o(t.a)}},m=function(t){return{h:s(t.h),s:s(t.s),l:s(t.l),a:s(t.a,3)}},g=function(t){return f((i=(e=t).s,{h:e.h,s:(i*=((n=e.l)<50?n:100-n)/100)>0?2*i/(n+i)*100:0,v:n+i,a:e.a}));var e,i,n},v=function(t){return{h:(e=d(t)).h,s:(r=(200-(i=e.s))*(n=e.v)/100)>0&&r<200?i*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,i,n,r},y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w={string:[[function(t){var e=h.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?s(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?s(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=_.exec(t)||b.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:l({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=y.exec(t)||x.exec(t);if(!e)return null;var i,r,s=p({h:(i=e[1],r=e[2],void 0===r&&(r="deg"),Number(i)*(n[r]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return g(s)},"hsl"]],object:[[function(t){var e=t.r,i=t.g,n=t.b,s=t.a,o=void 0===s?1:s;return r(e)&&r(i)&&r(n)?l({r:Number(e),g:Number(i),b:Number(n),a:Number(o)}):null},"rgb"],[function(t){var e=t.h,i=t.s,n=t.l,s=t.a,o=void 0===s?1:s;if(!r(e)||!r(i)||!r(n))return null;var a=p({h:Number(e),s:Number(i),l:Number(n),a:Number(o)});return g(a)},"hsl"],[function(t){var e=t.h,i=t.s,n=t.v,s=t.a,l=void 0===s?1:s;if(!r(e)||!r(i)||!r(n))return null;var u=function(t){return{h:a(t.h),s:o(t.s,0,100),v:o(t.v,0,100),a:o(t.a)}}({h:Number(e),s:Number(i),v:Number(n),a:Number(l)});return f(u)},"hsv"]]},S=function(t,e){for(var i=0;i<e.length;i++){var n=e[i][0](t);if(n)return[n,e[i][1]]}return[null,void 0]},C=function(t){return"string"==typeof t?S(t.trim(),w.string):"object"==typeof t&&null!==t?S(t,w.object):[null,void 0]},A=function(t,e){var i=v(t);return{h:i.h,s:o(i.s+100*e,0,100),l:i.l,a:i.a}},T=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},P=function(t,e){var i=v(t);return{h:i.h,s:i.s,l:o(i.l+100*e,0,100),a:i.a}},M=function(){function t(t){this.parsed=C(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return s(T(this.rgba),2)},t.prototype.isDark=function(){return T(this.rgba)<.5},t.prototype.isLight=function(){return T(this.rgba)>=.5},t.prototype.toHex=function(){return e=(t=u(this.rgba)).r,i=t.g,n=t.b,o=(r=t.a)<1?c(s(255*r)):"","#"+c(e)+c(i)+c(n)+o;var t,e,i,n,r,o},t.prototype.toRgb=function(){return u(this.rgba)},t.prototype.toRgbString=function(){return e=(t=u(this.rgba)).r,i=t.g,n=t.b,(r=t.a)<1?"rgba("+e+", "+i+", "+n+", "+r+")":"rgb("+e+", "+i+", "+n+")";var t,e,i,n,r},t.prototype.toHsl=function(){return m(v(this.rgba))},t.prototype.toHslString=function(){return e=(t=m(v(this.rgba))).h,i=t.s,n=t.l,(r=t.a)<1?"hsla("+e+", "+i+"%, "+n+"%, "+r+")":"hsl("+e+", "+i+"%, "+n+"%)";var t,e,i,n,r},t.prototype.toHsv=function(){return t=d(this.rgba),{h:s(t.h),s:s(t.s),v:s(t.v),a:s(t.a,3)};var t},t.prototype.invert=function(){return I({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),I(A(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),I(A(this.rgba,-t))},t.prototype.grayscale=function(){return I(A(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),I(P(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),I(P(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?I({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):s(this.rgba.a,3);var e},t.prototype.hue=function(t){var e=v(this.rgba);return"number"==typeof t?I({h:t,s:e.s,l:e.l,a:e.a}):s(e.h)},t.prototype.isEqual=function(t){return this.toHex()===I(t).toHex()},t}(),I=function(t){return t instanceof M?t:new M(t)},O=[];!function(t){t.forEach((function(t){O.indexOf(t)<0&&(t(M,w),O.push(t))}))}([function(t,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in i)n[i[r]]=r;var s={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var r,o,a=n[this.toHex()];if(a)return a;if(null==e?void 0:e.closest){var l=this.toRgb(),u=1/0,h="black";if(!s.length)for(var c in i)s[c]=new t(i[c]).toRgb();for(var d in i){var f=(r=l,o=s[d],Math.pow(r.r-o.r,2)+Math.pow(r.g-o.g,2)+Math.pow(r.b-o.b,2));f<u&&(u=f,h=d)}return h}},e.string.push([function(e){var n=e.toLowerCase(),r="transparent"===n?"#0000":i[n];return r?new t(r).toRgb():null},"name"])}]);const k=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(e){if(e instanceof t)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set Color#value to null");null!==this._value&&this._isSourceEqual(this._value,e)||(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if("number"===i||"string"===i||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every(((t,i)=>t===e[i]));if(null!==t&&null!==e){const i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every((i=>t[i]===e[i]))}return t===e}toRgba(){const[t,e,i,n]=this._components;return{r:t,g:e,b:i,a:n}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),(t=t||this._arrayRgb)[0]=Math.round(255*e),t[1]=Math.round(255*i),t[2]=Math.round(255*n),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t=t||this._arrayRgba;const[e,i,n,r]=this._components;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb;const[e,i,n]=this._components;return t[0]=e,t[1]=i,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(e){const[i,n,r,s]=t._temp.setValue(e)._components;return this._components[0]*=i,this._components[1]*=n,this._components[2]*=r,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,r=255&this._int;return e&&(i=i*t+.5|0,n=n*t+.5|0,r=r*t+.5|0),(255*t<<24)+(i<<16)+(n<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(e){let i,n,r,s;if(("number"==typeof e||e instanceof Number)&&e>=0&&e<=16777215){i=(e>>16&255)/255,n=(e>>8&255)/255,r=(255&e)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[i,n,r,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[i,n,r,s=255]=e,i/=255,n/=255,r/=255,s/=255;else if("string"==typeof e||"object"==typeof e){if("string"==typeof e){const i=t.HEX_PATTERN.exec(e);i&&(e=`#${i[2]}`)}const o=I(e);o.isValid()&&(({r:i,g:n,b:r,a:s}=o.rgba),i/=255,n/=255,r/=255)}if(void 0===i)throw new Error(`Unable to convert color ${e}`);this._components[0]=i,this._components[1]=n,this._components[2]=r,this._components[3]=s,this._refreshInt()}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*i|0)}_clamp(t,e=0,i=1){return"number"==typeof t?Math.min(Math.max(t,e),i):(t.forEach(((n,r)=>{t[r]=Math.min(Math.max(n,e),i)})),t)}static isColorLike(e){return"number"==typeof e||"string"==typeof e||e instanceof Number||e instanceof t||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||void 0!==e.r&&void 0!==e.g&&void 0!==e.b||void 0!==e.r&&void 0!==e.g&&void 0!==e.b&&void 0!==e.a||void 0!==e.h&&void 0!==e.s&&void 0!==e.l||void 0!==e.h&&void 0!==e.s&&void 0!==e.l&&void 0!==e.a||void 0!==e.h&&void 0!==e.s&&void 0!==e.v||void 0!==e.h&&void 0!==e.s&&void 0!==e.v&&void 0!==e.a}};k.shared=new k,k._temp=new k,k.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let E=k},1761:(t,e,i)=>{"use strict";i.d(e,{e:()=>r});let n={createCanvas:(t,e)=>{const i=document.createElement("canvas");return i.width=t,i.height=e,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")};const r={get:()=>n,set(t){n=t}}},8507:(t,e,i)=>{"use strict";i.d(e,{Ag:()=>n,XO:()=>o});var n=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(n||{});const r=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},s=(t,e)=>r(t).priority??e,o={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(r).forEach((t=>{t.type.forEach((e=>this._removeHandlers[e]?.(t)))})),this},add(...t){return t.map(r).forEach((t=>{t.type.forEach((e=>{const i=this._addHandlers,n=this._queue;i[e]?i[e]?.(t):(n[e]=n[e]||[],n[e]?.push(t))}))})),this},handle(t,e,i){const n=this._addHandlers,r=this._removeHandlers;if(n[t]||r[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,r[t]=i;const s=this._queue;return s[t]&&(s[t]?.forEach((t=>e(t))),delete s[t]),this},handleByMap(t,e){return this.handle(t,(t=>{t.name&&(e[t.name]=t.ref)}),(t=>{t.name&&delete e[t.name]}))},handleByNamedList(t,e,i=-1){return this.handle(t,(t=>{e.findIndex((e=>e.name===t.name))>=0||(e.push({name:t.name,value:t.ref}),e.sort(((t,e)=>s(e.value,i)-s(t.value,i))))}),(t=>{const i=e.findIndex((e=>e.name===t.name));-1!==i&&e.splice(i,1)}))},handleByList(t,e,i=-1){return this.handle(t,(t=>{e.includes(t.ref)||(e.push(t.ref),e.sort(((t,e)=>s(e,i)-s(t,i))))}),(t=>{const i=e.indexOf(t.ref);-1!==i&&e.splice(i,1)}))}}},6554:(t,e,i)=>{"use strict";i.d(e,{d:()=>l});var n=i(9113),r=i(3012),s=i(8475),o=i(7547);const a=class t extends s.M{constructor(e){super(e={...t.defaultOptions,...e}),this.enabled=!0,this._state=o.U.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,"boolean"==typeof e.antialias?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,i,n){t.applyFilter(this,e,i,n)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(e){const{gpu:i,gl:s,...o}=e;let a,l;return i&&(a=r.B.from(i)),s&&(l=n.M.from(s)),new t({gpuProgram:a,glProgram:l,...o})}};a.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let l=a},9049:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});class n{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}},9313:(t,e,i)=>{"use strict";i.d(e,{u:()=>s});var n=i(1652),r=i(5101);class s{constructor(t=1,e=0,i=0,n=1,r=0,s=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=s}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,n,r,s){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=s,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new r.b;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new r.b;const i=this.a,n=this.b,s=this.c,o=this.d,a=this.tx,l=this.ty,u=1/(i*o+s*-n),h=t.x,c=t.y;return e.x=o*u*h+-s*u*c+(l*s-a*o)*u,e.y=i*u*c+-n*u*h+(-l*i+a*n)*u,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,s=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this}append(t){const e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this}appendFrom(t,e){const i=t.a,n=t.b,r=t.c,s=t.d,o=t.tx,a=t.ty,l=e.a,u=e.b,h=e.c,c=e.d;return this.a=i*l+n*h,this.b=i*u+n*c,this.c=r*l+s*h,this.d=r*u+s*c,this.tx=o*l+a*h+e.tx,this.ty=o*u+a*c+e.ty,this}setTransform(t,e,i,n,r,s,o,a,l){return this.a=Math.cos(o+l)*r,this.b=Math.sin(o+l)*r,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,i=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,s=this.d,o=t.pivot,a=-Math.atan2(-r,s),l=Math.atan2(i,e),u=Math.abs(a+l);return u<1e-5||Math.abs(n.TO-u)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+s*s),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*s),t}invert(){const t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,s=t*n-e*i;return this.a=n/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-n*r)/s,this.ty=-(t*this.ty-e*r)/s,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new s;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return a.identity()}static get shared(){return o.identity()}}const o=new s,a=new s},1652:(t,e,i)=>{"use strict";i.d(e,{TO:()=>n,Td:()=>s,bO:()=>r});const n=2*Math.PI,r=180/Math.PI,s=Math.PI/180},9939:(t,e,i)=>{"use strict";function n(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function r(t){return!(t&t-1||!t)}i.d(e,{U5:()=>n,f3:()=>r})},2812:(t,e,i)=>{"use strict";i.d(e,{o:()=>n});class n{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new n(t??this._observer,this._x,this._y)}set(t=0,e=t){return this._x===t&&this._y===e||(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}},5101:(t,e,i)=>{"use strict";i.d(e,{b:()=>n});class n{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new n(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return r.x=0,r.y=0,r}}const r=new n},9252:(t,e,i)=>{"use strict";i.d(e,{M:()=>s});var n=i(5101);const r=[new n.b,new n.b,new n.b,new n.b];class s{constructor(t=0,e=0,i=0,n=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new s(0,0,0,0)}clone(){return new s(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}strokeContains(t,e,i){const{width:n,height:r}=this;if(n<=0||r<=0)return!1;const s=this.x,o=this.y;return t>=s-i/2&&t<=s+n+i/2&&e>=o-i/2&&e<=o+r+i/2&&!(t>s+i/2&&t<s+n-i/2&&e>o+i/2&&e<o+r-i/2)}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}const i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;const a=r[0].set(t.left,t.top),l=r[1].set(t.left,t.bottom),u=r[2].set(t.right,t.top),h=r[3].set(t.right,t.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(0===c)return!1;if(e.apply(a,a),e.apply(l,l),e.apply(u,u),e.apply(h,h),Math.max(a.x,l.x,u.x,h.x)<=i||Math.min(a.x,l.x,u.x,h.x)>=n||Math.max(a.y,l.y,u.y,h.y)<=s||Math.min(a.y,l.y,u.y,h.y)>=o)return!1;const d=c*(l.y-a.y),f=c*(a.x-l.x),p=d*i+f*s,m=d*n+f*s,g=d*i+f*o,v=d*n+f*o;if(Math.max(p,m,g,v)<=d*a.x+f*a.y||Math.min(p,m,g,v)>=d*h.x+f*h.y)return!1;const y=c*(a.y-u.y),x=c*(u.x-a.x),_=y*i+x*s,b=y*n+x*s,w=y*i+x*o,S=y*n+x*o;return!(Math.max(_,b,w,S)<=y*a.x+x*a.y||Math.min(_,b,w,S)>=y*h.x+x*h.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=r-n,this}getBounds(t){return(t=t||new s).copyFrom(this),t}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}},6563:(t,e,i)=>{"use strict";i.d(e,{a:()=>a});var n=i(3804);const r=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function s(t){let e="";for(let i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}let o=null;function a(){if(o)return o;const t=(0,n.W)();return o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),o=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const n=r.replace(/%forloop%/gi,s(t));if(e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}}finally{e.deleteShader(i)}return t}(o,t),t.getExtension("WEBGL_lose_context")?.loseContext(),o}},341:(t,e,i)=>{"use strict";i.d(e,{w:()=>a});var n=i(3513),r=i(4492),s=i(6563);const o={};function a(t,e){let i=2166136261;for(let n=0;n<e;n++)i^=t[n].uid,i=Math.imul(i,16777619),i>>>=0;return o[i]||function(t,e,i){const a={};let u=0;l||(l=(0,s.a)());for(let i=0;i<l;i++){const n=i<e?t[i]:r.g.EMPTY.source;a[u++]=n.source,a[u++]=n.style}const h=new n.T(a);return o[i]=h,h}(t,e,i)}let l=0},1159:(t,e,i)=>{"use strict";i.d(e,{J:()=>R});var n=i(8507),r=i(133),s=i(1460),o=i(6736),a=i(8639),l=i(6563);class u{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class h{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new u,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const c=[];let d=0;function f(){return d>0?c[--d]:new h}function p(t){c[d++]=t}let m=0;const g=class t{constructor(e={}){this.uid=(0,r.L)("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t.defaultOptions.maxTextures=t.defaultOptions.maxTextures??(0,l.a)(),e={...t.defaultOptions,...e};const{maxTextures:i,attributesInitialSize:n,indicesInitialSize:o}=e;this.attributeBuffer=new s.u(4*n),this.indexBuffer=new Uint16Array(o),this.maxTextures=i}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)p(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!(!i&&0!==i)&&(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=f(),n=i.textures;n.clear();const r=e[this.elementStart];let s=(0,a.i)(r.blendMode,r.texture._source);4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const o=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,c=this._batchIndexStart,d="startBatch";const p=this.maxTextures;for(let r=this.elementStart;r<this.elementSize;++r){const g=e[r];e[r]=null;const v=g.texture._source,y=(0,a.i)(g.blendMode,v),x=s!==y;v._batchTick!==m||x?(v._batchTick=m,(n.count>=p||x)&&(this._finishBatch(i,c,h-c,n,s,t,d),d="renderBatch",c=h,s=y,i=f(),n=i.textures,n.clear(),++m),g._textureId=v._textureBindLocation=n.count,n.ids[v.uid]=n.count,n.textures[n.count++]=v,g._batch=i,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,o,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))):(g._textureId=v._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,o,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=i)}n.count>0&&(this._finishBatch(i,c,h-c,n,s,t,d),c=h,++m),this.elementStart=this.elementSize,this._batchIndexStart=c,this._batchIndexSize=h}_finishBatch(t,e,i,n,r,s,o){t.gpuBindGroup=null,t.bindGroup=null,t.action=o,t.batcher=this,t.textures=n,t.blendMode=r,t.start=e,t.size=i,++m,this.batches[this.batchIndex++]=t,s.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){4*t<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*t)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,2*this.attributeBuffer.size),i=new s.u(e);(0,o.W)(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,1.5*e.length);i+=i%2;const n=i>65535?new Uint32Array(i):new Uint16Array(i);if(n.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let t=0;t<e.length;t++)n[t]=e[t];else(0,o.W)(e.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,n){const r=t.indices,s=t.indexSize,o=t.indexOffset,a=t.attributeOffset;for(let t=0;t<s;t++)e[i++]=n+r[t+o]-a}destroy(){for(let t=0;t<this.batches.length;t++)p(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};g.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let v=g;var y=i(949),x=i(1132),_=i(6011);const b=new Float32Array(1),w=new Uint32Array(1);class S extends _.V{constructor(){const t=new y.h({data:b,label:"attribute-batch-buffer",usage:x.S.VERTEX|x.S.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:24,offset:0},aUV:{buffer:t,format:"float32x2",stride:24,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:24,offset:20}},indexBuffer:new y.h({data:w,label:"index-batch-buffer",usage:x.S.INDEX|x.S.COPY_DST,shrinkToFit:!1})})}}var C=i(5611),A=i(4459),T=i(4e3),P=i(6665),M=i(6040),I=i(8475);class O extends I.M{constructor(t){super({glProgram:(0,C.I)({name:"batch",bits:[A.a,(0,T.P)(t),P.m]}),gpuProgram:(0,C.v)({name:"batch",bits:[A.F,(0,T._)(t),P.b]}),resources:{batchSamplers:(0,M.n)(t)}})}}let k=null;const E=class t extends v{constructor(){super(...arguments),this.geometry=new S,this.shader=k||(k=new O(this.maxTextures)),this.name=t.extension.name,this.vertexSize=6}packAttributes(t,e,i,n,r){const s=r<<16|65535&t.roundPixels,o=t.transform,a=o.a,l=o.b,u=o.c,h=o.d,c=o.tx,d=o.ty,{positions:f,uvs:p}=t,m=t.color,g=t.attributeOffset,v=g+t.attributeSize;for(let t=g;t<v;t++){const r=2*t,o=f[r],g=f[r+1];e[n++]=a*o+u*g+c,e[n++]=h*g+l*o+d,e[n++]=p[r],e[n++]=p[r+1],i[n++]=m,i[n++]=s}}packQuadAttributes(t,e,i,n,r){const s=t.texture,o=t.transform,a=o.a,l=o.b,u=o.c,h=o.d,c=o.tx,d=o.ty,f=t.bounds,p=f.maxX,m=f.minX,g=f.maxY,v=f.minY,y=s.uvs,x=t.color,_=r<<16|65535&t.roundPixels;e[n+0]=a*m+u*v+c,e[n+1]=h*v+l*m+d,e[n+2]=y.x0,e[n+3]=y.y0,i[n+4]=x,i[n+5]=_,e[n+6]=a*p+u*v+c,e[n+7]=h*v+l*p+d,e[n+8]=y.x1,e[n+9]=y.y1,i[n+10]=x,i[n+11]=_,e[n+12]=a*p+u*g+c,e[n+13]=h*g+l*p+d,e[n+14]=y.x2,e[n+15]=y.y2,i[n+16]=x,i[n+17]=_,e[n+18]=a*m+u*g+c,e[n+19]=h*g+l*m+d,e[n+20]=y.x3,e[n+21]=y.y3,i[n+22]=x,i[n+23]=_}};E.extension={type:[n.Ag.Batcher],name:"default"};let R=E},5611:(t,e,i)=>{"use strict";i.d(e,{I:()=>P,v:()=>T});var n=i(9113),r=i(3012),s=i(268);function o(t,e,i){if(t)for(const n in t){const r=e[n.toLocaleLowerCase()];if(r){let e=t[n];"header"===n&&(e=e.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),i&&r.push(`//----${i}----//`),r.push(e)}else(0,s.R)(`${n} placement hook does not exist in shader`)}}const a=/\{\{(.*?)\}\}/g;function l(t){const e={};return(t.match(a)?.map((t=>t.replace(/[{()}]/g,"")))??[]).forEach((t=>{e[t]=[]})),e}function u(t,e){let i;const n=/@in\s+([^;]+);/g;for(;null!==(i=n.exec(t));)e.push(i[1])}function h(t,e,i=!1){const n=[];u(e,n),t.forEach((t=>{t.header&&u(t.header,n)}));const r=n;i&&r.sort();const s=r.map(((t,e)=>`       @location(${e}) ${t},`)).join("\n");let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`\n${s}\n`),o}function c(t,e){let i;const n=/@out\s+([^;]+);/g;for(;null!==(i=n.exec(t));)e.push(i[1])}function d(t,e){let i=t;for(const t in e){const n=e[t];i=n.join("\n").length?i.replace(`{{${t}}}`,`//-----${t} START-----//\n${n.join("\n")}\n//----${t} FINISH----//`):i.replace(`{{${t}}}`,"")}return i}const f=Object.create(null),p=new Map;let m=0;function g({template:t,bits:e}){const i=y(t,e);if(f[i])return f[i];const{vertex:n,fragment:r}=function(t,e){const i=e.map((t=>t.vertex)).filter((t=>!!t)),n=e.map((t=>t.fragment)).filter((t=>!!t));let r=h(i,t.vertex,!0);r=function(t,e){const i=[];c(e,i),t.forEach((t=>{t.header&&c(t.header,i)}));let n=0;const r=i.sort().map((t=>t.indexOf("builtin")>-1?t:`@location(${n++}) ${t}`)).join(",\n"),s=i.sort().map((t=>{return`       var ${e=t,e.replace(/@.*?\s+/g,"")};`;var e})).join("\n"),o=`return VSOutput(\n                ${i.sort().map((t=>` ${function(t){const e=/\b(\w+)\s*:/g.exec(t);return e?e[1]:""}(t)}`)).join(",\n")});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`\n${r}\n`),a=a.replace("{{start}}",`\n${s}\n`),a=a.replace("{{return}}",`\n${o}\n`),a}(i,r);const s=h(n,t.fragment,!0);return{vertex:r,fragment:s}}(t,e);return f[i]=x(n,r,e),f[i]}function v({template:t,bits:e}){const i=y(t,e);return f[i]||(f[i]=x(t.vertex,t.fragment,e)),f[i]}function y(t,e){return e.map((t=>(p.has(t)||p.set(t,m++),p.get(t)))).sort(((t,e)=>t-e)).join("-")+t.vertex+t.fragment}function x(t,e,i){const n=l(t),r=l(e);return i.forEach((t=>{o(t.vertex,n,t.name),o(t.fragment,r,t.name)})),{vertex:d(t,n),fragment:d(e,r)}}const _="\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n        \n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n       \n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n",b="\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n   \n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n        \n        {{start}}\n\n        var outColor:vec4<f32>;\n      \n        {{main}}\n        \n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n",w="\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n        \n        {{start}}\n        \n        vColor = vec4(1.);\n        \n        {{main}}\n        \n        vUV = uv;\n        \n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n",S="\n   \n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n        \n        {{start}}\n\n        vec4 outColor;\n      \n        {{main}}\n        \n        finalColor = outColor * vColor;\n        \n        {{end}}\n    }\n",C={name:"global-uniforms-bit",vertex:{header:"\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        "}},A={name:"global-uniforms-bit",vertex:{header:"\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        "}};function T({bits:t,name:e}){const i=g({template:{fragment:b,vertex:_},bits:[C,...t]});return r.B.from({name:e,vertex:{source:i.vertex,entryPoint:"main"},fragment:{source:i.fragment,entryPoint:"main"}})}function P({bits:t,name:e}){return new n.M({name:e,...v({template:{vertex:w,fragment:S},bits:[A,...t]})})}},4459:(t,e,i)=>{"use strict";i.d(e,{F:()=>n,a:()=>r});const n={name:"color-bit",vertex:{header:"\n            @in aColor: vec4<f32>;\n        ",main:"\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        "}},r={name:"color-bit",vertex:{header:"\n            in vec4 aColor;\n        ",main:"\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        "}}},4e3:(t,e,i)=>{"use strict";i.d(e,{P:()=>u,_:()=>o});const n={};function r(t){const e=[];if(1===t)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let i=0;for(let n=0;n<t;n++)e.push(`@group(1) @binding(${i++}) var textureSource${n+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${i++}) var textureSampler${n+1}: sampler;`)}return e.join("\n")}function s(t){const e=[];if(1===t)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let i=0;i<t;i++)i===t-1?e.push("  default:{"):e.push(`  case ${i}:{`),e.push(`      outColor = textureSampleGrad(textureSource${i+1}, textureSampler${i+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join("\n")}function o(t){return n[t]||(n[t]={name:"texture-batch-bit",vertex:{header:"\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            "},fragment:{header:`\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${r(t)}\n            `,main:`\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${s(t)}\n            `}}),n[t]}const a={};function l(t){const e=[];for(let i=0;i<t;i++)i>0&&e.push("else"),i<t-1&&e.push(`if(vTextureId < ${i}.5)`),e.push("{"),e.push(`\toutColor = texture(uTextures[${i}], vUV);`),e.push("}");return e.join("\n")}function u(t){return a[t]||(a[t]={name:"texture-batch-bit",vertex:{header:"\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            "},fragment:{header:`\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${t}];\n\n            `,main:`\n\n                ${l(t)}\n            `}}),a[t]}},6665:(t,e,i)=>{"use strict";i.d(e,{b:()=>n,m:()=>r});const n={name:"round-pixels-bit",vertex:{header:"\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> \n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},r={name:"round-pixels-bit",vertex:{header:"   \n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {       \n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}}},8480:(t,e,i)=>{"use strict";var n=i(8507),r=i(6844),s=i(9636),o=i(9443);const a=new s.c;function l(t,e,i){const n=a;t.measurable=!0,(0,o.fB)(t,i,n),e.addBoundsMask(n),t.measurable=!1}var u=i(7269),h=i(2208),c=i(268);function d(t,e,i){const n=h.o.get();t.measurable=!0;const r=h.u.get().identity(),s=f(t,i,r);(0,u.n)(t,n,s),t.measurable=!1,e.addBoundsMask(n),h.u.return(r),h.o.return(n)}function f(t,e,i){return t?(t!==e&&(f(t.parent,e,i),t.updateLocalTransform(),i.append(t.localTransform)),i):((0,c.R)("Mask bounds, renderable is not inside the root container"),i)}class p{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof r.k),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||l(this.mask,t,e)}addLocalBounds(t,e){d(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof r.k}}p.extension=n.Ag.MaskEffect;class m{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return"number"==typeof t}}m.extension=n.Ag.MaskEffect;var g=i(4263);class v{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){l(this.mask,t,e)}addLocalBounds(t,e){d(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof g.mc}}v.extension=n.Ag.MaskEffect;var y=i(4195),x=i(4884),_=i(8293),b=i(6139);i(6557);n.XO.add(p,m,v,b.$,_.b,x.q,y.P)},1257:(t,e,i)=>{"use strict";i.d(e,{u:()=>n});var n=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(n||{})},9113:(t,e,i)=>{"use strict";i.d(e,{M:()=>d});var n=i(7952),r=i(3804);let s;function o(){if(!s){s="mediump";const t=(0,r.W)();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);s=e.precision?"highp":"mediump"}}return s}const a={},l={};const u={stripVersion:function(t,e){return e?t.replace("#version 300 es",""):t},ensurePrecision:function(t,e,i){const n=i?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if("precision"!==t.substring(0,9)){let r=i?e.requestedFragmentPrecision:e.requestedVertexPrecision;return"highp"===r&&"highp"!==n&&(r="mediump"),`precision ${r} float;\n${t}`}return"highp"!==n&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t},addProgramDefines:function(t,e,i){return e?t:i?`\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ${t=t.replace("out vec4 finalColor;","")}\n        `:`\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ${t}\n        `},setProgramName:function(t,{name:e="pixi-program"},i=!0){e=e.replace(/\s+/g,"-");const n=i?a:l;return n[e+=i?"-fragment":"-vertex"]?(n[e]++,e+=`-${n[e]}`):n[e]=1,-1!==t.indexOf("#define SHADER_NAME")?t:`${`#define SHADER_NAME ${e}`}\n${t}`},insertVersion:function(t,e){return e?`#version 300 es\n${t}`:t}},h=Object.create(null),c=class t{constructor(e){const i=-1!==(e={...t.defaultOptions,...e}).fragment.indexOf("#version 300 es"),r={stripVersion:i,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:o()},setProgramName:{name:e.name},addProgramDefines:i,insertVersion:i};let s=e.fragment,a=e.vertex;Object.keys(u).forEach((t=>{const e=r[t];s=u[t](s,e,!0),a=u[t](a,e,!1)})),this.fragment=s,this.vertex=a,this._key=(0,n.X)(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const i=`${e.vertex}:${e.fragment}`;return h[i]||(h[i]=new t(e)),h[i]}};c.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let d=c},6040:(t,e,i)=>{"use strict";i.d(e,{n:()=>s});var n=i(5811);const r={};function s(t){let e=r[t];if(e)return e;const i=new Int32Array(t);for(let e=0;e<t;e++)i[e]=e;return e=r[t]=new n.k({uTextures:{value:i,type:"i32",size:t}},{isStatic:!0}),e}},3804:(t,e,i)=>{"use strict";i.d(e,{W:()=>s});var n=i(1761);let r;function s(){if(!r||r?.isContextLost()){const t=n.e.get().createCanvas();r=t.getContext("webgl",{})}return r}},3513:(t,e,i)=>{"use strict";i.d(e,{T:()=>n});class n{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const n=t[i];this.setResource(n,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){const i=this.resources[e];t!==i&&(i&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){const t=this.resources;for(const e in t){const i=t[e];i.off?.("change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}},3012:(t,e,i)=>{"use strict";i.d(e,{B:()=>u});var n=i(7952),r=i(8306);const s={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function o(t){const e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,r=/:\s*(\w+)/,s=/(\w+)\s*:\s*([\w\<\>]+)/g,o=/struct\s+(\w+)/,a=t.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g)?.map((t=>({group:parseInt(t.match(e)[1],10),binding:parseInt(t.match(i)[1],10),name:t.match(n)[2],isUniform:"<uniform>"===t.match(n)[1],type:t.match(r)[1]})));if(!a)return{groups:[],structs:[]};const l=t.match(/struct\s+(\w+)\s*{([^}]+)}/g)?.map((t=>{const e=t.match(o)[1],i=t.match(s).reduce(((t,e)=>{const[i,n]=e.split(":");return t[i.trim()]=n.trim(),t}),{});return i?{name:e,members:i}:null})).filter((({name:t})=>a.some((e=>e.type===t))))??[];return{groups:a,structs:l}}var a=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(a||{});const l=Object.create(null);class u{constructor(t){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:n,gpuLayout:r,name:s}=t;if(this.name=s,this.fragment=e,this.vertex=i,e.source===i.source){const t=o(e.source);this.structsAndGroups=t}else{const t=o(i.source),n=o(e.source);this.structsAndGroups=function(t,e){const i=new Set,n=new Set;return{structs:[...t.structs,...e.structs].filter((t=>!i.has(t.name)&&(i.add(t.name),!0))),groups:[...t.groups,...e.groups].filter((t=>{const e=`${t.name}-${t.binding}`;return!n.has(e)&&(n.add(e),!0)}))}}(t,n)}this.layout=n??function({groups:t}){const e=[];for(let i=0;i<t.length;i++){const n=t[i];e[n.group]||(e[n.group]={}),e[n.group][n.name]=n.binding}return e}(this.structsAndGroups),this.gpuLayout=r??function({groups:t}){const e=[];for(let i=0;i<t.length;i++){const n=t[i];e[n.group]||(e[n.group]=[]),n.isUniform?e[n.group].push({binding:n.binding,visibility:a.VERTEX|a.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===n.type?e[n.group].push({binding:n.binding,visibility:a.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===n.type&&e[n.group].push({binding:n.binding,visibility:a.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===this.layout[0]?.globalUniforms),this.autoAssignLocalUniforms=!(void 0===this.layout[1]?.localUniforms),this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=(0,n.X)(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=function({source:t,entryPoint:e}){const i={},n=t.indexOf(`fn ${e}`);if(-1!==n){const e=t.indexOf("->",n);if(-1!==e){const o=t.substring(n,e),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let l;for(;null!==(l=a.exec(o));){const t=s[l[3]]??"float32";i[l[2]]={location:parseInt(l[1],10),format:t,stride:(0,r.m)(t).stride,offset:0,instance:!1,start:0}}}}return i}(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return l[e]||(l[e]=new u(t)),l[e]}}},949:(t,e,i)=>{"use strict";i.d(e,{h:()=>o});var n=i(8875),r=i(133),s=i(1132);class o extends n.A{constructor(t){let{data:e,size:i}=t;const{usage:n,label:s,shrinkToFit:o}=t;super(),this.uid=(0,r.L)("buffer"),this._resourceType="buffer",this._resourceId=(0,r.L)("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i=i??e?.byteLength;const a=!!e;this.descriptor={size:i,usage:n,mappedAtCreation:a,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get static(){return!!(this.descriptor.usage&s.S.STATIC)}set static(t){t?this.descriptor.usage|=s.S.STATIC:this.descriptor.usage&=~s.S.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t)return void(i&&this.emit("update",this));const n=this._data;this._data=t,n.length===t.length||!this.shrinkToFit&&t.byteLength<n.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=(0,r.L)("resource"),this.emit("change",this))}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}},1132:(t,e,i)=>{"use strict";i.d(e,{S:()=>n});var n=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(n||{})},6736:(t,e,i)=>{"use strict";function n(t,e){const i=t.byteLength/8|0,n=new Float64Array(t,0,i);new Float64Array(e,0,i).set(n);const r=t.byteLength-8*i;if(r>0){const n=new Uint8Array(t,8*i,r);new Uint8Array(e,8*i,r).set(n)}}i.d(e,{W:()=>n})},6011:(t,e,i)=>{"use strict";i.d(e,{V:()=>u});var n=i(8875),r=i(9636),s=i(133),o=i(949),a=i(1132);function l(t,e){if(!(t instanceof o.h)){let i=e?a.S.INDEX:a.S.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),i=a.S.INDEX|a.S.COPY_DST):(t=new Float32Array(t),i=a.S.VERTEX|a.S.COPY_DST)),t=new o.h({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:i})}return t}class u extends n.A{constructor(t={}){super(),this.uid=(0,s.L)("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new r.c,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:n}=t;if(this.buffers=[],this.attributes={},e)for(const t in e)this.addAttribute(t,e[t]);this.instanceCount=t.instanceCount||1,i&&this.addIndex(i),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=function(t){return(t instanceof o.h||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=l(t.buffer,!1),t}(e);-1===this.buffers.indexOf(i.buffer)&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=l(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,function(t,e,i){const n=t.getAttribute(e);if(!n)return i.minX=0,i.minY=0,i.maxX=0,i.maxY=0,i;const r=n.buffer.data;let s=1/0,o=1/0,a=-1/0,l=-1/0;const u=r.BYTES_PER_ELEMENT,h=(n.offset||0)/u,c=(n.stride||8)/u;for(let t=h;t<r.length;t+=c){const e=r[t],i=r[t+1];e>a&&(a=e),i>l&&(l=i),e<s&&(s=e),i<o&&(o=i)}return i.minX=s,i.minY=o,i.maxX=a,i.maxY=l,i}(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach((t=>t.destroy())),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}},8306:(t,e,i)=>{"use strict";i.d(e,{m:()=>r});const n={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function r(t){return n[t]??n.float32}},848:(t,e,i)=>{"use strict";i.d(e,{L:()=>s});var n=i(133);let r=0;class s{constructor(){this.uid=(0,n.L)("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=r++}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}},279:(t,e,i)=>{"use strict";i.d(e,{O:()=>a});var n=i(133),r=i(1285),s=i(4492);const o=class t{constructor(e={}){if(this.uid=(0,n.L)("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,e={...t.defaultOptions,...e},this.stencil=e.stencil,this.depth=e.depth,this.isRoot=e.isRoot,"number"==typeof e.colorTextures){this._managedColorTextures=!0;for(let t=0;t<e.colorTextures;t++)this.colorTextures.push(new r.v({width:e.width,height:e.height,resolution:e.resolution,antialias:e.antialias}))}else{this.colorTextures=[...e.colorTextures.map((t=>t.source))];const t=this.colorTexture.source;this.resize(t.width,t.height,t._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(e.depthStencilTexture||this.stencil)&&(e.depthStencilTexture instanceof s.g||e.depthStencilTexture instanceof r.v?this.depthStencilTexture=e.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const t=this._size;return t[0]=this.pixelWidth,t[1]=this.pixelHeight,t}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(t){this.resize(t.width,t.height,t._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new r.v({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(t,e,i=this.resolution,n=!1){this.dirtyId++,this.colorTextures.forEach(((r,s)=>{n&&0===s||r.source.resize(t,e,i)})),this.depthStencilTexture&&this.depthStencilTexture.source.resize(t,e,i)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach((t=>{t.destroy()})),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};o.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let a=o},8475:(t,e,i)=>{"use strict";i.d(e,{M:()=>u});var n=i(8875),r=i(9113),s=i(3513),o=i(3012),a=i(5099),l=i(5811);class u extends n.A{constructor(t){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:n,resources:r,compatibleRenderers:o,groupMap:u}=t;this.gpuProgram=e,this.glProgram=i,void 0===o&&(o=0,e&&(o|=a.W.WEBGPU),i&&(o|=a.W.WEBGL)),this.compatibleRenderers=o;const h={};if(r||n||(r={}),r&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&n&&!u)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&n&&u)for(const t in u)for(const e in u[t]){const i=u[t][e];h[i]={group:t,binding:e,name:i}}else if(e&&n&&!u){const t=e.structsAndGroups.groups;u={},t.forEach((t=>{u[t.group]=u[t.group]||{},u[t.group][t.binding]=t.name,h[t.name]=t}))}else if(r){if(n={},u={},e){e.structsAndGroups.groups.forEach((t=>{u[t.group]=u[t.group]||{},u[t.group][t.binding]=t.name,h[t.name]=t}))}let t=0;for(const e in r)h[e]||(n[99]||(n[99]=new s.T,this._ownedBindGroups.push(n[99])),h[e]={group:99,binding:t,name:e},u[99]=u[99]||{},u[99][t]=e,t++);for(const t in r){const e=t;let i=r[t];i.source||i._resourceType||(i=new l.k(i));const o=h[e];o&&(n[o.group]||(n[o.group]=new s.T,this._ownedBindGroups.push(n[o.group])),n[o.group].setResource(i,o.binding))}}this.groups=n,this._uniformBindMap=u,this.resources=this._buildResourceAccessor(n,h)}addResource(t,e,i){var n,r;(n=this._uniformBindMap)[e]||(n[e]={}),(r=this._uniformBindMap[e])[i]||(r[i]=t),this.groups[e]||(this.groups[e]=new s.T,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const n in e){const r=e[n];Object.defineProperty(i,r.name,{get:()=>t[r.group].getResource(r.binding),set(e){t[r.group].setResource(e,r.binding)}})}return i}destroy(t=!1){this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach((t=>{t.destroy()})),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...n}=t;let s,a;return e&&(s=o.B.from(e)),i&&(a=r.M.from(i)),new u({gpuProgram:s,glProgram:a,...n})}}},5811:(t,e,i)=>{"use strict";i.d(e,{k:()=>u});var n=i(133),r=i(7952);const s=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],o=s.reduce(((t,e)=>(t[e]=!0,t)),{});function a(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const l=class t{constructor(e,i){this._touched=0,this.uid=(0,n.L)("uniform"),this._resourceType="uniformGroup",this._resourceId=(0,n.L)("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,i={...t.defaultOptions,...i},this.uniformStructures=e;const l={};for(const t in e){const i=e[t];if(i.name=t,i.size=i.size??1,!o[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${s.join(", ")}`);i.value??(i.value=a(i.type,i.size)),l[t]=i.value}this.uniforms=l,this._dirtyId=1,this.ubo=i.ubo,this.isStatic=i.isStatic,this._signature=(0,r.X)(Object.keys(l).map((t=>`${t}-${e[t].type}`)).join("-"),"uniform-group")}update(){this._dirtyId++}};l.defaultOptions={ubo:!1,isStatic:!1};let u=l},7547:(t,e,i)=>{"use strict";i.d(e,{U:()=>s});const n={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},r=class t{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}set cullMode(t){"none"!==t?(this.culling=!0,this.clockwiseFrontFace="front"===t):this.culling=!1}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend="none"!==t,this._blendMode=t,this._blendModeId=n[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new t;return e.depthTest=!1,e.blend=!0,e}};r.default2d=r.for2d();let s=r},1957:(t,e,i)=>{"use strict";i.d(e,{K:()=>r,Q:()=>n});const n={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var r=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(r||{})},8639:(t,e,i)=>{"use strict";i.d(e,{i:()=>r});var n=i(1957);function r(t,e){return"no-premultiply-alpha"===e.alphaMode&&n.Q[t]||t}},800:(t,e,i)=>{"use strict";i.d(e,{k:()=>m});var n=i(2577),r=i(8507);const s=[];async function o(t){if(!t)for(let t=0;t<s.length;t++){const e=s[t];if(e.value.test())return void await e.value.load()}}r.XO.handleByNamedList(r.Ag.Environment,s);var a=i(4263),l=i(4577),u=i(4670),h=i(1257),c=i(7729),d=i(8875);const f=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],p=class t extends d.A{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...f,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(e={}){const i=!0===e.skipExtensionImports||!1===e.manageImports;await o(i),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const t in this._systemsHash){e={...this._systemsHash[t].constructor.defaultOptions,...e}}e={...t.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let t=0;t<this.runners.init.items.length;t++)await this.runners.init.items[t].init(e);this._initOptions=e}render(t,e){let i=t;if(i instanceof a.mc&&(i={container:i},e&&((0,u.t6)(u.lj,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor=this.background.colorRgba),i.clearColor){const t=Array.isArray(i.clearColor)&&4===i.clearColor.length;i.clearColor=t?i.clearColor:n.Q.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){const n=this.view.resolution;this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==i&&i!==n&&this.runners.resolutionChange.emit(i)}clear(t={}){t.target||(t.target=this.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=h.u.ALL);const{clear:e,clearColor:i,target:r}=t;n.Q.shared.setValue(i??this.background.colorRgba),this.renderTarget.clear(r,e,n.Q.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach((t=>{this.runners[t]=new c.C(t)}))}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const t in this.runners)this.runners[t].add(i);return this}_addPipes(t,e){const i=e.reduce(((t,e)=>(t[e.name]=e.value,t)),{});t.forEach((t=>{const e=t.value,n=t.name,r=i[n];this.renderPipes[n]=new e(this,r?new r:null)}))}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!(0,l.f)())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};p.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let m=p},7729:(t,e,i)=>{"use strict";i.d(e,{C:()=>n});class n{constructor(t){this.items=[],this._name=t}emit(t,e,i,n,r,s,o,a){const{name:l,items:u}=this;for(let h=0,c=u.length;h<c;h++)u[h][l](t,e,i,n,r,s,o,a);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&this.items.splice(e,1),this}contains(t){return-1!==this.items.indexOf(t)}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}},7608:(t,e,i)=>{"use strict";i.d(e,{N:()=>s});var n=i(1761),r=i(9939);const s=new class{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const i=n.e.get().createCanvas();i.width=t,i.height=e;const r=i.getContext("2d");return{canvas:i,context:r}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6);const n=((t=(0,r.U5)(t))<<17)+((e=(0,r.U5)(e))<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let s=this._canvasPool[n].pop();return s||(s=this._createCanvasAndContext(t,e)),s}returnCanvasAndContext(t){const e=t.canvas,{width:i,height:n}=e,r=(i<<17)+(n<<1);t.context.clearRect(0,0,i,n),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}},4492:(t,e,i)=>{"use strict";i.d(e,{g:()=>_});var n=i(8875),r=i(9313);const s=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],o=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],l=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],u=[],h=[],c=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];u.push(e);for(let i=0;i<16;i++){const n=c(s[t]*s[i]+a[t]*o[i]),r=c(o[t]*s[i]+l[t]*o[i]),u=c(s[t]*a[i]+a[t]*l[i]),h=c(o[t]*a[i]+l[t]*l[i]);for(let t=0;t<16;t++)if(s[t]===n&&o[t]===r&&a[t]===u&&l[t]===h){e.push(t);break}}}for(let t=0;t<16;t++){const e=new r.u;e.set(s[t],o[t],a[t],l[t],0,0),h.push(e)}}();const d={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>s[t],uY:t=>o[t],vX:t=>a[t],vY:t=>l[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>u[t][e],sub:(t,e)=>u[t][d.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?d.S:d.N:2*Math.abs(e)<=Math.abs(t)?t>0?d.E:d.W:e>0?t>0?d.SE:d.SW:t>0?d.NE:d.NW,matrixAppendRotationInv:(t,e,i=0,n=0)=>{const r=h[d.inv(e)];r.tx=i,r.ty=n,t.append(r)}};var f=i(9252),p=i(133),m=i(4670);const g=()=>{};var v=i(4195),y=i(1285),x=i(1196);class _ extends n.A{constructor({source:t,label:e,frame:i,orig:n,trim:r,defaultAnchor:s,defaultBorders:o,rotate:a,dynamic:l}={}){if(super(),this.uid=(0,p.L)("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new f.M,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=t?.source??new y.v,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:t,height:e}=this._source;this.frame.width=t,this.frame.height=e}this.orig=n||this.frame,this.trim=r,this.rotate=a??0,this.defaultAnchor=s,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new x.N(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:n}=this._source,r=e.x/i,s=e.y/n,o=e.width/i,a=e.height/n;let l=this.rotate;if(l){const e=o/2,i=a/2,n=r+e,u=s+i;l=d.add(l,d.NW),t.x0=n+e*d.uX(l),t.y0=u+i*d.uY(l),l=d.add(l,2),t.x1=n+e*d.uX(l),t.y1=u+i*d.uY(l),l=d.add(l,2),t.x2=n+e*d.uX(l),t.y2=u+i*d.uY(l),l=d.add(l,2),t.x3=n+e*d.uX(l),t.y3=u+i*d.uY(l)}else t.x0=r,t.y0=s,t.x1=r+o,t.y1=s,t.x2=r+o,t.y2=s+a,t.x3=r,t.y3=s+a}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return(0,m.t6)(m.lj,"Texture.baseTexture is now Texture.source"),this._source}}_.EMPTY=new _({label:"EMPTY",source:new y.v({label:"EMPTY"})}),_.EMPTY.destroy=g,_.WHITE=new _({source:new v.P({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),_.WHITE.destroy=g},1196:(t,e,i)=>{"use strict";i.d(e,{N:()=>s});var n=i(9313);const r=new n.u;class s{constructor(t,e){this.mapCoord=new n.u,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?t.width<10?0:.5:e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){void 0===e&&(e=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],s=t[n+1];e[n]=r*i.a+s*i.c+i.tx,e[n+1]=r*i.b+s*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,n=t.trim;n&&(r.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(r));const s=t.source,o=this.uClampFrame,a=this.clampMargin/s._resolution,l=this.clampOffset/s._resolution;return o[0]=(t.frame.x+a+l)/s.width,o[1]=(t.frame.y+a+l)/s.height,o[2]=(t.frame.x+t.frame.width-a+l)/s.width,o[3]=(t.frame.y+t.frame.height-a+l)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=t.frame.width===s.width&&t.frame.height===s.height&&0===t.rotate,!0}}},2437:(t,e,i)=>{"use strict";i.d(e,{W:()=>a});var n=i(9939),r=i(1285),s=i(4492);let o=0;const a=new class{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,i){const n=new r.v({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!0});return new s.g({source:n,label:"texturePool_"+o++})}getOptimalTexture(t,e,i=1,r){let s=Math.ceil(t*i-1e-6),o=Math.ceil(e*i-1e-6);s=(0,n.U5)(s),o=(0,n.U5)(o);const a=(s<<17)+(o<<1)+(r?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(s,o,r)),l.source._resolution=i,l.source.width=s/i,l.source.height=o/i,l.source.pixelWidth=s,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=t,l.frame.height=e,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t){const e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=!1!==t)for(const t in this._texturePool){const e=this._texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this._texturePool={}}}},218:(t,e,i)=>{"use strict";i.d(e,{n:()=>l});var n=i(8875),r=i(133),s=i(4670);const o=Object.create(null);const a=class t extends n.A{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...t.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){(0,s.t6)(s.lj,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=function(t){const e=o[t];return void 0===e&&(o[t]=(0,r.L)("resource")),e}(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};a.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let l=a},4195:(t,e,i)=>{"use strict";i.d(e,{P:()=>s});var n=i(8507),r=i(1285);class s extends r.v{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(i=e instanceof Float32Array?"rgba32float":e instanceof Int32Array||e instanceof Uint32Array?"rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?"rgba16uint":(Int8Array,"bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}s.extension=n.Ag.TextureSource},4884:(t,e,i)=>{"use strict";i.d(e,{q:()=>o});var n=i(1761),r=i(8507),s=i(1285);class o extends s.v{constructor(t){t.resource||(t.resource=n.e.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity;const e=t.resource;this.pixelWidth===e.width&&this.pixelWidth===e.height||this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),this.resource.width===this.pixelWidth&&this.resource.height===this.pixelHeight||(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const n=super.resize(t,e,i);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}o.extension=r.Ag.TextureSource},8293:(t,e,i)=>{"use strict";i.d(e,{b:()=>a});var n=i(1761),r=i(8507),s=i(268),o=i(1285);class a extends o.v{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=n.e.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,(0,s.R)("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}a.extension=r.Ag.TextureSource},1285:(t,e,i)=>{"use strict";i.d(e,{v:()=>l});var n=i(8875),r=i(9939);var s=i(133),o=i(218);const a=class t extends n.A{constructor(e={}){super(),this.options=e,this.uid=(0,s.L)("textureSource"),this._resourceType="textureSource",this._resourceId=(0,s.L)("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...t.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new o.n(function(t){const e={};for(const i in t)void 0!==t[i]&&(e[i]=t[i]);return e}(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=(0,s.L)("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i=i||this._resolution,t=t||this.width,e=e||this.height;const n=Math.round(t*i),r=Math.round(e*i);return this.width=n/i,this.height=r/i,this._resolution=i,(this.pixelWidth!==n||this.pixelHeight!==r)&&(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=r,this.emit("resize",this),this._resourceId=(0,s.L)("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=(0,r.f3)(this.pixelWidth)&&(0,r.f3)(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};a.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let l=a},6139:(t,e,i)=>{"use strict";i.d(e,{$:()=>l});var n=i(8507),r=i(7309),s=i(6858),o=i(1285);const a=class t extends o.v{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...t.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==e.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=r.R.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await(0,s.C)(),this._load=new Promise(((i,n)=>{this.isValid?i(this):(this._resolve=i,this._reject=n,void 0!==e.preloadTimeoutMs&&(this._preloadTimeout=setTimeout((()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))}))),t.load())})),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(r.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(r.R.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(r.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};a.extension=n.Ag.TextureSource,a.defaultOptions={...o.v.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},a.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let l=a},8725:(t,e,i)=>{"use strict";i.d(e,{c:()=>o});var n=i(4884),r=i(4492);const s=new Map;function o(t,e){if(!s.has(t)){const i=new r.g({source:new n.q({resource:t,...e})}),o=()=>{s.get(t)===i&&s.delete(t)};i.once("destroy",o),i.source.once("destroy",o),s.set(t,i)}return s.get(t)}},6557:(t,e,i)=>{"use strict";var n=i(1979),r=i(8507),s=i(1285),o=i(4492);const a=[];function l(t={}){const e=t&&t.resource,i=e?t.resource:t,n=e?t:{resource:t};for(let t=0;t<a.length;t++){const e=a[t];if(e.test(i))return new e(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}r.XO.handleByList(r.Ag.TextureSource,a),o.g.from=function(t,e=!1){return"string"==typeof t?n.l.get(t):t instanceof s.v?new o.g({source:t}):function(t={},e=!1){const i=t&&t.resource,r=i?t.resource:t,s=i?t:{resource:t};if(!e&&n.l.has(r))return n.l.get(r);const a=new o.g({source:l(s)});return a.on("destroy",(()=>{n.l.has(r)&&n.l.remove(r)})),e||n.l.set(r,a),a}(t,e)},s.v.from=l},7952:(t,e,i)=>{"use strict";i.d(e,{X:()=>s});const n=Object.create(null),r=Object.create(null);function s(t,e){let i=r[t];return void 0===i&&(void 0===n[e]&&(n[e]=1),r[t]=i=n[e]++),i}},548:(t,e,i)=>{"use strict";i.d(e,{v:()=>h});var n=i(1761),r=i(8507),s=i(9252),o=i(4670),a=i(279),l=i(8725);const u=class t{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(t){this.texture.source.autoDensity=t}get resolution(){return this.texture.source._resolution}set resolution(t){this.texture.source.resize(this.texture.source.width,this.texture.source.height,t)}init(e){(e={...t.defaultOptions,...e}).view&&((0,o.t6)(o.lj,"ViewSystem.view has been renamed to ViewSystem.canvas"),e.canvas=e.view),this.screen=new s.M(0,0,e.width,e.height),this.canvas=e.canvas||n.e.get().createCanvas(),this.antialias=!!e.antialias,this.texture=(0,l.c)(this.canvas,e),this.renderTarget=new a.O({colorTextures:[this.texture],depth:!!e.depth,isRoot:!0}),this.texture.source.transparent=e.backgroundAlpha<1,this.resolution=e.resolution}resize(t,e,i){this.texture.source.resize(t,e,i),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(t=!1){("boolean"==typeof t?t:!!t?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}};u.extension={type:[r.Ag.WebGLSystem,r.Ag.WebGPUSystem,r.Ag.CanvasSystem],name:"view",priority:0},u.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};let h=u},5099:(t,e,i)=>{"use strict";i.d(e,{W:()=>n});var n=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(n||{})},4263:(t,e,i)=>{"use strict";i.d(e,{mc:()=>D,u:()=>F,ig:()=>z,fR:()=>U});var n=i(8875),r=i(2577);var s=i(9313),o=i(1652),a=i(2812),l=i(133),u=i(4670),h=i(8218),c=i(9903);const d={allowChildren:!0,removeChildren(t=0,e){const i=e??this.children.length,n=i-t,r=[];if(n>0&&n<=i){for(let e=i-1;e>=t;e--){const t=this.children[e];t&&(r.push(t),t.parent=null)}(0,c.d)(this.children,t,i);const e=this.renderGroup||this.parentRenderGroup;e&&e.removeChildren(r);for(let t=0;t<r.length;++t)this.emit("childRemoved",r[t],this,t),r[t].emit("removed",this);return r}if(0===n&&0===this.children.length)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||(0,u.t6)(u.lj,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:i}=this;if(e<0||e>i.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${i.length}`);if(t.parent){const i=t.parent.children.indexOf(t);if(t.parent===this&&i===e)return t;-1!==i&&t.parent.children.splice(i,1)}e===i.length?i.push(t):i.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return 1===t.length?this.reparentChildAt(t[0],this.children.length):(t.forEach((t=>this.reparentChildAt(t,this.children.length))),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const i=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const n=this.worldTransform.clone();return n.invert(),i.prepend(n),t.setFromMatrix(i),t}};var f=i(9049),p=i(8507);const m=new class{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach((t=>{this.add({test:t.test,maskClass:t})})))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return h.Z.get(i.maskClass,t)}return t}returnMaskEffect(t){h.Z.return(t)}};p.XO.handleByList(p.Ag.MaskEffect,m._effectClasses);const g={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],addEffect(t){if(-1!==this.effects.indexOf(t))return;this.effects.push(t),this.effects.sort(((t,e)=>t.priority-e.priority));const e=this.renderGroup||this.parentRenderGroup;e&&(e.structureDidChange=!0),this._updateIsSimple()},removeEffect(t){const e=this.effects.indexOf(t);-1!==e&&(this.effects.splice(e,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),m.returnMaskEffect(e),this._maskEffect=null),null!=t&&(this._maskEffect=m.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask)},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new f.a),i=t?.length>0,n=i!==e.filters?.length>0;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(i?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new f.a),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},v={label:null,get name(){return(0,u.t6)(u.lj,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){(0,u.t6)(u.lj,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const i=this.children;for(let e=0;e<i.length;e++){const n=i[e];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let e=0;e<i.length;e++){const n=i[e].getChildByLabel(t,!0);if(n)return n}return null},getChildrenByLabel(t,e=!1,i=[]){const n=this.children;for(let e=0;e<n.length;e++){const r=n[e];(r.label===t||t instanceof RegExp&&t.test(r.label))&&i.push(r)}if(e)for(let e=0;e<n.length;e++)n[e].getChildrenByLabel(t,!0,i);return i}};var y=i(9636),x=i(9443),_=i(7269);function b(t,e){const i=t.children;for(let t=0;t<i.length;t++){const n=i[t],r=n.uid,s=(65535&n._didViewChangeTick)<<16|65535&n._didContainerChangeTick,o=e.index;e.data[o]===r&&e.data[o+1]===s||(e.data[e.index]=r,e.data[e.index+1]=s,e.didChange=!0),e.index=o+2,n.children.length&&b(n,e)}return e.didChange}const w=new s.u,S={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const i=Math.sign(this.scale.x)||1;this.scale.x=0!==e?t/e*i:i},_setHeight(t,e){const i=Math.sign(this.scale.y)||1;this.scale.y=0!==e?t/e*i:i},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new y.c});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),b(this,t),t.didChange&&(0,_.n)(this,t.localBounds,w),t.localBounds},getBounds(t,e){return(0,x.fB)(this,t,e||new y.c)}},C={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t)return this._onRender&&e?.removeOnRender(this),void(this._onRender=null);this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},A={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(T))}};function T(t,e){return t._zIndex-e._zIndex}var P=i(5101);const M={getGlobalPosition(t=new P.b,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,i=!1){if(!i){this.updateLocalTransform();const i=(0,x.Ek)(this,new s.u);return i.append(this.localTransform),i.apply(t,e)}return this.worldTransform.apply(t,e)},toLocal(t,e,i,n){if(e&&(t=e.toGlobal(t,i,n)),!n){this.updateLocalTransform();const e=(0,x.Ek)(this,new s.u);return e.append(this.localTransform),e.applyInverse(t,i)}return this.worldTransform.applyInverse(t,i)}};var I=i(848);class O{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new s.u,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new I.L,this._onRenderContainers=[]}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let t=0;t<e.length;t++)this.addChild(e[t])}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup)return void this.addRenderGroupChild(t.renderGroup);t._onRender&&this.addOnRender(t);const e=t.children;for(let t=0;t<e.length;t++)this.addChild(e[t])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup)return void this._removeRenderGroupChild(t.renderGroup);const e=t.children;for(let t=0;t<e.length;t++)this.removeChild(e[t])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let t=0;t<i.length;t++)this._getChildren(i[t],e);return e}}const k=new a.o(null),E=new a.o(null),R=new a.o(null,1,1),z=1,F=2,U=4;class D extends n.A{constructor(t={}){super(),this.uid=(0,l.L)("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new s.u,this.relativeGroupTransform=new s.u,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new a.o(this,0,0),this._scale=R,this._pivot=E,this._skew=k,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],function(t,e,i={}){for(const n in e)i[n]||void 0===e[n]||(t[n]=e[n])}(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach((t=>this.addChild(t))),t.parent?.addChild(this)}static mixin(t){Object.defineProperties(D.prototype,Object.getOwnPropertyDescriptors(t))}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=4095&t}get _didChangeId(){return 4095&this._didContainerChangeTick|(4095&this._didViewChangeTick)<<12}addChild(...t){if(this.allowChildren||(0,u.t6)(u.lj,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let e=0;e<t.length;e++)this.addChild(t[e]);return t[0]}const e=t[0];if(e.parent===this)return this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),e;e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,0!==e._zIndex&&e.depthOfChildModified(),e}removeChild(...t){if(t.length>1){for(let e=0;e<t.length;e++)this.removeChild(t[e]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,this.didChange||(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),this.renderGroup=h.Z.get(O,this),this.groupTransform=s.u.IDENTITY,t?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),h.Z.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&0===this.effects.length}get worldTransform(){return this._worldTransform||(this._worldTransform=new s.u),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*o.bO}set angle(t){this.rotation=t*o.Td}get pivot(){return this._pivot===E&&(this._pivot=new a.o(this,0,0)),this._pivot}set pivot(t){this._pivot===E&&(this._pivot=new a.o(this,0,0)),"number"==typeof t?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===k&&(this._skew=new a.o(this,0,0)),this._skew}set skew(t){this._skew===k&&(this._skew=new a.o(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===R&&(this._scale=new a.o(this,1,1)),this._scale}set scale(t){this._scale===R&&(this._scale=new a.o(this,0,0)),"number"==typeof t?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();"object"==typeof t?(e=t.height??t.width,t=t.width):e??(e=t),void 0!==t&&this._setWidth(t,i.width),void 0!==e&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set("number"==typeof t.x?t.x:this.position.x,"number"==typeof t.y?t.y:this.position.y),this.scale.set("number"==typeof t.scaleX?t.scaleX||1:this.scale.x,"number"==typeof t.scaleY?t.scaleY||1:this.scale.y),this.rotation="number"==typeof t.rotation?t.rotation:this.rotation,this.skew.set("number"==typeof t.skewX?t.skewX:this.skew.x,"number"==typeof t.skewY?t.skewY:this.skew.y),this.pivot.set("number"==typeof t.pivotX?t.pivotX:this.pivot.x,"number"==typeof t.pivotY?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,n=this._pivot,r=this._position,s=i._x,o=i._y,a=n._x,l=n._y;e.a=this._cx*s,e.b=this._sx*s,e.c=this._cy*o,e.d=this._sy*o,e.tx=r._x-(a*e.a+l*e.c),e.ty=r._y-(a*e.b+l*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=z,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const e=r.Q.shared.setValue(t??16777215).toBgrNumber();e!==this.localColor&&(this.localColor=e,this._updateFlags|=z,this._onUpdate())}get tint(){const t=this.localColor;return((255&t)<<16)+(65280&t)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=F,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(2&this.localDisplayStatus)}set visible(t){const e=t?2:0;(2&this.localDisplayStatus)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=U,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(4&this.localDisplayStatus)}set culled(t){const e=t?0:4;(4&this.localDisplayStatus)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=U,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(1&this.localDisplayStatus)}set renderable(t){const e=t?1:0;(1&this.localDisplayStatus)!==e&&(this._updateFlags|=U,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return 7===this.localDisplayStatus&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;this.destroyed=!0;const e=this.removeChildren(0,this.children.length);this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners();if("boolean"==typeof t?t:t?.children)for(let i=0;i<e.length;++i)e[i].destroy(t);this.renderGroup?.destroy(),this.renderGroup=null}}D.mixin(d),D.mixin(M),D.mixin(C),D.mixin(S),D.mixin(g),D.mixin(v),D.mixin(A),D.mixin({cullArea:null,cullable:!1,cullableChildren:!0})},9636:(t,e,i)=>{"use strict";i.d(e,{c:()=>o});var n=i(9313),r=i(9252);const s=new n.u;class o{constructor(t=1/0,e=1/0,i=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=s,this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new r.M);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=s,this}set(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}addFrame(t,e,i,n,r){r||(r=this.matrix);const s=r.a,o=r.b,a=r.c,l=r.d,u=r.tx,h=r.ty;let c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=s*t+a*e+u,g=o*t+l*e+h;m<c&&(c=m),g<d&&(d=g),m>f&&(f=m),g>p&&(p=g),m=s*i+a*e+u,g=o*i+l*e+h,m<c&&(c=m),g<d&&(d=g),m>f&&(f=m),g>p&&(p=g),m=s*t+a*n+u,g=o*t+l*n+h,m<c&&(c=m),g<d&&(d=g),m>f&&(f=m),g>p&&(p=g),m=s*i+a*n+u,g=o*i+l*n+h,m<c&&(c=m),g<d&&(d=g),m>f&&(f=m),g>p&&(p=g),this.minX=c,this.minY=d,this.maxX=f,this.maxY=p}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,{a:s,b:o,c:a,d:l,tx:u,ty:h}=t;let c=s*e+a*i+u,d=o*e+l*i+h;this.minX=c,this.minY=d,this.maxX=c,this.maxY=d,c=s*n+a*i+u,d=o*n+l*i+h,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY,c=s*e+a*r+u,d=o*e+l*r+h,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY,c=s*n+a*r+u,d=o*n+l*r+h,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new o(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,n){let r=this.minX,s=this.minY,o=this.maxX,a=this.maxY;n||(n=this.matrix);const l=n.a,u=n.b,h=n.c,c=n.d,d=n.tx,f=n.ty;for(let n=e;n<i;n+=2){const e=t[n],i=t[n+1],p=l*e+h*i+d,m=u*e+c*i+f;r=p<r?p:r,s=m<s?m:s,o=p>o?p:o,a=m>a?m:a}this.minX=r,this.minY=s,this.maxX=o,this.maxY=a}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}},9443:(t,e,i)=>{"use strict";i.d(e,{Ek:()=>a,fB:()=>s});var n=i(9313),r=i(2208);function s(t,e,i){let s,l;return i.clear(),t.parent?e?s=t.parent.worldTransform:(l=r.u.get().identity(),s=a(t,l)):s=n.u.IDENTITY,o(t,i,s,e),l&&r.u.return(l),i.isValid||i.set(0,0,0,0),i}function o(t,e,i,s){if(!t.visible||!t.measurable)return;let a;s?a=t.worldTransform:(t.updateLocalTransform(),a=r.u.get(),a.appendFrom(t.localTransform,i));const l=e,u=!!t.effects.length;if(u&&(e=r.o.get().clear()),t.boundsArea)e.addRect(t.boundsArea,a);else{t.addBounds&&(e.matrix=a,t.addBounds(e));for(let i=0;i<t.children.length;i++)o(t.children[i],e,a,s)}if(u){for(let i=0;i<t.effects.length;i++)t.effects[i].addBounds?.(e);l.addBounds(e,n.u.IDENTITY),r.o.return(e)}s||r.u.return(a)}function a(t,e){const i=t.parent;return i&&(a(i,e),i.updateLocalTransform(),e.append(i.localTransform)),e}},7269:(t,e,i)=>{"use strict";i.d(e,{n:()=>s});var n=i(9313),r=i(2208);function s(t,e,i){return e.clear(),i||(i=n.u.IDENTITY),o(t,e,i,t,!0),e.isValid||e.set(0,0,0,0),e}function o(t,e,i,s,a){let l;if(a)l=r.u.get(),l=i.copyTo(l);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const e=t.localTransform;l=r.u.get(),l.appendFrom(e,i)}const u=e,h=!!t.effects.length;if(h&&(e=r.o.get().clear()),t.boundsArea)e.addRect(t.boundsArea,l);else{t.renderPipeId&&(e.matrix=l,t.addBounds(e));const i=t.children;for(let t=0;t<i.length;t++)o(i[t],e,l,s,!1)}if(h){for(let i=0;i<t.effects.length;i++)t.effects[i].addLocalBounds?.(e,s);u.addBounds(e,n.u.IDENTITY),r.o.return(e)}r.u.return(l)}},2208:(t,e,i)=>{"use strict";i.d(e,{o:()=>a,u:()=>o});var n=i(9313),r=i(8425),s=i(9636);const o=new r.b(n.u),a=new r.b(s.c)},4389:(t,e,i)=>{"use strict";i.d(e,{G:()=>r});const n=new(i(9313).u);class r{constructor(){this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|65280&t|(255&t)<<16,i=this.renderable;return i?(n=e,r=i.groupColor,(16777215!==n&&r?16777215!==r&&n?((n>>16&255)*(r>>16&255)/255<<16)+((n>>8&255)*(r>>8&255)/255<<8)+(255&n)*(255&r)/255:n:r)+(this.alpha*i.groupAlpha*255<<24)):e+(255*this.alpha<<24);var n,r}get transform(){return this.renderable?.groupTransform||n}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData}reset(){this.applyTransform=!0,this.renderable=null}}},9408:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(4670),r=i(4985),s=i(4835);class o extends r.l{constructor(t){t instanceof s.T&&(t={context:t});const{context:e,roundPixels:i,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",this._context=e||(this._ownedContext=new s.T),this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):!0!==t&&!0!==t?.context||this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){if(t)return new o(this._context.clone());this._ownedContext=null;return new o(this._context)}lineStyle(t,e,i){(0,n.t6)(n.lj,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),i&&(r.alpha=i),this.context.strokeStyle=r,this}beginFill(t,e){(0,n.t6)(n.lj,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t&&(i.color=t),e&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){(0,n.t6)(n.lj,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return t.width===s.T.defaultStrokeStyle.width&&t.color===s.T.defaultStrokeStyle.color&&t.alpha===s.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...t){return(0,n.t6)(n.lj,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return(0,n.t6)(n.lj,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return(0,n.t6)(n.lj,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return(0,n.t6)(n.lj,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return(0,n.t6)(n.lj,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return(0,n.t6)(n.lj,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}},4835:(t,e,i)=>{"use strict";i.d(e,{T:()=>j});var n=i(8875),r=i(2577),s=i(9313),o=i(5101),a=i(4492),l=i(133),u=i(4670),h=i(9636),c=i(268),d=i(8133);var f=i(9252);class p{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new p(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=i}strokeContains(t,e,i){if(0===this.radius)return!1;const n=this.x-t,r=this.y-e,s=this.radius,o=i/2,a=Math.sqrt(n*n+r*r);return a<s+o&&a>s-o}getBounds(t){return(t=t||new f.M).x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class m{constructor(t=0,e=0,i=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=n}clone(){return new m(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return i*=i,n*=n,i+n<=1}strokeContains(t,e,i){const{halfWidth:n,halfHeight:r}=this;if(n<=0||r<=0)return!1;const s=i/2,o=n-s,a=r-s,l=n+s,u=r+s,h=t-this.x,c=e-this.y;return h*h/(o*o)+c*c/(a*a)>1&&h*h/(l*l)+c*c/(u*u)<=1}getBounds(t){return(t=t||new f.M).x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=2*this.halfWidth,t.height=2*this.halfHeight,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function g(t,e,i,n,r,s){const o=r-i,a=s-n,l=o*o+a*a;let u,h,c=-1;0!==l&&(c=((t-i)*o+(e-n)*a)/l),c<0?(u=i,h=n):c>1?(u=r,h=s):(u=i+c*o,h=n+c*a);const d=t-u,f=e-h;return d*d+f*f}class v{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let i=0,n=e.length;i<n;i++)t.push(e[i].x,e[i].y);e=t}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new v(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const n=this.points.length/2;for(let r=0,s=n-1;r<n;s=r++){const n=this.points[2*r],o=this.points[2*r+1],a=this.points[2*s],l=this.points[2*s+1];o>e!=l>e&&t<(e-o)/(l-o)*(a-n)+n&&(i=!i)}return i}strokeContains(t,e,i){const n=i/2,r=n*n,{points:s}=this,o=s.length-(this.closePath?0:2);for(let i=0;i<o;i+=2){if(g(t,e,s[i],s[i+1],s[(i+2)%s.length],s[(i+3)%s.length])<=r)return!0}return!1}getBounds(t){t=t||new f.M;const e=this.points;let i=1/0,n=-1/0,r=1/0,s=-1/0;for(let t=0,o=e.length;t<o;t+=2){const o=e[t],a=e[t+1];i=o<i?o:i,n=o>n?o:n,r=a<r?a:r,s=a>s?a:s}return t.x=i,t.width=n-i,t.y=r,t.height=s-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce(((t,e)=>`${t}, ${e}`),"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const y=(t,e,i,n,r,s)=>{const o=t-i,a=e-n,l=Math.sqrt(o*o+a*a);return l>=r-s&&l<=r+s};class x{constructor(t=0,e=0,i=0,n=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=n,this.radius=r}getBounds(t){return(t=t||new f.M).x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new x(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),r=e-(this.y+i);const s=i*i;if(n*n+r*r<=s)return!0;if(n=t-(this.x+this.width-i),n*n+r*r<=s)return!0;if(r=e-(this.y+this.height-i),n*n+r*r<=s)return!0;if(n=t-(this.x+i),n*n+r*r<=s)return!0}return!1}strokeContains(t,e,i){const{x:n,y:r,width:s,height:o,radius:a}=this,l=i/2,u=n+a,h=r+a,c=n+s,d=r+o;return(t>=n-l&&t<=n+l||t>=c-l&&t<=c+l)&&e>=h&&e<=h+(o-2*a)||((e>=r-l&&e<=r+l||e>=d-l&&e<=d+l)&&t>=u&&t<=u+(s-2*a)||(t<u&&e<h&&y(t,e,u,h,a,l)||t>c-a&&e<h&&y(t,e,c-a,h,a,l)||t>c-a&&e>d-a&&y(t,e,c-a,d-a,a,l)||t<u&&e>d-a&&y(t,e,u,d-a,a,l)))}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var _=i(3428);const b=1.1920929e-7;function w(t,e,i,n,r,s,o,a,l,u){let h=(1-Math.min(.99,Math.max(0,u??_.GH.defaultOptions.bezierSmoothness)))/1;return h*=h,function(t,e,i,n,r,s,o,a,l,u){S(t,e,i,n,r,s,o,a,l,u,0),l.push(o,a)}(e,i,n,r,s,o,a,l,t,h),t}function S(t,e,i,n,r,s,o,a,l,u,h){if(h>8)return;Math.PI;const c=(t+i)/2,d=(e+n)/2,f=(i+r)/2,p=(n+s)/2,m=(r+o)/2,g=(s+a)/2,v=(c+f)/2,y=(d+p)/2,x=(f+m)/2,_=(p+g)/2,w=(v+x)/2,C=(y+_)/2;if(h>0){let h=o-t,c=a-e;const d=Math.abs((i-o)*c-(n-a)*h),f=Math.abs((r-o)*c-(s-a)*h);if(d>b&&f>b){if((d+f)*(d+f)<=u*(h*h+c*c))return void l.push(w,C)}else if(d>b){if(d*d<=u*(h*h+c*c))return void l.push(w,C)}else if(f>b){if(f*f<=u*(h*h+c*c))return void l.push(w,C)}else if(h=w-(t+o)/2,c=C-(e+a)/2,h*h+c*c<=u)return void l.push(w,C)}S(t,e,c,d,v,y,w,C,l,u,h+1),S(w,C,x,_,m,g,o,a,l,u,h+1)}function C(t,e,i,n,r,s,o,a){let l=(1-Math.min(.99,Math.max(0,a??_.GH.defaultOptions.bezierSmoothness)))/1;return l*=l,function(t,e,i,n,r,s,o,a){A(o,t,e,i,n,r,s,a,0),o.push(r,s)}(e,i,n,r,s,o,t,l),t}function A(t,e,i,n,r,s,o,a,l){if(l>8)return;Math.PI;const u=(e+n)/2,h=(i+r)/2,c=(n+s)/2,d=(r+o)/2,f=(u+c)/2,p=(h+d)/2;let m=s-e,g=o-i;const v=Math.abs((n-s)*g-(r-o)*m);if(v>1.1920929e-7){if(v*v<=a*(m*m+g*g))return void t.push(f,p)}else if(m=f-(e+s)/2,g=p-(i+o)/2,m*m+g*g<=a)return void t.push(f,p);A(t,e,i,u,h,f,p,a,l+1),A(t,f,p,c,d,s,o,a,l+1)}function T(t,e,i,n,r,s,o,a){let l=Math.abs(r-s);(!o&&r>s||o&&s>r)&&(l=2*Math.PI-l),a=a||Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI)));let u=l/(a=Math.max(a,3)),h=r;u*=o?-1:1;for(let r=0;r<a+1;r++){const r=e+Math.cos(h)*n,s=i+Math.sin(h)*n;t.push(r,s),h+=u}}const P=2*Math.PI,M={centerX:0,centerY:0,ang1:0,ang2:0},I=({x:t,y:e},i,n,r,s,o,a,l)=>{const u=r*(t*=i)-s*(e*=n),h=s*t+r*e;return l.x=u+o,l.y=h+a,l};function O(t,e){const i=-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),n=1.5707963267948966===e?.551915024494:i,r=Math.cos(t),s=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:r-s*n,y:s+r*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const k=(t,e,i,n)=>{let r=t*i+e*n;return r>1&&(r=1),r<-1&&(r=-1),(t*n-e*i<0?-1:1)*Math.acos(r)};function E(t,e,i,n,r,s,o,a=0,l=0,u=0){if(0===s||0===o)return;const h=Math.sin(a*P/360),c=Math.cos(a*P/360),d=c*(e-n)/2+h*(i-r)/2,f=-h*(e-n)/2+c*(i-r)/2;if(0===d&&0===f)return;s=Math.abs(s),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(s,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(s*=Math.sqrt(p),o*=Math.sqrt(p)),((t,e,i,n,r,s,o,a,l,u,h,c,d)=>{const f=Math.pow(r,2),p=Math.pow(s,2),m=Math.pow(h,2),g=Math.pow(c,2);let v=f*p-f*g-p*m;v<0&&(v=0),v/=f*g+p*m,v=Math.sqrt(v)*(o===a?-1:1);const y=v*r/s*c,x=v*-s/r*h,_=u*y-l*x+(t+i)/2,b=l*y+u*x+(e+n)/2,w=(h-y)/r,S=(c-x)/s,C=(-h-y)/r,A=(-c-x)/s,T=k(1,0,w,S);let M=k(w,S,C,A);0===a&&M>0&&(M-=P),1===a&&M<0&&(M+=P),d.centerX=_,d.centerY=b,d.ang1=T,d.ang2=M})(e,i,n,r,s,o,l,u,h,c,d,f,M);let{ang1:m,ang2:g}=M;const{centerX:v,centerY:y}=M;let x=Math.abs(g)/(P/4);Math.abs(1-x)<1e-7&&(x=1);const _=Math.max(Math.ceil(x),1);g/=_;let b=t[t.length-2],S=t[t.length-1];const C={x:0,y:0};for(let e=0;e<_;e++){const e=O(m,g),{x:i,y:n}=I(e[0],s,o,c,h,v,y,C),{x:r,y:a}=I(e[1],s,o,c,h,v,y,C),{x:l,y:u}=I(e[2],s,o,c,h,v,y,C);w(t,b,S,i,n,r,a,l,u),b=l,S=u,m+=g}}const R=new f.M;class z{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new h.c,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,n=i[i.length-2],r=i[i.length-1];return n===t&&r===e||i.push(t,e),this}arc(t,e,i,n,r,s){this._ensurePoly(!1);return T(this._currentPoly.points,t,e,i,n,r,s),this}arcTo(t,e,i,n,r){this._ensurePoly();return function(t,e,i,n,r,s){const o=t[t.length-2],a=t[t.length-1]-i,l=o-e,u=r-i,h=n-e,c=Math.abs(a*h-l*u);if(c<1e-8||0===s)return void(t[t.length-2]===e&&t[t.length-1]===i||t.push(e,i));const d=a*a+l*l,f=u*u+h*h,p=a*u+l*h,m=s*Math.sqrt(d)/c,g=s*Math.sqrt(f)/c,v=m*p/d,y=g*p/f,x=m*h+g*l,_=m*u+g*a,b=l*(g+v),w=a*(g+v),S=h*(m+y),C=u*(m+y);T(t,x+e,_+i,s,Math.atan2(w-_,b-x),Math.atan2(C-_,S-x),l*u>h*a)}(this._currentPoly.points,t,e,i,n,r),this}arcToSvg(t,e,i,n,r,s,o){return E(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,s,o,t,e,i,n,r),this}bezierCurveTo(t,e,i,n,r,s,o){this._ensurePoly();const a=this._currentPoly;return w(this._currentPoly.points,a.lastX,a.lastY,t,e,i,n,r,s,o),this}quadraticCurveTo(t,e,i,n,r){this._ensurePoly();const s=this._currentPoly;return C(this._currentPoly.points,s.lastX,s.lastY,t,e,i,n,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0)).transform(e);for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,n,r){return this.drawShape(new f.M(t,e,i,n),r),this}circle(t,e,i,n){return this.drawShape(new p(t,e,i),n),this}poly(t,e,i){const n=new v(t);return n.closePath=e,this.drawShape(n,i),this}regularPoly(t,e,i,n,r=0,s){n=Math.max(0|n,3);const o=-1*Math.PI/2+r,a=2*Math.PI/n,l=[];for(let r=0;r<n;r++){const n=r*a+o;l.push(t+i*Math.cos(n),e+i*Math.sin(n))}return this.poly(l,!0,s),this}roundPoly(t,e,i,n,r,s=0,o){if(n=Math.max(0|n,3),r<=0)return this.regularPoly(t,e,i,n,s);const a=i*Math.sin(Math.PI/n)-.001;r=Math.min(r,a);const l=-1*Math.PI/2+s,u=2*Math.PI/n,h=(n-2)*Math.PI/n/2;for(let s=0;s<n;s++){const n=s*u+l,a=t+i*Math.cos(n),c=e+i*Math.sin(n),d=n+Math.PI+h,f=n-Math.PI-h,p=a+r*Math.cos(d),m=c+r*Math.sin(d),g=a+r*Math.cos(f),v=c+r*Math.sin(f);0===s?this.moveTo(p,m):this.lineTo(p,m),this.quadraticCurveTo(a,c,g,v,o)}return this.closePath()}roundShape(t,e,i=!1,n){return t.length<3?this:(i?function(t,e,i,n){const r=(t,e)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),s=(t,e,i)=>({x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],u=l.radius??i;if(u<=0){0===a?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const h=e[a],c=e[(a+2)%o],d=r(h,l);let f;f=d<1e-4?l:s(l,h,Math.min(d/2,u)/d);const p=r(c,l);let m;m=p<1e-4?l:s(l,c,Math.min(p/2,u)/p),0===a?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,m.x,m.y,n)}}(this,t,e,n):function(t,e,i){const n=(t,e)=>{const i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n);return{len:r,nx:i/r,ny:n/r}},r=(e,i)=>{0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y)};let s=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??i;if(l<=0){r(o,a),s=a;continue}const u=e[(o+1)%e.length],h=n(a,s),c=n(a,u);if(h.len<1e-4||c.len<1e-4){r(o,a),s=a;continue}let d=Math.asin(h.nx*c.ny-h.ny*c.nx),f=1,p=!1;h.nx*c.nx-h.ny*-c.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const m=d/2;let g,v=Math.abs(Math.cos(m)*l/Math.sin(m));v>Math.min(h.len/2,c.len/2)?(v=Math.min(h.len/2,c.len/2),g=Math.abs(v*Math.sin(m)/Math.cos(m))):g=l;const y=a.x+c.nx*v+-c.ny*g*f,x=a.y+c.ny*v+c.nx*g*f,_=Math.atan2(h.ny,h.nx)+Math.PI/2*f,b=Math.atan2(c.ny,c.nx)-Math.PI/2*f;0===o&&t.moveTo(y+Math.cos(_)*g,x+Math.sin(_)*g),t.arc(y,x,g,_,b,p),s=a}}(this,t,e),this.closePath())}filletRect(t,e,i,n,r){if(0===r)return this.rect(t,e,i,n);const s=Math.min(i,n)/2,o=Math.min(s,Math.max(-s,r)),a=t+i,l=e+n,u=o<0?-o:0,h=Math.abs(o);return this.moveTo(t,e+h).arcTo(t+u,e+u,t+h,e,h).lineTo(a-h,e).arcTo(a-u,e+u,a,e+h,h).lineTo(a,l-h).arcTo(a-u,l-u,t+i-h,l,h).lineTo(t+h,l).arcTo(t+u,l-u,t,l-h,h).closePath()}chamferRect(t,e,i,n,r,s){if(r<=0)return this.rect(t,e,i,n);const o=Math.min(r,Math.min(i,n)/2),a=t+i,l=e+n,u=[t+o,e,a-o,e,a,e+o,a,l-o,a-o,l,t+o,l,t,l-o,t,e+o];for(let t=u.length-1;t>=2;t-=2)u[t]===u[t-2]&&u[t-1]===u[t-3]&&u.splice(t-1,2);return this.poly(u,!0,s)}ellipse(t,e,i,n,r){return this.drawShape(new m(t,e,i,n),r),this}roundRect(t,e,i,n,r,s){return this.drawShape(new x(t,e,i,n,r),s),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new v,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new v,t)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let e=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const n=t.transform,r=e;e=n.a*e+n.c*i+n.tx,i=n.b*r+n.d*i+n.ty}this._currentPoly.points.push(e,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const n=e[i],r=n.shape.getBounds(R);n.transform?t.addRect(r,n.transform):t.addRect(r)}return t}}class F{constructor(t){this.instructions=[],this.uid=(0,l.L)("graphicsPath"),this._dirty=!0,"string"==typeof t?function(t,e){const i=d(t),n=[];let r=null,s=0,o=0;for(let t=0;t<i.length;t++){const a=i[t],l=a[0],u=a;switch(l){case"M":s=u[1],o=u[2],e.moveTo(s,o);break;case"m":s+=u[1],o+=u[2],e.moveTo(s,o);break;case"H":s=u[1],e.lineTo(s,o);break;case"h":s+=u[1],e.lineTo(s,o);break;case"V":o=u[1],e.lineTo(s,o);break;case"v":o+=u[1],e.lineTo(s,o);break;case"L":s=u[1],o=u[2],e.lineTo(s,o);break;case"l":s+=u[1],o+=u[2],e.lineTo(s,o);break;case"C":s=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],s,o);break;case"c":e.bezierCurveTo(s+u[1],o+u[2],s+u[3],o+u[4],s+u[5],o+u[6]),s+=u[5],o+=u[6];break;case"S":s=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],s,o);break;case"s":e.bezierCurveToShort(s+u[1],o+u[2],s+u[3],o+u[4]),s+=u[3],o+=u[4];break;case"Q":s=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],s,o);break;case"q":e.quadraticCurveTo(s+u[1],o+u[2],s+u[3],o+u[4]),s+=u[3],o+=u[4];break;case"T":s=u[1],o=u[2],e.quadraticCurveToShort(s,o);break;case"t":s+=u[1],o+=u[2],e.quadraticCurveToShort(s,o);break;case"A":s=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],s,o);break;case"a":s+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],s,o);break;case"Z":case"z":e.closePath(),n.length>0&&(r=n.pop(),r?(s=r.startX,o=r.startY):(s=0,o=0)),r=null;break;default:(0,c.R)(`Unknown SVG path command: ${l}`)}"Z"!==l&&"z"!==l&&null===r&&(r={startX:s,startY:o},n.push(r))}}(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new z(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,n,r){const s=this.instructions[this.instructions.length-1],a=this.getLastPoint(o.b.shared);let l=0,u=0;if(s&&"bezierCurveTo"===s.action){l=s.data[2],u=s.data[3];const t=a.x,e=a.y;l=t+(t-l),u=e+(e-u)}else l=a.x,u=a.y;return this.instructions.push({action:"bezierCurveTo",data:[l,u,t,e,i,n,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const n=this.instructions[this.instructions.length-1],r=this.getLastPoint(o.b.shared);let s=0,a=0;if(n&&"quadraticCurveTo"===n.action){s=n.data[0],a=n.data[1];const t=r.x,e=r.y;s=t+(t-s),a=e+(e-a)}else s=r.x,a=r.y;return this.instructions.push({action:"quadraticCurveTo",data:[s,a,t,e,i]}),this._dirty=!0,this}rect(t,e,i,n,r){return this.instructions.push({action:"rect",data:[t,e,i,n,r]}),this._dirty=!0,this}circle(t,e,i,n){return this.instructions.push({action:"circle",data:[t,e,i,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,n,r,s,o){r=r||n/2;const a=-1*Math.PI/2+s,l=2*i,u=2*Math.PI/l,h=[];for(let i=0;i<l;i++){const s=i%2?r:n,o=i*u+a;h.push(t+s*Math.cos(o),e+s*Math.sin(o))}return this.poly(h,!0,o),this}clone(t=!1){const e=new F;if(t)for(let t=0;t<this.instructions.length;t++){const i=this.instructions[t];e.instructions.push({action:i.action,data:i.data.slice()})}else e.instructions=this.instructions.slice();return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,n=t.c,r=t.d,s=t.tx,o=t.ty;let a=0,l=0,u=0,h=0,d=0,f=0,p=0,m=0;for(let g=0;g<this.instructions.length;g++){const v=this.instructions[g],y=v.data;switch(v.action){case"moveTo":case"lineTo":a=y[0],l=y[1],y[0]=e*a+n*l+s,y[1]=i*a+r*l+o;break;case"bezierCurveTo":u=y[0],h=y[1],d=y[2],f=y[3],a=y[4],l=y[5],y[0]=e*u+n*h+s,y[1]=i*u+r*h+o,y[2]=e*d+n*f+s,y[3]=i*d+r*f+o,y[4]=e*a+n*l+s,y[5]=i*a+r*l+o;break;case"quadraticCurveTo":u=y[0],h=y[1],a=y[2],l=y[3],y[0]=e*u+n*h+s,y[1]=i*u+r*h+o,y[2]=e*a+n*l+s,y[3]=i*a+r*l+o;break;case"arcToSvg":a=y[5],l=y[6],p=y[0],m=y[1],y[0]=e*p+n*m,y[1]=i*p+r*m,y[5]=e*a+n*l+s,y[6]=i*a+r*l+o;break;case"circle":y[4]=U(y[3],t);break;case"rect":y[4]=U(y[4],t);break;case"ellipse":y[8]=U(y[8],t);break;case"roundRect":y[5]=U(y[5],t);break;case"addPath":y[0].transform(t);break;case"poly":y[2]=U(y[2],t);break;default:(0,c.R)("unknown transform action",v.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;"closePath"===i.action;){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t)}return t}}function U(t,e){return t?t.prepend(e):e.clone()}function D(t,e){if("string"==typeof t){const e=document.createElement("div");e.innerHTML=t.trim(),t=e.querySelector("svg")}return B(t,{context:e,path:new F},null,null),e}function B(t,e,i,n){const s=t.children,{fillStyle:o,strokeStyle:a}=function(t){const e=t.getAttribute("style"),i={},n={};let s=!1,o=!1;if(e){const t=e.split(";");for(let e=0;e<t.length;e++){const a=t[e],[l,u]=a.split(":");switch(l){case"stroke":"none"!==u&&(i.color=r.Q.shared.setValue(u).toNumber(),o=!0);break;case"stroke-width":i.width=Number(u);break;case"fill":"none"!==u&&(s=!0,n.color=r.Q.shared.setValue(u).toNumber());break;case"fill-opacity":n.alpha=Number(u);break;case"stroke-opacity":i.alpha=Number(u);break;case"opacity":n.alpha=Number(u),i.alpha=Number(u)}}}else{const e=t.getAttribute("stroke");e&&"none"!==e&&(o=!0,i.color=r.Q.shared.setValue(e).toNumber(),i.width=L(t,"stroke-width",1));const a=t.getAttribute("fill");a&&"none"!==a&&(s=!0,n.color=r.Q.shared.setValue(a).toNumber())}return{strokeStyle:o?i:null,fillStyle:s?n:null}}(t);let l,u,h,c,d,f,p,m,g,v,y,x,_,b,w,S,C;switch(o&&i?i={...i,...o}:o&&(i=o),a&&n?n={...n,...a}:a&&(n=a),e.context.fillStyle=i,e.context.strokeStyle=n,t.nodeName.toLowerCase()){case"path":b=t.getAttribute("d"),w=new F(b),e.context.path(w),i&&e.context.fill(),n&&e.context.stroke();break;case"circle":p=L(t,"cx",0),m=L(t,"cy",0),g=L(t,"r",0),e.context.ellipse(p,m,g,g),i&&e.context.fill(),n&&e.context.stroke();break;case"rect":l=L(t,"x",0),u=L(t,"y",0),S=L(t,"width",0),C=L(t,"height",0),v=L(t,"rx",0),y=L(t,"ry",0),v||y?e.context.roundRect(l,u,S,C,v||y):e.context.rect(l,u,S,C),i&&e.context.fill(),n&&e.context.stroke();break;case"ellipse":p=L(t,"cx",0),m=L(t,"cy",0),v=L(t,"rx",0),y=L(t,"ry",0),e.context.beginPath(),e.context.ellipse(p,m,v,y),i&&e.context.fill(),n&&e.context.stroke();break;case"line":h=L(t,"x1",0),c=L(t,"y1",0),d=L(t,"x2",0),f=L(t,"y2",0),e.context.beginPath(),e.context.moveTo(h,c),e.context.lineTo(d,f),n&&e.context.stroke();break;case"polygon":_=t.getAttribute("points"),x=_.match(/\d+/g).map((t=>parseInt(t,10))),e.context.poly(x,!0),i&&e.context.fill(),n&&e.context.stroke();break;case"polyline":_=t.getAttribute("points"),x=_.match(/\d+/g).map((t=>parseInt(t,10))),e.context.poly(x,!1),n&&e.context.stroke();break;case"g":case"svg":break;default:console.info(`[SVG parser] <${t.nodeName}> elements unsupported`)}for(let t=0;t<s.length;t++)B(s[t],e,i,n)}function L(t,e,i){const n=t.getAttribute(e);return n?Number(n):i}var N=i(990);const $=new o.b,V=new s.u,G=class t extends n.A{constructor(){super(...arguments),this.uid=(0,l.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new F,this._transform=new s.u,this._fillStyle={...t.defaultFillStyle},this._strokeStyle={...t.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new h.c,this._boundsDirty=!0}clone(){const e=new t;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=(0,N.w)(e,t.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=(0,N.T)(e,t.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=(0,N.w)(e,t.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=(0,N.w)(e,t.defaultStrokeStyle),this}texture(t,e,i,n,s,o){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:n||0,dw:s||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?r.Q.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new F,this}fill(e,i){let n;const r=this.instructions[this.instructions.length-1];return n=0===this._tick&&r&&"stroke"===r.action?r.data.path:this._activePath.clone(),n?(null!=e&&(void 0!==i&&"number"==typeof e&&((0,u.t6)(u.lj,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:i}),this._fillStyle=(0,N.w)(e,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(o.b.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(e){let i;const n=this.instructions[this.instructions.length-1];return i=0===this._tick&&n&&"fill"===n.action?n.data.path:this._activePath.clone(),i?(null!=e&&(this._strokeStyle=(0,N.T)(e,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&("stroke"===e.action||"fill"===e.action)){if(!e.data.hole){e.data.hole=i;break}e.data.hole.addPath(i)}}return this._initNextPathLocation(),this}arc(t,e,i,n,r,s){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,i,n,r,s),this}arcTo(t,e,i,n,r){this._tick++;const s=this._transform;return this._activePath.arcTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty,s.a*i+s.c*n+s.tx,s.b*i+s.d*n+s.ty,r),this}arcToSvg(t,e,i,n,r,s,o){this._tick++;const a=this._transform;return this._activePath.arcToSvg(t,e,i,n,r,a.a*s+a.c*o+a.tx,a.b*s+a.d*o+a.ty),this}bezierCurveTo(t,e,i,n,r,s,o){this._tick++;const a=this._transform;return this._activePath.bezierCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*n+a.tx,a.b*i+a.d*n+a.ty,a.a*r+a.c*s+a.tx,a.b*r+a.d*s+a.ty,o),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,i,n){return this._tick++,this._activePath.ellipse(t,e,i,n,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,n=this._activePath.instructions,r=i.a*t+i.c*e+i.tx,s=i.b*t+i.d*e+i.ty;return 1===n.length&&"moveTo"===n[0].action?(n[0].data[0]=r,n[0].data[1]=s,this):(this._activePath.moveTo(r,s),this)}quadraticCurveTo(t,e,i,n,r){this._tick++;const s=this._transform;return this._activePath.quadraticCurveTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty,s.a*i+s.c*n+s.tx,s.b*i+s.d*n+s.ty,r),this}rect(t,e,i,n){return this._tick++,this._activePath.rect(t,e,i,n,this._transform.clone()),this}roundRect(t,e,i,n,r){return this._tick++,this._activePath.roundRect(t,e,i,n,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,n,r=0,s){return this._tick++,this._activePath.regularPoly(t,e,i,n,r,s),this}roundPoly(t,e,i,n,r,s){return this._tick++,this._activePath.roundPoly(t,e,i,n,r,s),this}roundShape(t,e,i,n){return this._tick++,this._activePath.roundShape(t,e,i,n),this}filletRect(t,e,i,n,r){return this._tick++,this._activePath.filletRect(t,e,i,n,r),this}chamferRect(t,e,i,n,r,s){return this._tick++,this._activePath.chamferRect(t,e,i,n,r,s),this}star(t,e,i,n,r=0,s=0){return this._tick++,this._activePath.star(t,e,i,n,r,s,this._transform.clone()),this}svg(t){return this._tick++,D(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,n,r,o){return t instanceof s.u?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,n,r,o),this)}transform(t,e,i,n,r,o){return t instanceof s.u?(this._transform.append(t),this):(V.set(t,e,i,n,r,o),this._transform.append(V),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],n=i.action;if("fill"===n){const e=i.data;t.addBounds(e.path.bounds)}else if("texture"===n){const e=i.data;t.addFrame(e.dx,e.dy,e.dx+e.dw,e.dy+e.dh,e.transform)}if("stroke"===n){const e=i.data,n=e.style.width/2,r=e.path.bounds;t.addFrame(r.minX-n,r.minY-n,r.maxX+n,r.maxY+n)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let n=0;n<e.length;n++){const r=e[n],s=r.data,o=s.path;if(!r.action||!o)continue;const a=s.style,l=o.shapePath.shapePrimitives;for(let e=0;e<l.length;e++){const n=l[e].shape;if(!a||!n)continue;const o=l[e].transform,u=o?o.applyInverse(t,$):t;i="fill"===r.action?n.contains(u.x,u.y):n.strokeContains(u.x,u.y,a.width);const h=s.hole;if(h){const t=h.shapePath?.shapePrimitives;if(t)for(let e=0;e<t.length;e++)t[e].shape.contains(u.x,u.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners();if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(e),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(e)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};G.defaultFillStyle={color:16777215,alpha:1,texture:a.g.WHITE,matrix:null,fill:null},G.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:a.g.WHITE,matrix:null,fill:null};let j=G},3428:(t,e,i)=>{"use strict";i.d(e,{GH:()=>E});var n=i(8507),r=i(341),s=i(1159),o=i(848),a=i(4670),l=i(8218),u=i(9252);function h(t,e,i,n,r){const s=e.a,o=e.b,a=e.c,l=e.d,u=e.tx,h=e.ty;i=i||0,n=n||2,r=r||t.length/n-i;let c=i*n;for(let e=0;e<r;e++){const e=t[c],i=t[c+1];t[c]=s*e+a*i+u,t[c+1]=o*e+l*i+h,c+=n}}var c=i(4492),d=i(4389);const f={extension:{type:n.Ag.ShapeBuilder,name:"circle"},build(t,e){let i,n,r,s,o,a;if("circle"===t.type){const e=t;i=e.x,n=e.y,o=a=e.radius,r=s=0}else if("ellipse"===t.type){const e=t;i=e.x,n=e.y,o=e.halfWidth,a=e.halfHeight,r=s=0}else{const e=t,l=e.width/2,u=e.height/2;i=e.x+l,n=e.y+u,o=a=Math.max(0,Math.min(e.radius,Math.min(l,u))),r=l-o,s=u-a}if(!(o>=0&&a>=0&&r>=0&&s>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),u=8*l+(r?4:0)+(s?4:0);if(0===u)return e;if(0===l)return e[0]=e[6]=i+r,e[1]=e[3]=n+s,e[2]=e[4]=i-r,e[5]=e[7]=n-s,e;let h=0,c=4*l+(r?2:0)+2,d=c,f=u,p=r+o,m=s,g=i+p,v=i-p,y=n+m;if(e[h++]=g,e[h++]=y,e[--c]=y,e[--c]=v,s){const t=n-m;e[d++]=v,e[d++]=t,e[--f]=t,e[--f]=g}for(let t=1;t<l;t++){const u=Math.PI/2*(t/l),p=r+Math.cos(u)*o,m=s+Math.sin(u)*a,g=i+p,v=i-p,y=n+m,x=n-m;e[h++]=g,e[h++]=y,e[--c]=y,e[--c]=v,e[d++]=v,e[d++]=x,e[--f]=x,e[--f]=g}p=r,m=s+a,g=i+p,v=i-p,y=n+m;const x=n-m;return e[h++]=g,e[h++]=y,e[--f]=x,e[--f]=g,r&&(e[h++]=v,e[h++]=y,e[--f]=x,e[--f]=v),e},triangulate(t,e,i,n,r,s){if(0===t.length)return;let o=0,a=0;for(let e=0;e<t.length;e+=2)o+=t[e],a+=t[e+1];o/=t.length/2,a/=t.length/2;let l=n;e[l*i]=o,e[l*i+1]=a;const u=l++;for(let n=0;n<t.length;n+=2)e[l*i]=t[n],e[l*i+1]=t[n+1],n>0&&(r[s++]=l,r[s++]=u,r[s++]=l-1),l++;r[s++]=u+1,r[s++]=u,r[s++]=l-1}},p={...f,extension:{...f.extension,name:"ellipse"}},m={...f,extension:{...f.extension,name:"roundedRectangle"}};var g=i(5101);function v(t,e,i,n,r,s,o,a){let l,u;o?(l=n,u=-i):(l=-n,u=i);const h=t-i*r+l,c=e-n*r+u,d=t+i*s+l,f=e+n*s+u;return a.push(h,c),a.push(d,f),2}function y(t,e,i,n,r,s,o,a){const l=i-t,u=n-e;let h=Math.atan2(l,u),c=Math.atan2(r-t,s-e);a&&h<c?h+=2*Math.PI:!a&&h>c&&(c+=2*Math.PI);let d=h;const f=c-h,p=Math.abs(f),m=Math.sqrt(l*l+u*u),g=1+(15*p*Math.sqrt(m)/Math.PI|0),v=f/g;if(d+=v,a){o.push(t,e),o.push(i,n);for(let i=1,n=d;i<g;i++,n+=v)o.push(t,e),o.push(t+Math.sin(n)*m,e+Math.cos(n)*m);o.push(t,e),o.push(r,s)}else{o.push(i,n),o.push(t,e);for(let i=1,n=d;i<g;i++,n+=v)o.push(t+Math.sin(n)*m,e+Math.cos(n)*m),o.push(t,e);o.push(r,s),o.push(t,e)}return 2*g}var x=i(6570);function _(t,e,i,n,r,s,o){const a=x(t,e,2);if(!a)return;for(let t=0;t<a.length;t+=3)s[o++]=a[t]+r,s[o++]=a[t+1]+r,s[o++]=a[t+2]+r;let l=r*n;for(let e=0;e<t.length;e+=2)i[l]=t[e],i[l+1]=t[e+1],l+=n}const b=[],w={extension:{type:n.Ag.ShapeBuilder,name:"polygon"},build(t,e){for(let i=0;i<t.points.length;i++)e[i]=t.points[i];return e},triangulate(t,e,i,n,r,s){_(t,b,e,i,n,r,s)}},S={extension:{type:n.Ag.ShapeBuilder,name:"rectangle"},build(t,e){const i=t,n=i.x,r=i.y,s=i.width,o=i.height;return s>=0&&o>=0?(e[0]=n,e[1]=r,e[2]=n+s,e[3]=r,e[4]=n+s,e[5]=r+o,e[6]=n,e[7]=r+o,e):e},triangulate(t,e,i,n,r,s){let o=0;e[(n*=i)+o]=t[0],e[n+o+1]=t[1],o+=i,e[n+o]=t[2],e[n+o+1]=t[3],o+=i,e[n+o]=t[6],e[n+o+1]=t[7],o+=i,e[n+o]=t[4],e[n+o+1]=t[5],o+=i;const a=n/i;r[s++]=a,r[s++]=a+1,r[s++]=a+2,r[s++]=a+1,r[s++]=a+3,r[s++]=a+2}},C={extension:{type:n.Ag.ShapeBuilder,name:"triangle"},build:(t,e)=>(e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e),triangulate(t,e,i,n,r,s){let o=0;e[(n*=i)+o]=t[0],e[n+o+1]=t[1],o+=i,e[n+o]=t[2],e[n+o+1]=t[3],o+=i,e[n+o]=t[4],e[n+o+1]=t[5];const a=n/i;r[s++]=a,r[s++]=a+1,r[s++]=a+2}},A={};n.XO.handleByMap(n.Ag.ShapeBuilder,A),n.XO.add(S,w,C,f,p,m);const T=new u.M;function P(t,e,i){const{vertices:n,uvs:r,indices:s}=i,o=s.length,a=n.length/2,u=[],c=A.rectangle,f=T,p=t.image;f.x=t.dx,f.y=t.dy,f.width=t.dw,f.height=t.dh;const m=t.transform;c.build(f,u),m&&h(u,m),c.triangulate(u,n,2,a,s,o);const g=p.uvs;r.push(g.x0,g.y0,g.x1,g.y1,g.x3,g.y3,g.x2,g.y2);const v=l.Z.get(d.G);v.indexOffset=o,v.indexSize=s.length-o,v.attributeOffset=a,v.attributeSize=n.length/2-a,v.baseColor=t.style,v.alpha=t.alpha,v.texture=p,v.geometryData=i,e.push(v)}function M(t,e,i,n,r,s){const{vertices:o,uvs:a,indices:u}=s,f=t.shapePrimitives.length-1;t.shapePrimitives.forEach((({shape:t,transform:p},m)=>{const x=u.length,b=o.length/2,w=[],S=A[t.type];if(S.build(t,w),p&&h(w,p),n){const i=t.closePath??!0;!function(t,e,i,n,r,s,o,a){const l=1e-4;if(0===t.length)return;const u=e;let h=u.alignment;if(.5!==e.alignment){let e=function(t){const e=t.length;if(e<6)return 1;let i=0;for(let n=0,r=t[e-2],s=t[e-1];n<e;n+=2){const e=t[n],o=t[n+1];i+=(e-r)*(o+s),r=e,s=o}return i<0?-1:1}(t);i&&(e*=-1),h=(h-.5)*e+.5}const c=new g.b(t[0],t[1]),d=new g.b(t[t.length-2],t[t.length-1]),f=n,p=Math.abs(c.x-d.x)<l&&Math.abs(c.y-d.y)<l;if(f){t=t.slice(),p&&(t.pop(),t.pop(),d.set(t[t.length-2],t[t.length-1]));const e=.5*(c.x+d.x),i=.5*(d.y+c.y);t.unshift(e,i),t.push(e,i)}const m=r,x=t.length/2;let _=t.length;const b=m.length/2,w=u.width/2,S=w*w,C=u.miterLimit*u.miterLimit;let A=t[0],T=t[1],P=t[2],M=t[3],I=0,O=0,k=-(T-M),E=A-P,R=0,z=0,F=Math.sqrt(k*k+E*E);k/=F,E/=F,k*=w,E*=w;const U=2*(1-h),D=2*h;f||("round"===u.cap?_+=y(A-k*(U-D)*.5,T-E*(U-D)*.5,A-k*U,T-E*U,A+k*D,T+E*D,m,!0)+2:"square"===u.cap&&(_+=v(A,T,k,E,U,D,!0,m))),m.push(A-k*U,T-E*U),m.push(A+k*D,T+E*D);for(let e=1;e<x-1;++e){A=t[2*(e-1)],T=t[2*(e-1)+1],P=t[2*e],M=t[2*e+1],I=t[2*(e+1)],O=t[2*(e+1)+1],k=-(T-M),E=A-P,F=Math.sqrt(k*k+E*E),k/=F,E/=F,k*=w,E*=w,R=-(M-O),z=P-I,F=Math.sqrt(R*R+z*z),R/=F,z/=F,R*=w,z*=w;const i=P-A,n=T-M,r=P-I,s=O-M,o=i*r+n*s,a=n*r-s*i,l=a<0;if(Math.abs(a)<.001*Math.abs(o)){m.push(P-k*U,M-E*U),m.push(P+k*D,M+E*D),o>=0&&("round"===u.join?_+=y(P,M,P-k*U,M-E*U,P-R*U,M-z*U,m,!1)+4:_+=2,m.push(P-R*D,M-z*D),m.push(P+R*U,M+z*U));continue}const h=(-k+A)*(-E+M)-(-k+P)*(-E+T),c=(-R+I)*(-z+M)-(-R+P)*(-z+O),d=(i*c-r*h)/a,f=(s*h-n*c)/a,p=(d-P)*(d-P)+(f-M)*(f-M),g=P+(d-P)*U,v=M+(f-M)*U,x=P-(d-P)*D,b=M-(f-M)*D,B=l?U:D;p<=Math.min(i*i+n*n,r*r+s*s)+B*B*S?"bevel"===u.join||p/S>C?(l?(m.push(g,v),m.push(P+k*D,M+E*D),m.push(g,v),m.push(P+R*D,M+z*D)):(m.push(P-k*U,M-E*U),m.push(x,b),m.push(P-R*U,M-z*U),m.push(x,b)),_+=2):"round"===u.join?l?(m.push(g,v),m.push(P+k*D,M+E*D),_+=y(P,M,P+k*D,M+E*D,P+R*D,M+z*D,m,!0)+4,m.push(g,v),m.push(P+R*D,M+z*D)):(m.push(P-k*U,M-E*U),m.push(x,b),_+=y(P,M,P-k*U,M-E*U,P-R*U,M-z*U,m,!1)+4,m.push(P-R*U,M-z*U),m.push(x,b)):(m.push(g,v),m.push(x,b)):(m.push(P-k*U,M-E*U),m.push(P+k*D,M+E*D),"round"===u.join?_+=l?y(P,M,P+k*D,M+E*D,P+R*D,M+z*D,m,!0)+2:y(P,M,P-k*U,M-E*U,P-R*U,M-z*U,m,!1)+2:"miter"===u.join&&p/S<=C&&(l?(m.push(x,b),m.push(x,b)):(m.push(g,v),m.push(g,v)),_+=2),m.push(P-R*U,M-z*U),m.push(P+R*D,M+z*D),_+=2)}A=t[2*(x-2)],T=t[2*(x-2)+1],P=t[2*(x-1)],M=t[2*(x-1)+1],k=-(T-M),E=A-P,F=Math.sqrt(k*k+E*E),k/=F,E/=F,k*=w,E*=w,m.push(P-k*U,M-E*U),m.push(P+k*D,M+E*D),f||("round"===u.cap?_+=y(P-k*(U-D)*.5,M-E*(U-D)*.5,P-k*U,M-E*U,P+k*D,M+E*D,m,!1)+2:"square"===u.cap&&(_+=v(P,M,k,E,U,D,!1,m)));for(let t=b;t<_+b-2;++t)A=m[2*t],T=m[2*t+1],P=m[2*(t+1)],M=m[2*(t+1)+1],I=m[2*(t+2)],O=m[2*(t+2)+1],Math.abs(A*(M-O)+P*(O-T)+I*(T-M))<1e-8||a.push(t,t+1,t+2)}(w,e,!1,i,o,0,0,u)}else if(i&&f===m){0!==f&&console.warn("[Pixi Graphics] only the last shape have be cut out");const t=[],e=w.slice(),n=function(t){if(!t)return[];const e=t.shapePrimitives,i=[];for(let t=0;t<e.length;t++){const n=e[t].shape,r=[];A[n.type].build(n,r),i.push(r)}return i}(i.shapePath);n.forEach((i=>{t.push(e.length/2),e.push(...i)})),_(e,t,o,2,b,u,x)}else S.triangulate(w,o,2,b,u,x);const C=a.length/2,T=e.texture;if(T!==c.g.WHITE){const t=e.matrix;t&&(p&&t.append(p.clone().invert()),function(t,e,i,n,r,s,o,a=null){let l=0;i*=e,r*=s;const u=a.a,h=a.b,c=a.c,d=a.d,f=a.tx,p=a.ty;for(;l<o;){const o=t[i],a=t[i+1];n[r]=u*o+c*a+f,n[r+1]=h*o+d*a+p,r+=s,i+=e,l++}}(o,2,b,a,C,2,o.length/2-b,t))}else!function(t,e,i,n){let r=0;for(e*=i;r<n;)t[e]=0,t[e+1]=0,e+=i,r++}(a,C,2,o.length/2-b);const P=l.Z.get(d.G);P.indexOffset=x,P.indexSize=u.length-x,P.attributeOffset=b,P.attributeSize=o.length/2-b,P.baseColor=e.color,P.alpha=e.alpha,P.texture=T,P.geometryData=s,r.push(P)}))}class I{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class O{constructor(){this.batcher=new s.J,this.instructions=new o.L}init(){this.instructions.reset()}get geometry(){return(0,a.t6)(a.Ek,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const k=class t{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){t.defaultOptions.bezierSmoothness=e?.bezierSmoothness??t.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),function(t,e){const{geometryData:i,batches:n}=e;n.length=0,i.indices.length=0,i.vertices.length=0,i.uvs.length=0;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];if("texture"===r.action)P(r.data,n,i);else if("fill"===r.action||"stroke"===r.action){const t="stroke"===r.action,e=r.data.path.shapePath,s=r.data.style,o=r.data.hole;t&&o&&M(o.shapePath,s,null,!0,n,i),M(e,s,o,t,n,i)}}}(t,e);const i=t.batchMode;t.customShader||"no-batch"===i?e.isBatchable=!1:"auto"===i&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=l.Z.get(O),{batches:i,geometryData:n}=this._gpuContextHash[t.uid],s=n.vertices.length,o=n.indices.length;for(let t=0;t<i.length;t++)i[t].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(s),a.ensureIndexBuffer(o),a.begin();for(let t=0;t<i.length;t++){const e=i[t];a.add(e)}a.finish(e.instructions);const u=a.geometry;u.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),u.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let t=0;t<h.length;t++){const e=h[t];e.bindGroup=(0,r.w)(e.textures.textures,e.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new I;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(l.Z.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach((t=>{l.Z.return(t)}))}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};k.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"graphicsContext"},k.defaultOptions={bezierSmoothness:.5};let E=k},7276:(t,e,i)=>{"use strict";i.d(e,{_:()=>h});var n=i(2577),r=i(1761),s=i(9313),o=i(8293),a=i(4492),l=i(133);const u=class t{constructor(t,e,i,n){this.uid=(0,l.L)("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=t,this.y0=e,this.x1=i,this.y1=n}addColorStop(t,e){return this.gradientStops.push({offset:t,color:n.Q.shared.setValue(e).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const e=t.defaultTextureSize,{gradientStops:i}=this,n=r.e.get().createCanvas();n.width=e,n.height=e;const l=n.getContext("2d"),u=l.createLinearGradient(0,0,t.defaultTextureSize,1);for(let t=0;t<i.length;t++){const e=i[t];u.addColorStop(e.offset,e.color)}l.fillStyle=u,l.fillRect(0,0,e,e),this.texture=new a.g({source:new o.b({resource:n,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:h,y0:c,x1:d,y1:f}=this,p=new s.u,m=d-h,g=f-c,v=Math.sqrt(m*m+g*g),y=Math.atan2(g,m);p.translate(-h,-c),p.scale(1/e,1/e),p.rotate(-y),p.scale(256/v,1),this.transform=p,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const t=this.gradientStops.map((t=>`${t.offset}-${t.color}`)).join("-"),e=this.texture.uid,i=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${t}-${e}-${i}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};u.defaultTextureSize=256;let h=u},2806:(t,e,i)=>{"use strict";i.d(e,{m:()=>o});var n=i(9313),r=i(133);const s={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class o{constructor(t,e){this.uid=(0,r.L)("fillPattern"),this.transform=new n.u,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=s[e].addressModeU,t.source.style.addressModeV=s[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey||(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`),this._styleKey}}},990:(t,e,i)=>{"use strict";i.d(e,{T:()=>f,w:()=>d});var n=i(2577),r=i(9313),s=i(4492),o=i(7276),a=i(2806);function l(t){return t instanceof a.m}function u(t){return t instanceof o._}function h(t,e,i){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...i,...t}}function c(t,e,i){return e.buildLinearGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...i,...t}}function d(t,e){if(null==t)return null;const i={},o=t;return function(t){return n.Q.isColorLike(t)}(t)?function(t,e,i){const r=n.Q.shared.setValue(e??0);return t.color=r.toNumber(),t.alpha=1===r.alpha?i.alpha:r.alpha,t.texture=s.g.WHITE,{...i,...t}}(i,t,e):l(t)?h(i,t,e):u(t)?c(i,t,e):o.fill&&l(o.fill)?h(o,o.fill,e):o.fill&&u(o.fill)?c(o,o.fill,e):function(t,e){const i={...e,...t};if(i.texture){if(i.texture!==s.g.WHITE){const t=i.matrix?.invert()||new r.u;t.translate(i.texture.frame.x,i.texture.frame.y),t.scale(1/i.texture.source.width,1/i.texture.source.height),i.matrix=t}const t=i.texture.source.style;"clamp-to-edge"===t.addressMode&&(t.addressMode="repeat",t.update())}const o=n.Q.shared.setValue(i.color);return i.alpha*=o.alpha,i.color=o.toNumber(),i.matrix=i.matrix?i.matrix.clone():null,i}(o,e)}function f(t,e){const{width:i,alignment:n,miterLimit:r,cap:s,join:o,...a}=e,l=d(t,a);return l?{width:i,alignment:n,miterLimit:r,cap:s,join:o,...l}:null}},5060:(t,e,i)=>{"use strict";i.d(e,{u:()=>l});var n=i(949),r=i(1132),s=i(6011),o=i(4670);const a=class t extends s.V{constructor(...e){let i=e[0]??{};i instanceof Float32Array&&((0,o.t6)(o.lj,"use new MeshGeometry({ positions, uvs, indices }) instead"),i={positions:i,uvs:e[1],indices:e[2]}),i={...t.defaultOptions,...i};const s=i.positions||new Float32Array([0,0,1,0,1,1,0,1]),a=i.uvs||new Float32Array([0,0,1,0,1,1,0,1]),l=i.indices||new Uint32Array([0,1,2,0,2,3]),u=i.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new n.h({data:s,label:"attribute-mesh-positions",shrinkToFit:u,usage:r.S.VERTEX|r.S.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new n.h({data:a,label:"attribute-mesh-uvs",shrinkToFit:u,usage:r.S.VERTEX|r.S.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new n.h({data:l,label:"index-mesh-buffer",shrinkToFit:u,usage:r.S.INDEX|r.S.COPY_DST}),topology:i.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};a.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let l=a},975:(t,e,i)=>{"use strict";i.d(e,{P:()=>l});var n=i(4670),r=i(5060);const s=class t extends r.u{constructor(...t){super({});let e=t[0]??{};"number"==typeof e&&((0,n.t6)(n.lj,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(e){e={...t.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const i=this.verticesX*this.verticesY,n=[],r=[],s=[],o=this.verticesX-1,a=this.verticesY-1,l=this.width/o,u=this.height/a;for(let t=0;t<i;t++){const e=t%this.verticesX,i=t/this.verticesX|0;n.push(e*l,i*u),r.push(e/o,i/a)}const h=o*a;for(let t=0;t<h;t++){const e=t%o,i=t/o|0,n=i*this.verticesX+e,r=i*this.verticesX+e+1,a=(i+1)*this.verticesX+e,l=(i+1)*this.verticesX+e+1;s.push(n,r,a,r,l,a)}this.buffers[0].data=new Float32Array(n),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint32Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};s.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let o=s;const a=class t extends o{constructor(e={}){super({width:(e={...t.defaultOptions,...e}).width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(t){this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,e=this._leftWidth+this._rightWidth,i=this.width>e?1:this.width/e,n=this._topHeight+this._bottomHeight,r=this.height>n?1:this.height/n,s=Math.min(i,r);t[9]=t[11]=t[13]=t[15]=this._topHeight*s,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*s,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*s,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*s,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,i=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=i*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-i*this._bottomHeight,this.getBuffer("aUV").update()}};a.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let l=a},6844:(t,e,i)=>{"use strict";i.d(e,{k:()=>a});var n=i(2812),r=i(4492),s=i(2048),o=i(4985);class a extends o.l{constructor(t=r.g.EMPTY){t instanceof r.g&&(t={texture:t});const{texture:e=r.g.EMPTY,anchor:i,roundPixels:s,width:o,height:a,...l}=t;super({label:"Sprite",...l}),this.renderPipeId="sprite",this.batched=!0,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new n.o({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=s??!1,void 0!==o&&(this.width=o),void 0!==a&&(this.height=a)}static from(t,e=!1){return t instanceof r.g?new a(t):new a(r.g.from(t,e))}set texture(t){t||(t=r.g.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(t){const e=this.sourceBounds;return t.x>=e.maxX&&t.x<=e.minX&&t.y>=e.maxY&&t.y<=e.minY}addBounds(t){const e=this._texture.trim?this.sourceBounds:this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}onViewUpdate(){this._sourceBoundsDirty=this._boundsDirty=!0,super.onViewUpdate()}_updateBounds(){(0,s.y)(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const t=this._anchor,e=this._texture,i=this._sourceBounds,{width:n,height:r}=e.orig;i.maxX=-t._x*n,i.minX=i.maxX+n,i.maxY=-t._y*r,i.minY=i.maxY+r}destroy(t=!1){super.destroy(t);if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._texture.destroy(e)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){"object"==typeof t?(e=t.height??t.width,t=t.width):e??(e=t),void 0!==t&&this._setWidth(t,this._texture.orig.width),void 0!==e&&this._setHeight(e,this._texture.orig.height)}}},1849:(t,e,i)=>{"use strict";i.d(e,{v:()=>s});var n=i(8875),r=i(4670);class s extends n.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,r.t6)(r.lj,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,r.t6)(r.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,r.t6)(r.lj,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,r.t6)(r.lj,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,r.t6)(r.lj,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture?.destroy();this.chars=null,t&&(this.pages.forEach((t=>t.texture.destroy(!0))),this.pages=null)}}},1312:(t,e,i)=>{"use strict";i.d(e,{c:()=>b});var n=i(1979),r=i(4670),s=i(268),o=i(8291),a=i(2577),l=i(9252),u=i(7608),h=i(8293),c=i(4492),d=i(4016),f=i(1242),p=i(3548),m=i(1849);function g(t){if(""===t)return[];"string"==typeof t&&(t=[t]);const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(0===n[0].length||0===n[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const t=n[0].charCodeAt(0),i=n[1].charCodeAt(0);if(i<t)throw new Error("[BitmapFont]: Invalid character range.");for(let n=t,r=i;n<=r;n++)e.push(String.fromCharCode(n))}else e.push(...Array.from(n))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const v=class t extends m.v{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const i={...t.defaultOptions,...e};this._textureSize=i.textureSize,this._mipmap=i.mipmap;const n=i.style.clone();i.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=c.g.WHITE,n._fill.fill=null),this.applyFillAsTint=i.overrideFill;const r=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const s=(0,f.Z)(n);i.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/r):n.fontSize=this.baseRenderedFontSize=r,this._style=n,this._skipKerning=i.skipKerning??!1,this.resolution=i.resolution??1,this._padding=i.padding??4,this.fontMetrics=d.P.measureFont(s),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(t){const e=g(t).filter((t=>!this._currentChars.includes(t))).filter(((t,e,i)=>i.indexOf(t)===e));if(!e.length)return;let i;this._currentChars=[...this._currentChars,...e],i=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex];let{canvas:n,context:r}=i.canvasAndContext,s=i.texture.source;const o=this._style;let a=this._currentX,u=this._currentY;const h=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*h;let p=0,m=!1;for(let t=0;t<e.length;t++){const i=e[t],g=d.P.measureText(i,o,n,!1),v=Math.ceil(("italic"===o.fontStyle?2:1)*g.width);g.lineHeight=g.height;const y=g.width*h,x=v+2*f,_=g.height*h+2*f;if(m=!1,"\n"!==i&&"\r"!==i&&"\t"!==i&&" "!==i&&(m=!0,p=Math.ceil(Math.max(_,p))),a+x>this._textureSize&&(u+=p,p=_,a=0,u+p>this._textureSize)){s.update();const t=this._nextPage();n=t.canvasAndContext.canvas,r=t.canvasAndContext.context,s=t.texture.source,u=0}const b=y/h-(o.dropShadow?.distance??0)-(o._stroke?.width??0);if(this.chars[i]={id:i.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:b,kerning:{}},m){this._drawGlyph(r,g,a+f,u+f,h,o);const t=s.width*h,e=s.height*h,n=new l.M(a/t*s.width,u/e*s.height,x/t*s.width,_/e*s.height);this.chars[i].texture=new c.g({source:s,frame:n}),a+=Math.ceil(x)}}s.update(),this._currentX=a,this._currentY=u,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return(0,r.t6)(r.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const i=this._measureCache;for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<this._currentChars.length;t++){const n=this._currentChars[t];let s=i[r];s||(s=i[r]=e.measureText(r).width);let o=i[n];o||(o=i[n]=e.measureText(n).width);let a=e.measureText(r+n).width,l=a-(s+o);l&&(this.chars[r].kerning[n]=l),a=e.measureText(r+n).width,l=a-(s+o),l&&(this.chars[n].kerning[r]=l)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=u.N.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n={canvasAndContext:e,texture:new c.g({source:new h.b({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})})};return this.pages[this._currentPageIndex]=n,n}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=(0,f.Z)(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const n=e._stroke,r=n?.width??0;if(n&&(t.lineWidth=r,t.lineJoin=n.join,t.miterLimit=n.miterLimit,t.strokeStyle=(0,p.r)(n,t)),e._fill&&(t.fillStyle=(0,p.r)(e._fill,t)),e.dropShadow){const n=e.dropShadow,r=a.Q.shared.setValue(n.color).toArray(),s=n.blur*i,o=n.distance*i;t.shadowColor=`rgba(${255*r[0]},${255*r[1]},${255*r[2]},${n.alpha})`,t.shadowBlur=s,t.shadowOffsetX=Math.cos(n.angle)*o,t.shadowOffsetY=Math.sin(n.angle)*o}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,n,r,s){const o=e.text,a=e.fontProperties,l=s._stroke,u=(l?.width??0)*r,h=i+u/2,c=n-u/2,d=a.descent*r,f=e.lineHeight*r;s.stroke&&u&&t.strokeText(o,h,c+f-d),s._fill&&t.fillText(o,h,c+f-d)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];u.N.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};v.defaultOptions={textureSize:512,style:new o.x,mipmap:!0};let y=v;var x=i(2763);let _=0;const b=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){let i=`${e.fontFamily}-bitmap`,r=!0;if(e._fill.fill&&!e._stroke)i+=e._fill.fill.styleKey,r=!1;else if(e._stroke||e.dropShadow){let t=e.styleKey;t=t.substring(0,t.lastIndexOf("-")),i=`${t}-bitmap`,r=!1}if(!n.l.has(i)){const t=new y({style:e,overrideFill:r,overrideSize:!0,...this.defaultOptions});_++,_>50&&(0,s.R)("BitmapText",`You have dynamically created ${_} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),t.once("destroy",(()=>{_--,n.l.remove(i)})),n.l.set(i,t)}const o=n.l.get(i);return o.ensureCharacters?.(t),o}getLayout(t,e,i=!0){const n=this.getFont(t,e);return(0,x.Z)([...t],e,n,i)}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){let e=t[0];"string"==typeof e&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},(0,r.t6)(r.lj,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=e?.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const s=e.style,a=s instanceof o.x?s:new o.x(s),l=null!==a._fill.fill&&void 0!==a._fill.fill,u=new y({style:a,overrideFill:l,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),h=g(e.chars);return u.ensureCharacters(h.join("")),n.l.set(`${i}-bitmap`,u),u.once("destroy",(()=>n.l.remove(`${i}-bitmap`))),u}uninstall(t){const e=`${t}-bitmap`,i=n.l.get(e);i&&i.destroy()}}},2763:(t,e,i)=>{"use strict";function n(t,e,i,n){const r={width:0,height:0,offsetY:0,scale:e.fontSize/i.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=i.baseLineOffset;let s=r.lines[0],o=null,a=!0;const l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},u=t=>{const e=s.width;for(let i=0;i<l.index;i++){const n=t.positions[i];s.chars.push(t.chars[i]),s.charPositions.push(n+e)}s.width+=t.width,a=!1,l.width=0,l.index=0,l.chars.length=0},h=()=>{let t=s.chars.length-1;if(n){let e=s.chars[t];for(;" "===e;)s.width-=i.chars[e].xAdvance,e=s.chars[--t]}r.width=Math.max(r.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,r.lines.push(s),r.height+=i.lineHeight},c=i.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*c,f=e.wordWrapWidth*c;for(let n=0;n<t.length+1;n++){let r;const c=n===t.length;c||(r=t[n]);const p=i.chars[r]||i.chars[" "];if(/(?:\s)/.test(r)||"\r"===r||"\n"===r||c){if(!a&&e.wordWrap&&s.width+l.width-d>f?(h(),u(l),c||s.charPositions.push(0)):(l.start=s.width,u(l),c||s.charPositions.push(0)),"\r"===r||"\n"===r)0!==s.width&&h();else if(!c){const t=p.xAdvance+(p.kerning[o]||0)+d;s.width+=t,s.spaceWidth=t,s.spacesIndex.push(s.charPositions.length),s.chars.push(r)}}else{const t=p.kerning[o]||0,e=p.xAdvance+t+d;l.positions[l.index++]=l.width+t,l.chars.push(r),l.width+=e}o=r}return h(),"center"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const i=t.lines[e],n=t.width/2-i.width/2;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=n}}(r):"right"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const i=t.lines[e],n=t.width-i.width;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=n}}(r):"justify"===e.align&&function(t){const e=t.width;for(let i=0;i<t.lines.length;i++){const n=t.lines[i];let r=0,s=n.spacesIndex[r++],o=0;const a=n.spacesIndex.length,l=(e-n.width)/a;for(let t=0;t<n.charPositions.length;t++)t===s&&(s=n.spacesIndex[r++],o+=l),n.charPositions[t]+=o}}(r),r}i.d(e,{Z:()=>n})},8291:(t,e,i)=>{"use strict";i.d(e,{x:()=>d});var n=i(8875),r=i(2577),s=i(4670),o=i(7276),a=i(2806),l=i(4835),u=i(990),h=i(8011);const c=class t extends n.A{constructor(e={}){super(),function(t){const e=t;if("boolean"==typeof e.dropShadow&&e.dropShadow){const i=d.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??i.alpha,angle:e.dropShadowAngle??i.angle,blur:e.dropShadowBlur??i.blur,color:e.dropShadowColor??i.color,distance:e.dropShadowDistance??i.distance}}if(void 0!==e.strokeThickness){(0,s.t6)(s.lj,"strokeThickness is now a part of stroke");const i=e.stroke;let n={};if(r.Q.isColorLike(i))n.color=i;else if(i instanceof o._||i instanceof a.m)n.fill=i;else{if(!Object.hasOwnProperty.call(i,"color")&&!Object.hasOwnProperty.call(i,"fill"))throw new Error("Invalid stroke value.");n=i}t.stroke={...n,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){let i;(0,s.t6)(s.lj,"gradient fill is now a fill pattern: `new FillGradient(...)`"),null==t.fontSize?t.fontSize=d.defaultTextStyle.fontSize:i="string"==typeof t.fontSize?parseInt(t.fontSize,10):t.fontSize;const n=new o._(0,0,0,1.7*i),a=e.fillGradientStops.map((t=>r.Q.shared.setValue(t).toNumber()));a.forEach(((t,e)=>{const i=e/(a.length-1);n.addColorStop(i,t)})),t.fill={fill:n}}}(e);const i={...t.defaultTextStyle,...e};for(const t in i){this[t]=i[t]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow=null!==e&&"object"==typeof e?this._createProxy({...t.defaultDropShadow,...e}):e?this._createProxy({...t.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize="string"==typeof t?parseInt(t,10):t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...l.T.defaultFillStyle,...t},(()=>{this._fill=(0,u.w)({...this._originalFill},l.T.defaultFillStyle)}))),this._fill=(0,u.w)(0===t?"black":t,l.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...l.T.defaultStrokeStyle,...t},(()=>{this._stroke=(0,u.T)({...this._originalStroke},l.T.defaultStrokeStyle)}))),this._stroke=(0,u.T)(t,l.T.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=(0,h.V)(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=t.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){this.removeAllListeners();if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(e),this._originalFill?.texture&&this._originalFill.texture.destroy(e),this._stroke?.texture&&this._stroke.texture.destroy(e),this._originalStroke?.texture&&this._originalStroke.texture.destroy(e)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(t,i,n)=>(t[i]=n,e?.(i,n),this.update(),!0)})}_isFillStyle(t){return null!==(t??null)&&!(r.Q.isColorLike(t)||t instanceof o._||t instanceof a.m)}};c.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},c.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let d=c},4016:(t,e,i)=>{"use strict";i.d(e,{P:()=>a});var n=i(1761),r=i(1242);const s={willReadFrequently:!0},o=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0!==e){const i=n.e.get().getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in i||"textLetterSpacing"in i}return e}constructor(t,e,i,n,r,s,o,a,l){this.text=t,this.style=e,this.width=i,this.height=n,this.lines=r,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(e=" ",i,n=t._canvas,s=i.wordWrap){const o=`${e}:${i.styleKey}`;if(t._measurementCache[o])return t._measurementCache[o];const a=(0,r.Z)(i),l=t.measureFont(a);0===l.fontSize&&(l.fontSize=i.fontSize,l.ascent=i.fontSize);const u=t.__context;u.font=a;const h=(s?t._wordWrap(e,i,n):e).split(/(?:\r\n|\r|\n)/),c=new Array(h.length);let d=0;for(let e=0;e<h.length;e++){const n=t._measureText(h[e],i.letterSpacing,u);c[e]=n,d=Math.max(d,n)}const f=i._stroke?.width||0;let p=d+f;i.dropShadow&&(p+=i.dropShadow.distance);const m=i.lineHeight||l.fontSize;let g=Math.max(m,l.fontSize+f)+(h.length-1)*(m+i.leading);i.dropShadow&&(g+=i.dropShadow.distance);return new t(e,i,p,g,h,c,m+i.leading,d,l)}static _measureText(e,i,n){let r=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(n.letterSpacing=`${i}px`,n.textLetterSpacing=`${i}px`,r=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const s=n.measureText(e);let o=s.width;const a=-s.actualBoundingBoxLeft;let l=s.actualBoundingBoxRight-a;if(o>0)if(r)o-=i,l-=i;else{const n=(t.graphemeSegmenter(e).length-1)*i;o+=n,l+=n}return Math.max(o,l)}static _wordWrap(e,i,n=t._canvas){const r=n.getContext("2d",s);let o=0,a="",l="";const u=Object.create(null),{letterSpacing:h,whiteSpace:c}=i,d=t._collapseSpaces(c),f=t._collapseNewlines(c);let p=!d;const m=i.wordWrapWidth+h,g=t._tokenize(e);for(let e=0;e<g.length;e++){let n=g[e];if(t._isNewline(n)){if(!f){l+=t._addLine(a),p=!d,a="",o=0;continue}n=" "}if(d){const e=t.isBreakingSpace(n),i=t.isBreakingSpace(a[a.length-1]);if(e&&i)continue}const s=t._getFromCache(n,h,u,r);if(s>m)if(""!==a&&(l+=t._addLine(a),a="",o=0),t.canBreakWords(n,i.breakWords)){const e=t.wordWrapSplit(n);for(let s=0;s<e.length;s++){let c=e[s],d=c,f=1;for(;e[s+f];){const r=e[s+f];if(t.canBreakChars(d,r,n,s,i.breakWords))break;c+=r,d=r,f++}s+=f-1;const g=t._getFromCache(c,h,u,r);g+o>m&&(l+=t._addLine(a),p=!1,a="",o=0),a+=c,o+=g}}else{a.length>0&&(l+=t._addLine(a),a="",o=0);const i=e===g.length-1;l+=t._addLine(n,!i),p=!1,a="",o=0}else s+o>m&&(p=!1,l+=t._addLine(a),a="",o=0),(a.length>0||!t.isBreakingSpace(n)||p)&&(a+=n,o+=s)}return l+=t._addLine(a,!1),l}static _addLine(e,i=!0){return e=t._trimRight(e),e=i?`${e}\n`:e}static _getFromCache(e,i,n,r){let s=n[e];return"number"!=typeof s&&(s=t._measureText(e,i,r)+i,n[e]=s),s}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(e){if("string"!=typeof e)return"";for(let i=e.length-1;i>=0;i--){const n=e[i];if(!t.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static _isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,i){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const i=[];let n="";if("string"!=typeof e)return i;for(let r=0;r<e.length;r++){const s=e[r],o=e[r+1];t.isBreakingSpace(s,o)||t._isNewline(s)?(""!==n&&(i.push(n),n=""),i.push(s)):n+=s}return""!==n&&i.push(n),i}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,n,r){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];const i=t._context;i.font=e;const n=i.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),r={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return t._fonts[e]=r,r}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let e;try{const i=new OffscreenCanvas(0,0),r=i.getContext("2d",s);if(r?.measureText)return t.__canvas=i,i;e=n.e.get().createCanvas()}catch(t){e=n.e.get().createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",s)),t.__context}};o.METRICS_STRING="|q",o.BASELINE_SYMBOL="M",o.BASELINE_MULTIPLIER=1.4,o.HEIGHT_MULTIPLIER=2,o.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map((t=>t.segment))}return t=>[...t]})(),o.experimentalLetterSpacing=!1,o._fonts={},o._newlines=[10,13],o._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],o._measurementCache={};let a=o},1242:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});const n=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function r(t){const e="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize;let i=t.fontFamily;Array.isArray(t.fontFamily)||(i=t.fontFamily.split(","));for(let t=i.length-1;t>=0;t--){let e=i[t].trim();/([\"\'])[^\'\"]+\1/.test(e)||n.includes(e)||(e=`"${e}"`),i[t]=e}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${i.join(",")}`}},3548:(t,e,i)=>{"use strict";i.d(e,{r:()=>u});var n=i(2577),r=i(9313),s=i(4492),o=i(268),a=i(7276),l=i(2806);function u(t,e){if(t.texture===s.g.WHITE&&!t.fill)return n.Q.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(!t.fill){const i=e.createPattern(t.texture.source.resource,"repeat"),n=t.matrix.copyTo(r.u.shared);return n.scale(t.texture.frame.width,t.texture.frame.height),i.setTransform(n),i}if(t.fill instanceof l.m){const i=t.fill,n=e.createPattern(i.texture.source.resource,"repeat"),s=i.transform.copyTo(r.u.shared);return s.scale(i.texture.frame.width,i.texture.frame.height),n.setTransform(s),n}if(t.fill instanceof a._){const i=t.fill;if("linear"===i.type){const t=e.createLinearGradient(i.x0,i.y0,i.x1,i.y1);return i.gradientStops.forEach((e=>{t.addColorStop(e.offset,n.Q.shared.setValue(e.color).toHex())})),t}}return(0,o.R)("FillStyle not recognised",t),"red"}},8011:(t,e,i)=>{"use strict";i.d(e,{V:()=>s});var n=i(2577);const r=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function s(t){const e=[];let i=0;for(let n=0;n<r.length;n++){const s=`_${r[n]}`;e[i++]=t[s]}return i=o(t._fill,e,i),i=function(t,e,i){return t?(i=o(t,e,i),e[i++]=t.width,e[i++]=t.alignment,e[i++]=t.cap,e[i++]=t.join,e[i++]=t.miterLimit,i):i}(t._stroke,e,i),i=function(t,e,i){return t?(e[i++]=t.alpha,e[i++]=t.angle,e[i++]=t.blur,e[i++]=t.distance,e[i++]=n.Q.shared.setValue(t.color).toNumber(),i):i}(t.dropShadow,e,i),e.join("-")}function o(t,e,i){return t?(e[i++]=t.color,e[i++]=t.alpha,e[i++]=t.fill?.styleKey,i):i}},4985:(t,e,i)=>{"use strict";i.d(e,{l:()=>s});var n=i(9636),r=i(4263);class s extends r.mc{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new n.c(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:n}=t;return i>=e.minX&&i<=e.maxX&&n>=e.minY&&n<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}}},9010:(t,e,i)=>{"use strict";var n=i(8507),r=i(4589),s=i(1173),o=i(2233),a=i(4492),l=i(2927),u=i(9252);const h=class t{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof a.g?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const i=parseFloat(e.meta.scale);i?(this.resolution=i,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise((e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(e){let i=e;const n=t.BATCH_SIZE;for(;i-e<n&&i<this._frameKeys.length;){const t=this._frameKeys[i],e=this._frames[t],n=e.frame;if(n){let i=null,r=null;const s=!1!==e.trimmed&&e.sourceSize?e.sourceSize:e.frame,o=new u.M(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);i=e.rotated?new u.M(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):new u.M(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),!1!==e.trimmed&&e.spriteSourceSize&&(r=new u.M(Math.floor(e.spriteSourceSize.x)/this.resolution,Math.floor(e.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[t]=new a.g({source:this.textureSource,frame:i,orig:o,trim:r,rotate:e.rotated?2:0,defaultAnchor:e.anchor,defaultBorders:e.borders,label:t.toString()})}i++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const n=t[e][i];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};h.BATCH_SIZE=1e3;let c=h;const d=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function f(t,e,i){const n={};if(t.forEach((t=>{n[t]=e})),Object.keys(e.textures).forEach((t=>{n[t]=e.textures[t]})),!i){const i=l.A.dirname(t[0]);e.linkedSheets.forEach(((t,r)=>{const s=f([`${i}/${e.data.meta.related_multi_packs[r]}`],t,!0);Object.assign(n,s)}))}return n}const p={extension:n.Ag.Asset,cache:{test:t=>t instanceof c,getCacheableAssets:(t,e)=>f(t,e,!1)},resolver:{extension:{type:n.Ag.ResolveParser,name:"resolveSpritesheet"},test:t=>{const e=t.split("?")[0].split("."),i=e.pop(),n=e.pop();return"json"===i&&d.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(s.x.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:n.Ag.LoadParser,priority:r.T.Normal,name:"spritesheetLoader"},testParse:async(t,e)=>".json"===l.A.extname(e.src).toLowerCase()&&!!t.frames,async parse(t,e,i){const{texture:n,imageFilename:r}=e?.data??{};let s,u=l.A.dirname(e.src);if(u&&u.lastIndexOf("/")!==u.length-1&&(u+="/"),n instanceof a.g)s=n;else{const n=(0,o.Y)(u+(r??t.meta.image),e.src);s=(await i.load([n]))[n]}const h=new c(s.source,t);await h.parse();const d=t?.meta?.related_multi_packs;if(Array.isArray(d)){const t=[];for(const n of d){if("string"!=typeof n)continue;let r=u+n;e.data?.ignoreMultiPack||(r=(0,o.Y)(r,e.src),t.push(i.load({src:r,data:{ignoreMultiPack:!0}})))}const n=await Promise.all(t);h.linkedSheets=n,n.forEach((t=>{t.linkedSheets=[h].concat(h.linkedSheets.filter((e=>e!==t)))}))}return h},async unload(t,e,i){await i.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};n.XO.add(p)},7309:(t,e,i)=>{"use strict";i.d(e,{R:()=>o});var n=i(4458);class r{constructor(t,e=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const s=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new r(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=n.d.NORMAL){return this._addListener(new r(t,e,i))}addOnce(t,e,i=n.d.NORMAL){return this._addListener(new r(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let i;if(e>this.lastTime){if(i=this.elapsedMS=e-this.lastTime,i>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*t.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const i=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,i)/1e3,t.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!t._shared){const e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared}static get system(){if(!t._system){const e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system}};s.targetFPMS=.06;let o=s},4458:(t,e,i)=>{"use strict";i.d(e,{d:()=>n});var n=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(n||{})},6858:(t,e,i)=>{"use strict";let n;async function r(){return n??(n=(async()=>{const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise((t=>{const e=document.createElement("video");e.onloadeddata=()=>t(e),e.onerror=()=>t(null),e.autoplay=!1,e.crossOrigin="anonymous",e.preload="auto",e.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",e.load()}));if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(n),t.deleteTexture(i),t.getExtension("WEBGL_lose_context")?.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),n}i.d(e,{C:()=>r})},7218:(t,e,i)=>{"use strict";i.d(e,{F:()=>_});var n=/iPhone/i,r=/iPod/i,s=/iPad/i,o=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,l=/Android/i,u=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,h=/Silk/i,c=/Windows Phone/i,d=/\bWindows(?:.+)ARM\b/i,f=/BlackBerry/i,p=/BB10/i,m=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,v=/Mobile(?:.+)Firefox\b/i,y=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function x(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=e.userAgent,x=i.split("[FBAN");void 0!==x[1]&&(i=x[0]),void 0!==(x=i.split("Twitter"))[1]&&(i=x[0]);var _=function(t){return function(e){return e.test(t)}}(i),b={apple:{phone:_(n)&&!_(c),ipod:_(r),tablet:!_(n)&&(_(s)||y(e))&&!_(c),universal:_(o),device:(_(n)||_(r)||_(s)||_(o)||y(e))&&!_(c)},amazon:{phone:_(u),tablet:!_(u)&&_(h),device:_(u)||_(h)},android:{phone:!_(c)&&_(u)||!_(c)&&_(a),tablet:!_(c)&&!_(u)&&!_(a)&&(_(h)||_(l)),device:!_(c)&&(_(u)||_(h)||_(a)||_(l))||_(/\bokhttp\b/i)},windows:{phone:_(c),tablet:_(d),device:_(c)||_(d)},other:{blackberry:_(f),blackberry10:_(p),opera:_(m),firefox:_(v),chrome:_(g),device:_(f)||_(p)||_(m)||_(v)||_(g)},any:!1,phone:!1,tablet:!1};return b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}const _=(x.default??x)(globalThis.navigator)},4577:(t,e,i)=>{"use strict";let n;function r(){if("boolean"==typeof n)return n;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");n=!0===t({a:"b"},"a","b")}catch(t){n=!1}return n}i.d(e,{f:()=>r})},2571:(t,e,i)=>{"use strict";i.d(e,{xv:()=>n});i(8875);const n="8.5.0"},1460:(t,e,i)=>{"use strict";i.d(e,{u:()=>n});class n{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}},9903:(t,e,i)=>{"use strict";function n(t,e,i){const n=t.length;let r;if(e>=n||0===i)return;const s=n-(i=e+i>n?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}i.d(e,{d:()=>n})},133:(t,e,i)=>{"use strict";i.d(e,{L:()=>r});const n={default:-1};function r(t="default"){return void 0===n[t]&&(n[t]=-1),++n[t]}},2048:(t,e,i)=>{"use strict";function n(t,e,i,n){const{width:r,height:s}=i.orig,o=i.trim;if(o){const i=o.width,a=o.height;t.minX=o.x-e._x*r-n,t.maxX=t.minX+i,t.minY=o.y-e._y*s-n,t.maxY=t.minY+a}else t.minX=-e._x*r-n,t.maxX=t.minX+r,t.minY=-e._y*s-n,t.maxY=t.minY+s}i.d(e,{y:()=>n})},7073:(t,e,i)=>{"use strict";i.d(e,{M:()=>s,d:()=>o});var n=i(8507),r=i(2571);class s{static init(){globalThis.__PIXI_APP_INIT__?.(this,r.xv)}static destroy(){}}s.extension=n.Ag.Application;class o{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,r.xv)}destroy(){this._renderer=null}}o.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"initHook",priority:-10}},4670:(t,e,i)=>{"use strict";i.d(e,{Ek:()=>s,lj:()=>r,t6:()=>o});const n={},r="8.0.0",s="8.3.4";function o(t,e,i=3){if(n[e])return;let r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(r))),n[e]=!0}},268:(t,e,i)=>{"use strict";i.d(e,{R:()=>s});let n=0;const r=500;function s(...t){n!==r&&(n++,n===r?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}},2927:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(1761);function r(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function s(t){return t.split("?")[0].split("#")[0]}const o={toPosix(t){return e="\\",i="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),i);var e,i},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){r(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const i=/^[^/:]+:\/{0,2}/.exec(t);return i?i[0]:""},toAbsolute(t,e,i){if(r(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const a=s(this.toPosix(e??n.e.get().getBaseUrl())),l=s(this.toPosix(i??this.rootname(a)));if((t=this.toPosix(t)).startsWith("/"))return o.join(l,t.slice(1));return this.isAbsolute(t)?t:this.join(a,t)},normalize(t){if(r(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let e="";const i=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return(t=function(t,e){let i="",n=0,r=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(47===o)break;o=47}if(47===o){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){const t=i.lastIndexOf("/");if(t!==i.length-1){-1===t?(i="",n=0):(i=i.slice(0,t),n=i.length-1-i.lastIndexOf("/")),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,r=a,s=0;continue}e&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+=`/${t.slice(r+1,a)}`:i=t.slice(r+1,a),n=a-r-1;r=a,s=0}else 46===o&&-1!==s?++s:s=-1}return i}(t,!1)).length>0&&n&&(t+="/"),i?`/${t}`:e+t},isAbsolute(t){return r(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let i=0;i<t.length;++i){const n=t[i];if(r(n),n.length>0)if(void 0===e)e=n;else{const r=t[i-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(r(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const i=47===e;let n=-1,s=!0;const o=this.getProtocol(t),a=t;for(let i=(t=t.slice(o.length)).length-1;i>=1;--i)if(e=t.charCodeAt(i),47===e){if(!s){n=i;break}}else s=!1;return-1===n?i?"/":this.isUrl(a)?o+t:o:i&&1===n?"//":o+t.slice(0,n)},rootname(t){r(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const i=t.indexOf("/",e.length);e=-1!==i?t.slice(0,i):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){r(t),e&&r(e),t=s(this.toPosix(t));let i,n=0,o=-1,a=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let r=e.length-1,s=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(47===l){if(!a){n=i+1;break}}else-1===s&&(a=!1,s=i+1),r>=0&&(l===e.charCodeAt(r)?-1==--r&&(o=i):(r=-1,o=s))}return n===o?o=s:-1===o&&(o=t.length),t.slice(n,o)}for(i=t.length-1;i>=0;--i)if(47===t.charCodeAt(i)){if(!a){n=i+1;break}}else-1===o&&(a=!1,o=i+1);return-1===o?"":t.slice(n,o)},extname(t){r(t);let e=-1,i=0,n=-1,o=!0,a=0;for(let r=(t=s(this.toPosix(t))).length-1;r>=0;--r){const s=t.charCodeAt(r);if(47!==s)-1===n&&(o=!1,n=r+1),46===s?-1===e?e=r:1!==a&&(a=1):-1!==e&&(a=-1);else if(!o){i=r+1;break}}return-1===e||-1===n||0===a||1===a&&e===n-1&&e===i+1?"":t.slice(e,n)},parse(t){r(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let i=(t=s(this.toPosix(t))).charCodeAt(0);const n=this.isAbsolute(t);let o;e.root=this.rootname(t),o=n||this.hasProtocol(t)?1:0;let a=-1,l=0,u=-1,h=!0,c=t.length-1,d=0;for(;c>=o;--c)if(i=t.charCodeAt(c),47!==i)-1===u&&(h=!1,u=c+1),46===i?-1===a?a=c:1!==d&&(d=1):-1!==a&&(d=-1);else if(!h){l=c+1;break}return-1===a||-1===u||0===d||1===d&&a===u-1&&a===l+1?-1!==u&&(e.base=e.name=0===l&&n?t.slice(1,u):t.slice(l,u)):(0===l&&n?(e.name=t.slice(1,a),e.base=t.slice(1,u)):(e.name=t.slice(l,a),e.base=t.slice(l,u)),e.ext=t.slice(a,u)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]}},8425:(t,e,i)=>{"use strict";i.d(e,{b:()=>n});class n{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return e=this._index>0?this._pool[--this._index]:new this._classType,e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}},8218:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});var n=i(8425);const r=new class{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new n.b(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach((e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}})),t}}},8875:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});const n=i(5585)}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var s=n[t]={exports:{}};return i[t].call(s.exports,s,s.exports,r),s.exports}r.m=i,r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,i)=>(r.f[i](t,e),e)),[])),r.u=t=>t+".bundle.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="snake:",r.l=(i,n,s,o)=>{if(t[i])t[i].push(n);else{var a,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),h=0;h<u.length;h++){var c=u[h];if(c.getAttribute("src")==i||c.getAttribute("data-webpack")==e+s){a=c;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",e+s),a.src=i),t[i]=[n];var d=(e,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=t[i];if(delete t[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(n))),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={792:0};r.f.j=(e,i)=>{var n=r.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var s=new Promise(((i,r)=>n=t[e]=[i,r]));i.push(n[2]=s);var o=r.p+r.u(e),a=new Error;r.l(o,(i=>{if(r.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,n[1](a)}}),"chunk-"+e,e)}};var e=(e,i)=>{var n,s,[o,a,l]=i,u=0;if(o.some((e=>0!==t[e]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(l)l(r)}for(e&&e(i);u<o.length;u++)s=o[u],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0},i=self.webpackChunksnake=self.webpackChunksnake||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t=r(8507);const e={extension:{type:t.Ag.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Promise.all([r.e(42),r.e(376)]).then(r.bind(r,376))}},i={extension:{type:t.Ag.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await Promise.all([r.e(42),r.e(162)]).then(r.bind(r,2162))}};r(8480),r(9010);var n=r(1761),s=r(800);let o,a;async function l(t={}){return void 0!==a||(a=await(async()=>{const e=n.e.get().getNavigator().gpu;if(!e)return!1;try{const i=await e.requestAdapter(t);return await i.requestDevice(),!0}catch(t){return!1}})()),a}const u=["webgl","webgpu","canvas"];var h=r(4263),c=r(7073),d=r(4670);const f=class t{constructor(...t){this.stage=new h.mc,void 0!==t[0]&&(0,d.t6)(d.lj,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await async function(t){let e,i=[];t.preference?(i.push(t.preference),u.forEach((e=>{e!==t.preference&&i.push(e)}))):i=u.slice();let a={};for(let u=0;u<i.length;u++){const c=i[u];if("webgpu"===c&&await l()){const{WebGPURenderer:i}=await Promise.all([r.e(580),r.e(751)]).then(r.bind(r,4751));e=i,a={...t,...t.webgpu};break}if("webgl"===c&&(h=t.failIfMajorPerformanceCaveat??s.k.defaultOptions.failIfMajorPerformanceCaveat,void 0!==o||(o=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:h??s.k.defaultOptions.failIfMajorPerformanceCaveat};try{if(!n.e.get().getWebGLRenderingContext())return!1;let e=n.e.get().createCanvas().getContext("webgl",t);const i=!!e?.getContextAttributes()?.stencil;if(e){const t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}return e=null,i}catch(t){return!1}})()),o)){const{WebGLRenderer:i}=await Promise.all([r.e(580),r.e(151)]).then(r.bind(r,3151));e=i,a={...t,...t.webgl};break}if("canvas"===c)throw a={...t},new Error("CanvasRenderer is not yet implemented")}var h;if(delete a.webgpu,delete a.webgl,!e)throw new Error("No available renderer for the current environment");const c=new e;return await c.init(a),c}(e),t._plugins.forEach((t=>{t.init.call(this,e)}))}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return(0,d.t6)(d.lj,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,i=!1){const n=t._plugins.slice(0);n.reverse(),n.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(i),this.stage=null,this.renderer.destroy(e),this.renderer=null}};f._plugins=[];let p=f;t.XO.handleByList(t.Ag.Application,p._plugins),t.XO.add(c.M);var m=r(4589),g=r(2233),v=r(2927),y=r(9252),x=r(4492),_=r(1849),b=r(1312);class w extends _.v{constructor(t,e){super();const{textures:i,data:n}=t;Object.keys(n.pages).forEach((t=>{const e=n.pages[parseInt(t,10)],r=i[e.id];this.pages.push({texture:r})})),Object.keys(n.chars).forEach((t=>{const e=n.chars[t],{frame:r,source:s}=i[e.page],o=new y.M(e.x+r.x,e.y+r.y,e.width,e.height),a=new x.g({source:s,frame:o});this.chars[t]={id:t.codePointAt(0),xOffset:e.xOffset,yOffset:e.yOffset,xAdvance:e.xAdvance,kerning:e.kerning??{},texture:a}})),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){b.c.install(t)}static uninstall(t){b.c.uninstall(t)}}const S={test:t=>"string"==typeof t&&t.startsWith("info face="),parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const n=e[t].match(/^[a-z]+/gm)[0],r=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const t in r){const e=r[t].split("="),i=e[0],n=e[1].replace(/"/gm,""),o=parseFloat(n),a=isNaN(o)?n:o;s[i]=a}i[n].push(s)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=i.info,[s]=i.common,[o]=i.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(r.size,10),n.fontFamily=r.face,n.lineHeight=parseInt(s.lineHeight,10);const a=i.page;for(let t=0;t<a.length;t++)n.pages.push({id:parseInt(a[t].id,10)||0,file:a[t].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(s.base,10);const u=i.char;for(let t=0;t<u.length;t++){const e=u[t],i=parseInt(e.id,10);let r=e.letter??e.char??String.fromCharCode(i);"space"===r&&(r=" "),l[i]=r,n.chars[r]={id:i,page:parseInt(e.page,10)||0,x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xOffset:parseInt(e.xoffset,10),yOffset:parseInt(e.yoffset,10),xAdvance:parseInt(e.xadvance,10),kerning:{}}}const h=i.kerning||[];for(let t=0;t<h.length;t++){const e=parseInt(h[t].first,10),i=parseInt(h[t].second,10),r=parseInt(h[t].amount,10);n.chars[l[i]].kerning[l[e]]=r}return n}},C={test(t){const e=t;return"string"!=typeof e&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},i=t.getElementsByTagName("info")[0],n=t.getElementsByTagName("common")[0],r=t.getElementsByTagName("distanceField")[0];r&&(e.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const s=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(i.getAttribute("size"),10),e.fontFamily=i.getAttribute("face"),e.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let t=0;t<s.length;t++)e.pages.push({id:parseInt(s[t].getAttribute("id"),10)||0,file:s[t].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(n.getAttribute("base"),10);for(let t=0;t<o.length;t++){const i=o[t],n=parseInt(i.getAttribute("id"),10);let r=i.getAttribute("letter")??i.getAttribute("char")??String.fromCharCode(n);"space"===r&&(r=" "),l[n]=r,e.chars[r]={id:n,page:parseInt(i.getAttribute("page"),10)||0,x:parseInt(i.getAttribute("x"),10),y:parseInt(i.getAttribute("y"),10),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10),xOffset:parseInt(i.getAttribute("xoffset"),10),yOffset:parseInt(i.getAttribute("yoffset"),10),xAdvance:parseInt(i.getAttribute("xadvance"),10),kerning:{}}}for(let t=0;t<a.length;t++){const i=parseInt(a[t].getAttribute("first"),10),n=parseInt(a[t].getAttribute("second"),10),r=parseInt(a[t].getAttribute("amount"),10);e.chars[l[n]].kerning[l[i]]=r}return e}},A={test:t=>!("string"!=typeof t||!t.includes("<font>"))&&C.test(n.e.get().parseXML(t)),parse:t=>C.parse(n.e.get().parseXML(t))},T=[".xml",".fnt"],P={extension:{type:t.Ag.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof w,getCacheableAssets(t,e){const i={};return t.forEach((t=>{i[t]=e,i[`${t}-bitmap`]=e})),i[`${e.fontFamily}-bitmap`]=e,i}},M={extension:{type:t.Ag.LoadParser,priority:m.T.Normal},name:"loadBitmapFont",test:t=>T.includes(v.A.extname(t).toLowerCase()),testParse:async t=>S.test(t)||A.test(t),async parse(t,e,i){const n=S.test(t)?S.parse(t):A.parse(t),{src:r}=e,{pages:s}=n,o=[],a=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let t=0;t<s.length;++t){const e=s[t].file;let i=v.A.join(v.A.dirname(r),e);i=(0,g.Y)(i,r),o.push({src:i,data:a})}const l=await i.load(o),u=o.map((t=>l[t.src]));return new w({data:n,textures:u},r)},async load(t,e){const i=await n.e.get().fetch(t);return await i.text()},async unload(t,e,i){await Promise.all(t.pages.map((t=>i.unload(t.texture.source._sourceOrigin)))),t.destroy()}};var I=r(268);class O{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}var k=r(1979);const E={extension:{type:t.Ag.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every((t=>t instanceof x.g)),getCacheableAssets:(t,e)=>{const i={};return t.forEach((t=>{e.forEach(((e,n)=>{i[t+(0===n?"":n+1)]=e}))})),i}};async function R(t){if("Image"in globalThis)return new Promise((e=>{const i=new Image;i.onload=()=>{e(!0)},i.onerror=()=>{e(!1)},i.src=t}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch(t){return!1}return!0}return!1}const z={extension:{type:t.Ag.DetectionParser,priority:1},test:async()=>R("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))},F=["png","jpg","jpeg"],U={extension:{type:t.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...F],remove:async t=>t.filter((t=>!F.includes(t)))},D="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function B(t){if(D)return!1;return""!==document.createElement("video").canPlayType(t)}const L={extension:{type:t.Ag.DetectionParser,priority:0},test:async()=>B("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter((t=>"mp4"!==t&&"m4v"!==t))},N={extension:{type:t.Ag.DetectionParser,priority:0},test:async()=>B("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter((t=>"ogv"!==t))},$={extension:{type:t.Ag.DetectionParser,priority:0},test:async()=>B("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter((t=>"webm"!==t))},V={extension:{type:t.Ag.DetectionParser,priority:0},test:async()=>R("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))};var G=r(2406),j=r(2217);class H{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{let n=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||(0,I.R)(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let i=0;i<this.parsers.length;i++){const n=this.parsers[i];if(n.load&&n.test?.(t,e,this)){r=n;break}}if(!r)return(0,I.R)(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await r.load(t,e,this),i.parser=r;for(let t=0;t<this.parsers.length;t++){const r=this.parsers[t];r.parse&&r.parse&&await(r.testParse?.(n,e,this))&&(n=await r.parse(n,e,this)||n,i.parser=r)}return n})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const n={},r=(0,j.a)(t),s=(0,G.z)(t,(t=>({alias:[t],src:t,data:{}}))),o=s.length,a=s.map((async t=>{const r=v.A.toAbsolute(t.src);if(!n[t.src])try{this.promiseCache[r]||(this.promiseCache[r]=this._getLoadPromiseAndParser(r,t)),n[t.src]=await this.promiseCache[r].promise,e&&e(++i/o)}catch(e){throw delete this.promiseCache[r],delete n[t.src],new Error(`[Loader.load] Failed to load ${r}.\n${e}`)}}));return await Promise.all(a),r?n[s[0].src]:n}async unload(t){const e=(0,G.z)(t,(t=>({alias:[t],src:t}))).map((async t=>{const e=v.A.toAbsolute(t.src),i=this.promiseCache[e];if(i){const n=await i.promise;delete this.promiseCache[e],await(i.parser?.unload?.(n,t,this))}}));await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,e)=>(e.name?t[e.name]&&(0,I.R)(`[Assets] loadParser name conflict "${e.name}"`):(0,I.R)("[Assets] loadParser should have a name"),{...t,[e.name]:e})),{})}}function W(t,e){if(Array.isArray(e)){for(const i of e)if(t.startsWith(`data:${i}`))return!0;return!1}return t.startsWith(`data:${e}`)}function X(t,e){const i=t.split("?")[0],n=v.A.extname(i).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const Y={extension:{type:t.Ag.LoadParser,priority:m.T.Low},name:"loadJson",test:t=>W(t,"application/json")||X(t,".json"),async load(t){const e=await n.e.get().fetch(t);return await e.json()}},q={name:"loadTxt",extension:{type:t.Ag.LoadParser,priority:m.T.Low,name:"loadTxt"},test:t=>W(t,"text/plain")||X(t,".txt"),async load(t){const e=await n.e.get().fetch(t);return await e.text()}},K=["normal","bold","100","200","300","400","500","600","700","800","900"],Z=[".ttf",".otf",".woff",".woff2"],Q=["font/ttf","font/otf","font/woff","font/woff2"],J=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;const tt=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;const et={extension:{type:t.Ag.LoadParser,priority:m.T.Low},name:"loadWebFont",test:t=>W(t,Q)||X(t,Z),async load(t,e){const i=n.e.get().getFontFaceSet();if(i){const n=[],s=e.data?.family??function(t){const e=v.A.extname(t),i=v.A.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1)));let n=i.length>0;for(const t of i)if(!t.match(J)){n=!1;break}let r=i.join(" ");return n||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}(t),o=e.data?.weights?.filter((t=>K.includes(t)))??["normal"],a=e.data??{};for(let e=0;e<o.length;e++){const l=o[e],u=new FontFace(s,`url(${r=t,tt.test(r)?r:encodeURI(r)})`,{...a,weight:l});await u.load(),i.add(u),n.push(u)}return k.l.set(`${s}-and-url`,{url:t,fontFaces:n}),1===n.length?n[0]:n}var r;return(0,I.R)("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>{k.l.remove(t.family),n.e.get().getFontFaceSet().delete(t)}))}};var it=r(8293),nt=r(4835),rt=r(1173);function st(t,e=1){const i=rt.x.RETINA_PREFIX?.exec(t);return i?parseFloat(i[1]):e}function ot(t,e,i){t.label=i,t._sourceOrigin=i;const n=new x.g({source:t,label:i}),r=()=>{delete e.promiseCache[i],k.l.has(i)&&k.l.remove(i)};return n.source.once("destroy",(()=>{e.promiseCache[i]&&((0,I.R)("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())})),n.once("destroy",(()=>{t.destroyed||((0,I.R)("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())})),n}const at={extension:{type:t.Ag.LoadParser,priority:m.T.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:t=>W(t,"image/svg+xml")||X(t,".svg"),async load(t,e,i){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?async function(t){const e=await n.e.get().fetch(t),i=await e.text(),r=new nt.T;return r.svg(i),r}(t):async function(t,e,i,r){const s=await n.e.get().fetch(t),o=await s.blob(),a=URL.createObjectURL(o),l=new Image;l.src=a,l.crossOrigin=r,await l.decode(),URL.revokeObjectURL(a);const u=document.createElement("canvas"),h=u.getContext("2d"),c=e.data?.resolution||st(t),d=e.data?.width??l.width,f=e.data?.height??l.height;u.width=d*c,u.height=f*c,h.drawImage(l,0,0,d*c,f*c);const{parseAsGraphicsContext:p,...m}=e.data;return ot(new it.b({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:c,...m}),i,t)}(t,e,i,this.config.crossOrigin)},unload(t){t.destroy(!0)}};let lt=null;class ut{constructor(){lt||(lt=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(lt)}}ut.revokeObjectURL=function(){lt&&(URL.revokeObjectURL(lt),lt=null)};let ht=null;class ct{constructor(){ht||(ht=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ht)}}ct.revokeObjectURL=function(){ht&&(URL.revokeObjectURL(ht),ht=null)};let dt,ft=0;const pt=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const{worker:e}=new ut;e.addEventListener("message",(i=>{e.terminate(),ut.revokeObjectURL(),t(i.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t,e){return this._run("loadImageBitmap",[t,e?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===dt&&(dt=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<dt&&(this._createdWorkers++,t=(new ct).worker,t.addEventListener("message",(t=>{this._complete(t.data),this._returnWorker(t.target),this._next()}))),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){void 0!==t.error?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise(((i,n)=>{this._queue.push({id:t,arguments:e,resolve:i,reject:n})}));return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[ft]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:ft++,id:i})}},mt=[".jpeg",".jpg",".png",".webp",".avif"],gt=["image/jpeg","image/png","image/webp","image/avif"];const vt={name:"loadTextures",extension:{type:t.Ag.LoadParser,priority:m.T.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>W(t,gt)||X(t,mt),async load(t,e,i){let r=null;r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await pt.isImageBitmapSupported()?await pt.loadImageBitmap(t,e):await async function(t,e){const i=await n.e.get().fetch(t);if(!i.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${i.status} ${i.statusText}`);const r=await i.blob();return"premultiplied-alpha"===e?.data?.alphaMode?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}(t,e):await new Promise((e=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=t,r.complete?e(r):r.onload=()=>{e(r)}}));return ot(new it.b({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||st(t),...e.data}),i,t)},unload(t){t.destroy(!0)}};var yt=r(6139),xt=r(6858);const _t=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],bt=_t.map((t=>`video/${t.substring(1)}`));function wt(t,e,i){void 0!==i||e.startsWith("data:")?!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous"):t.crossOrigin=function(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const i=new URL(t,document.baseURI);if(i.hostname!==e.hostname||i.port!==e.port||i.protocol!==e.protocol)return"anonymous";return""}(e)}const St={name:"loadVideo",extension:{type:t.Ag.LoadParser,name:"loadVideo"},test(t){const e=W(t,bt),i=X(t,_t);return e||i},async load(t,e,i){const n={...yt.$.defaultOptions,resolution:e.data?.resolution||st(t),alphaMode:e.data?.alphaMode||await(0,xt.C)(),...e.data},r=document.createElement("video"),s={preload:!1!==n.autoLoad?"auto":void 0,"webkit-playsinline":!1!==n.playsinline?"":void 0,playsinline:!1!==n.playsinline?"":void 0,muted:!0===n.muted?"":void 0,loop:!0===n.loop?"":void 0,autoplay:!1!==n.autoPlay?"":void 0};Object.keys(s).forEach((t=>{const e=s[t];void 0!==e&&r.setAttribute(t,e)})),!0===n.muted&&(r.muted=!0),wt(r,t,n.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const e=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=yt.$.MIME_TYPES[e]||`video/${e}`}return o.src=t,a&&(o.type=a),new Promise((s=>{const a=async()=>{const o=new yt.$({...n,resource:r});var l;r.removeEventListener("canplay",a),e.data.preload&&await(l=r,new Promise(((t,e)=>{function i(){r(),t()}function n(t){r(),e(t)}function r(){l.removeEventListener("canplaythrough",i),l.removeEventListener("error",n)}l.addEventListener("canplaythrough",i),l.addEventListener("error",n),l.load()}))),s(ot(o,i,t))};r.addEventListener("canplay",a),r.appendChild(o)}))},unload(t){t.destroy(!0)}},Ct={extension:{type:t.Ag.ResolveParser,name:"resolveTexture"},test:vt.test,parse:t=>({resolution:parseFloat(rt.x.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},At={extension:{type:t.Ag.ResolveParser,priority:-2,name:"resolveJson"},test:t=>rt.x.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Ct.parse};const Tt=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new rt.x,this.loader=new H,this.cache=k.l,this._backgroundLoader=new O(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return void(0,I.R)("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,i="number"==typeof e?[e]:e,n=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=(0,j.a)(t),n=(0,G.z)(t).map((t=>{if("string"!=typeof t){const e=this.resolver.getAlias(t);return e.some((t=>!this.resolver.hasKey(t)))&&this.add(t),Array.isArray(e)?e[0]:e}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t})),r=this.resolver.resolve(n),s=await this._mapLoadToResolve(r,e);return i?s[n[0]]:s}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;"string"==typeof t&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),r={},s=Object.keys(n);let o=0,a=0;const l=()=>{e?.(++o/a)},u=s.map((t=>{const e=n[t];return a+=Object.keys(e).length,this._mapLoadToResolve(e,l).then((e=>{r[t]=e}))}));return await Promise.all(u),i?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return k.l.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=k.l.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const r={};return i.forEach((t=>{const e=n[t.src],i=[t.src];t.alias&&i.push(...t.alias),i.forEach((t=>{r[t]=e})),k.l.set(i,e)})),r}async unload(t){this._initialized||await this.init();const e=(0,G.z)(t).map((t=>"string"!=typeof t?t.src:t)),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=(0,G.z)(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map((t=>this._unloadFromResolved(e[t])));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach((t=>{k.l.remove(t.src)})),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter(((t,i)=>e.indexOf(t)===i)),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach((e=>{e.config&&Object.keys(e.config).filter((e=>e in t)).forEach((i=>{e.config[i]=t[i]}))}))}};t.XO.handleByList(t.Ag.LoadParser,Tt.loader.parsers).handleByList(t.Ag.ResolveParser,Tt.resolver.parsers).handleByList(t.Ag.CacheParser,Tt.cache.parsers).handleByList(t.Ag.DetectionParser,Tt.detections),t.XO.add(E,U,z,V,L,N,$,Y,q,et,at,vt,St,M,P,Ct,At);const Pt={loader:t.Ag.LoadParser,resolver:t.Ag.ResolveParser,cache:t.Ag.CacheParser,detection:t.Ag.DetectionParser};t.XO.handle(t.Ag.Asset,(e=>{const i=e.ref;Object.entries(Pt).filter((([t])=>!!i[t])).forEach((([e,n])=>t.XO.add(Object.assign(i[e],{extension:i[e].extension??n}))))}),(e=>{const i=e.ref;Object.keys(Pt).filter((t=>!!i[t])).forEach((e=>t.XO.remove(i[e])))}));var Mt=r(2577),It=r(9113),Ot=r(3012),kt=r(5811),Et=r(6554),Rt="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct AlphaUniforms {\n  uAlpha:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n \n    var sample = textureSample(uTexture, uSampler, uv);\n    \n    return sample * alphaUniforms.uAlpha;\n}";const zt=class t extends Et.d{constructor(e){e={...t.defaultOptions,...e};const i=Ot.B.from({vertex:{source:Rt,entryPoint:"mainVertex"},fragment:{source:Rt,entryPoint:"mainFragment"}}),n=It.M.from({vertex:"in vec2 aPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",fragment:"\nin vec2 vTextureCoord;\n\nout vec4 finalColor;\n\nuniform float uAlpha;\nuniform sampler2D uTexture;\n\nvoid main()\n{\n    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;\n}\n",name:"alpha-filter"}),{alpha:r,...s}=e;super({...s,gpuProgram:i,glProgram:n,resources:{alphaUniforms:new kt.k({uAlpha:{value:r,type:"f32"}})}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(t){this.resources.alphaUniforms.uniforms.uAlpha=t}};zt.defaultOptions={alpha:1};let Ft=zt;var Ut=r(2437),Dt=r(5099);const Bt={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Lt=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join("\n");function Nt(t,e){const i=function(t,e){const i=Math.ceil(t/2);let n,r="\n    in vec2 aPosition;\n\n    uniform float uStrength;\n\n    out vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 uInputSize;\n    uniform vec4 uOutputFrame;\n    uniform vec4 uOutputTexture;\n\n    vec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\n    vec2 filterTextureCoord( void )\n    {\n        return aPosition * (uOutputFrame.zw * uInputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        float pixelStrength = uInputSize.%dimension% * uStrength;\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let e=0;e<t;e++){let t=n.replace("%index%",e.toString());t=t.replace("%sampleIndex%",e-(i-1)+".0"),s+=t,s+="\n"}return r=r.replace("%blur%",s),r=r.replace("%size%",t.toString()),r=r.replace("%dimension%",e?"z":"w"),r}(e,t),n=function(t){const e=Bt[t],i=e.length;let n,r=Lt,s="";for(let r=0;r<t;r++){let o="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;".replace("%index%",r.toString());n=r,r>=i&&(n=t-r-1),o=o.replace("%value%",e[n].toString()),s+=o,s+="\n"}return r=r.replace("%blur%",s),r=r.replace("%size%",t.toString()),r}(e);return It.M.from({vertex:i,fragment:n,name:`blur-${t?"horizontal":"vertical"}-pass-filter`})}const $t=class t extends Et.d{constructor(e){const i=Nt((e={...t.defaultOptions,...e}).horizontal,e.kernelSize),n=function(t,e){const i=Bt[e],n=i.length,r=[],s=[],o=[];for(let a=0;a<e;a++){r[a]=`@location(${a}) offset${a}: vec2<f32>,`,s[a]=t?`filteredCord + vec2(${a-n+1} * pixelStrength, 0.0),`:`filteredCord + vec2(0.0, ${a-n+1} * pixelStrength),`;const l=i[a<n?a:e-a-1].toString();o[a]=`finalColor += textureSample(uTexture, uSampler, offset${a}) * ${l};`}const a=r.join("\n"),l=s.join("\n"),u=o.join("\n"),h="\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct BlurUniforms {\n  uStrength:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;\n\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    %blur-struct%\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n\n  let filteredCord = filterTextureCoord(aPosition);\n\n  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;\n\n  return VSOutput(\n   filterVertexPosition(aPosition),\n    %blur-vertex-out%\n  );\n}\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  %blur-fragment-in%\n) -> @location(0) vec4<f32> {\n\n    var   finalColor = vec4(0.0);\n\n    %blur-sampling%\n\n    return finalColor;\n}".replace("%blur-struct%",a).replace("%blur-vertex-out%",l).replace("%blur-fragment-in%",a).replace("%blur-sampling%",u).replace("%dimension%",t?"z":"w");return Ot.B.from({vertex:{source:h,entryPoint:"mainVertex"},fragment:{source:h,entryPoint:"mainFragment"}})}(e.horizontal,e.kernelSize);super({glProgram:i,gpuProgram:n,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...e}),this.horizontal=e.horizontal,this._quality=0,this.quality=e.quality,this.blur=e.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(t,e,i,n){if(this._uniforms.uStrength=this.strength/this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{const r=Ut.W.getSameSizeTexture(e);let s=e,o=r;this._state.blend=!1;const a=t.renderer.type===Dt.W.WEBGPU;for(let e=0;e<this.passes-1;e++){t.applyFilter(this,s,o,0===e||a);const i=o;o=s,s=i}this._state.blend=!0,t.applyFilter(this,s,i,n),Ut.W.returnTexture(r)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};$t.defaultOptions={strength:8,quality:4,kernelSize:5};let Vt=$t;class Gt extends Et.d{constructor(...t){let e=t[0]??{};"number"==typeof e&&((0,d.t6)(d.lj,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),e={strength:e},void 0!==t[1]&&(e.quality=t[1]),void 0!==t[2]&&(e.resolution=t[2]||"inherit"),void 0!==t[3]&&(e.kernelSize=t[3])),e={...Vt.defaultOptions,...e};const{strength:i,strengthX:n,strengthY:r,quality:s,...o}=e;super({...o,compatibleRenderers:Dt.W.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Vt({horizontal:!0,...e}),this.blurYFilter=new Vt({horizontal:!1,...e}),this.quality=s,this.strengthX=n??i,this.strengthY=r??i,this.repeatEdgePixels=!1}apply(t,e,i,n){const r=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(r&&s){const r=Ut.W.getSameSizeTexture(e);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(t,e,r,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,r,i,n),Ut.W.returnTexture(r)}else s?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,e,i,n)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(t,e,i,n))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get strengthX(){return this.blurXFilter.blur}set strengthX(t){this.blurXFilter.blur=t,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(t){this.blurYFilter.blur=t,this.updatePadding()}get blur(){return(0,d.t6)("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(t){(0,d.t6)("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=t}get blurX(){return(0,d.t6)("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(t){(0,d.t6)("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=t}get blurY(){return(0,d.t6)("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(t){(0,d.t6)("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}Gt.defaultOptions={strength:8,quality:4,kernelSize:5};var jt=r(1652),Ht=r(2812),Wt=r(5101),Xt=r(1285),Yt=(r(6557),r(548)),qt=r(9408),Kt=r(4985),Zt=r(975);const Qt=class t extends Kt.l{constructor(e){e instanceof x.g&&(e={texture:e});const{width:i,height:n,leftWidth:r,rightWidth:s,topHeight:o,bottomHeight:a,texture:l,roundPixels:u,...h}=e;super({label:"NineSliceSprite",...h}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._leftWidth=r??l?.defaultBorders?.left??Zt.P.defaultOptions.leftWidth,this._topHeight=o??l?.defaultBorders?.top??Zt.P.defaultOptions.topHeight,this._rightWidth=s??l?.defaultBorders?.right??Zt.P.defaultOptions.rightWidth,this._bottomHeight=a??l?.defaultBorders?.bottom??Zt.P.defaultOptions.bottomHeight,this.bounds.maxX=this._width=i??l.width??Zt.P.defaultOptions.width,this.bounds.maxY=this._height=n??l.height??Zt.P.defaultOptions.height,this.allowChildren=!1,this.texture=l??t.defaultOptions.texture,this.roundPixels=u??!1}get bounds(){return this._bounds}get width(){return this._width}set width(t){this.bounds.maxX=this._width=t,this.onViewUpdate()}get height(){return this._height}set height(t){this.bounds.maxY=this._height=t,this.onViewUpdate()}setSize(t,e){"object"==typeof t&&(e=t.height??t.width,t=t.width),this.bounds.maxX=this._width=t,this.bounds.maxY=this._height=e??t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this.onViewUpdate()}get texture(){return this._texture}set texture(t){t||(t=x.g.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}addBounds(t){const e=this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}destroy(t){super.destroy(t);if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._texture.destroy(e)}this._texture=null}};Qt.defaultOptions={texture:x.g.EMPTY};let Jt=Qt;var te=r(6844);class ee extends Kt.l{constructor(t,e){const{text:i,resolution:n,style:r,anchor:s,width:o,height:a,roundPixels:l,...u}=t;super({...u}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=i??"",this.style=r,this.resolution=n??null,this.allowChildren=!1,this._anchor=new Ht.o({_onUpdate:()=>{this.onViewUpdate()}}),s&&(this.anchor=s),this.roundPixels=l??!1,void 0!==o&&(this.width=o),void 0!==a&&(this.height=a)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=null===t,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){t=t||{},this._style?.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){"object"==typeof t?(e=t.height??t.width,t=t.width):e??(e=t),void 0!==t&&this._setWidth(t,this.bounds.width),void 0!==e&&this._setHeight(e,this.bounds.height)}addBounds(t){const e=this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}containsPoint(t){const e=this.bounds.width,i=this.bounds.height,n=-e*this.anchor.x;let r=0;return t.x>=n&&t.x<=n+e&&(r=-i*this.anchor.y,t.y>=r&&t.y<=r+i)}onViewUpdate(){this._boundsDirty=!0,this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,("boolean"==typeof t?t:t?.style)&&this._style.destroy(t),this._style=null,this._text=null}}var ie=r(4016),ne=r(8291);class re extends ee{constructor(...t){const e=function(t,e){let i=t[0]??{};return("string"==typeof i||t[1])&&((0,d.t6)(d.lj,`use new ${e}({ text: "hi!", style }) instead`),i={text:i,style:t[1]}),i}(t,"Text");super(e,ne.x),this.renderPipeId="text"}_updateBounds(){const t=this._bounds,e=this._anchor,i=ie.P.measureText(this._text,this._style),{width:n,height:r}=i;t.minX=-e._x*n,t.maxX=t.minX+n,t.minY=-e._y*r,t.maxY=t.minY+r}}var se=r(7309),oe=r(7218),ae=r(8875);r(6570);function le(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ue(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}t.XO.add(e,i);var he,ce,de,fe,pe,me,ge,ve,ye,xe,_e,be,we,Se,Ce,Ae,Te,Pe={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Me={duration:.5,overwrite:!1,delay:0},Ie=1e8,Oe=1e-8,ke=2*Math.PI,Ee=ke/4,Re=0,ze=Math.sqrt,Fe=Math.cos,Ue=Math.sin,De=function(t){return"string"==typeof t},Be=function(t){return"function"==typeof t},Le=function(t){return"number"==typeof t},Ne=function(t){return void 0===t},$e=function(t){return"object"==typeof t},Ve=function(t){return!1!==t},Ge=function(){return"undefined"!=typeof window},je=function(t){return Be(t)||De(t)},He="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},We=Array.isArray,Xe=/(?:-?\.?\d|\.)+/gi,Ye=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,qe=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ke=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Ze=/[+-]=-?[.\d]+/,Qe=/[^,'"\[\]\s]+/gi,Je=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ti={},ei={},ii=function(t){return(ei=ki(t,ti))&&Rr},ni=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},ri=function(t,e){return!e&&console.warn(t)},si=function(t,e){return t&&(ti[t]=e)&&ei&&(ei[t]=e)||ti},oi=function(){return 0},ai={suppressEvents:!0,isStart:!0,kill:!1},li={suppressEvents:!0,kill:!1},ui={suppressEvents:!0},hi={},ci=[],di={},fi={},pi={},mi=30,gi=[],vi="",yi=function(t){var e,i,n=t[0];if($e(n)||Be(n)||(t=[t]),!(e=(n._gsap||{}).harness)){for(i=gi.length;i--&&!gi[i].targetTest(n););e=gi[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new Xn(t[i],e)))||t.splice(i,1);return t},xi=function(t){return t._gsap||yi(hn(t))[0]._gsap},_i=function(t,e,i){return(i=t[e])&&Be(i)?t[e]():Ne(i)&&t.getAttribute&&t.getAttribute(e)||i},bi=function(t,e){return(t=t.split(",")).forEach(e)||t},wi=function(t){return Math.round(1e5*t)/1e5||0},Si=function(t){return Math.round(1e7*t)/1e7||0},Ci=function(t,e){var i=e.charAt(0),n=parseFloat(e.substr(2));return t=parseFloat(t),"+"===i?t+n:"-"===i?t-n:"*"===i?t*n:t/n},Ai=function(t,e){for(var i=e.length,n=0;t.indexOf(e[n])<0&&++n<i;);return n<i},Ti=function(){var t,e,i=ci.length,n=ci.slice(0);for(di={},ci.length=0,t=0;t<i;t++)(e=n[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Pi=function(t,e,i,n){ci.length&&!ce&&Ti(),t.render(e,i,n||ce&&e<0&&(t._initted||t._startAt)),ci.length&&!ce&&Ti()},Mi=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(Qe).length<2?e:De(t)?t.trim():t},Ii=function(t){return t},Oi=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},ki=function(t,e){for(var i in e)t[i]=e[i];return t},Ei=function t(e,i){for(var n in i)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=$e(i[n])?t(e[n]||(e[n]={}),i[n]):i[n]);return e},Ri=function(t,e){var i,n={};for(i in t)i in e||(n[i]=t[i]);return n},zi=function(t){var e,i=t.parent||fe,n=t.keyframes?(e=We(t.keyframes),function(t,i){for(var n in i)n in t||"duration"===n&&e||"ease"===n||(t[n]=i[n])}):Oi;if(Ve(t.inherit))for(;i;)n(t,i.vars.defaults),i=i.parent||i._dp;return t},Fi=function(t,e,i,n,r){void 0===i&&(i="_first"),void 0===n&&(n="_last");var s,o=t[n];if(r)for(s=e[r];o&&o[r]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[n]=e,e._prev=o,e.parent=e._dp=t,e},Ui=function(t,e,i,n){void 0===i&&(i="_first"),void 0===n&&(n="_last");var r=e._prev,s=e._next;r?r._next=s:t[i]===e&&(t[i]=s),s?s._prev=r:t[n]===e&&(t[n]=r),e._next=e._prev=e.parent=null},Di=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Bi=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},Li=function(t,e,i,n){return t._startAt&&(ce?t._startAt.revert(li):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,n))},Ni=function t(e){return!e||e._ts&&t(e.parent)},$i=function(t){return t._repeat?Vi(t._tTime,t=t.duration()+t._rDelay)*t:0},Vi=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},Gi=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},ji=function(t){return t._end=Si(t._start+(t._tDur/Math.abs(t._ts||t._rts||Oe)||0))},Hi=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=Si(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),ji(t),i._dirty||Bi(i,t)),t},Wi=function(t,e){var i;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(i=Gi(t.rawTime(),e),(!e._dur||sn(0,e.totalDuration(),i)-e._tTime>Oe)&&e.render(i,!0)),Bi(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-1e-8}},Xi=function(t,e,i,n){return e.parent&&Di(e),e._start=Si((Le(i)?i:i||t!==fe?en(t,i,e):t._time)+e._delay),e._end=Si(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Fi(t,e,"_first","_last",t._sort?"_start":0),Zi(e)||(t._recent=e),n||Wi(t,e),t._ts<0&&Hi(t,t._tTime),t},Yi=function(t,e){return(ti.ScrollTrigger||ni("scrollTrigger",e))&&ti.ScrollTrigger.create(e,t)},qi=function(t,e,i,n,r){return er(t,e,r),t._initted?!i&&t._pt&&!ce&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&ye!==zn.frame?(ci.push(t),t._lazy=[r,n],1):void 0:1},Ki=function t(e){var i=e.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||t(i))},Zi=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},Qi=function(t,e,i,n){var r=t._repeat,s=Si(e)||0,o=t._tTime/t._tDur;return o&&!n&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:Si(s*(r+1)+t._rDelay*r):s,o>0&&!n&&Hi(t,t._tTime=t._tDur*o),t.parent&&ji(t),i||Bi(t.parent,t),t},Ji=function(t){return t instanceof qn?Bi(t):Qi(t,t._dur)},tn={_start:0,endTime:oi,totalDuration:oi},en=function t(e,i,n){var r,s,o,a=e.labels,l=e._recent||tn,u=e.duration()>=Ie?l.endTime(!1):e._dur;return De(i)&&(isNaN(i)||i in a)?(s=i.charAt(0),o="%"===i.substr(-1),r=i.indexOf("="),"<"===s||">"===s?(r>=0&&(i=i.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(i.substr(1))||0)*(o?(r<0?l:n).totalDuration()/100:1)):r<0?(i in a||(a[i]=u),a[i]):(s=parseFloat(i.charAt(r-1)+i.substr(r+1)),o&&n&&(s=s/100*(We(n)?n[0]:n).totalDuration()),r>1?t(e,i.substr(0,r-1),n)+s:u+s)):null==i?u:+i},nn=function(t,e,i){var n,r,s=Le(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=i,t){for(n=a,r=i;r&&!("immediateRender"in n);)n=r.vars.defaults||{},r=Ve(r.vars.inherit)&&r.parent;a.immediateRender=Ve(n.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new or(e[0],a,e[o+1])},rn=function(t,e){return t||0===t?e(t):e},sn=function(t,e,i){return i<t?t:i>e?e:i},on=function(t,e){return De(t)&&(e=Je.exec(t))?e[1]:""},an=[].slice,ln=function(t,e){return t&&$e(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&$e(t[0]))&&!t.nodeType&&t!==pe},un=function(t,e,i){return void 0===i&&(i=[]),t.forEach((function(t){var n;return De(t)&&!e||ln(t,1)?(n=i).push.apply(n,hn(t)):i.push(t)}))||i},hn=function(t,e,i){return de&&!e&&de.selector?de.selector(t):!De(t)||i||!me&&Fn()?We(t)?un(t,i):ln(t)?an.call(t,0):t?[t]:[]:an.call((e||ge).querySelectorAll(t),0)},cn=function(t){return t=hn(t)[0]||ri("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return hn(e,i.querySelectorAll?i:i===t?ri("Invalid scope")||ge.createElement("div"):t)}},dn=function(t){return t.sort((function(){return.5-Math.random()}))},fn=function(t){if(Be(t))return t;var e=$e(t)?t:{each:t},i=Vn(e.ease),n=e.from||0,r=parseFloat(e.base)||0,s={},o=n>0&&n<1,a=isNaN(n)||o,l=e.axis,u=n,h=n;return De(n)?u=h={center:.5,edges:.5,end:1}[n]||0:!o&&a&&(u=n[0],h=n[1]),function(t,o,c){var d,f,p,m,g,v,y,x,_,b=(c||e).length,w=s[b];if(!w){if(!(_="auto"===e.grid?0:(e.grid||[1,Ie])[1])){for(y=-Ie;y<(y=c[_++].getBoundingClientRect().left)&&_<b;);_<b&&_--}for(w=s[b]=[],d=a?Math.min(_,b)*u-.5:n%_,f=_===Ie?0:a?b*h/_-.5:n/_|0,y=0,x=Ie,v=0;v<b;v++)p=v%_-d,m=f-(v/_|0),w[v]=g=l?Math.abs("y"===l?m:p):ze(p*p+m*m),g>y&&(y=g),g<x&&(x=g);"random"===n&&dn(w),w.max=y-x,w.min=x,w.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(_>b?b-1:l?"y"===l?b/_:_:Math.max(_,b/_))||0)*("edges"===n?-1:1),w.b=b<0?r-b:r,w.u=on(e.amount||e.each)||0,i=i&&b<0?Nn(i):i}return b=(w[t]-w.min)/w.max||0,Si(w.b+(i?i(b):b)*w.v)+w.u}},pn=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var n=Si(Math.round(parseFloat(i)/t)*t*e);return(n-n%1)/e+(Le(i)?0:on(i))}},mn=function(t,e){var i,n,r=We(t);return!r&&$e(t)&&(i=r=t.radius||Ie,t.values?(t=hn(t.values),(n=!Le(t[0]))&&(i*=i)):t=pn(t.increment)),rn(e,r?Be(t)?function(e){return n=t(e),Math.abs(n-e)<=i?n:e}:function(e){for(var r,s,o=parseFloat(n?e.x:e),a=parseFloat(n?e.y:0),l=Ie,u=0,h=t.length;h--;)(r=n?(r=t[h].x-o)*r+(s=t[h].y-a)*s:Math.abs(t[h]-o))<l&&(l=r,u=h);return u=!i||l<=i?t[u]:e,n||u===e||Le(e)?u:u+on(e)}:pn(t))},gn=function(t,e,i,n){return rn(We(t)?!e:!0===i?!!(i=0):!n,(function(){return We(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+.99*i))/i)*i*n)/n}))},vn=function(t,e,i){return rn(i,(function(i){return t[~~e(i)]}))},yn=function(t){for(var e,i,n,r,s=0,o="";~(e=t.indexOf("random(",s));)n=t.indexOf(")",e),r="["===t.charAt(e+7),i=t.substr(e+7,n-e-7).match(r?Qe:Xe),o+=t.substr(s,e-s)+gn(r?i:+i[0],r?0:+i[1],+i[2]||1e-5),s=n+1;return o+t.substr(s,t.length-s)},xn=function(t,e,i,n,r){var s=e-t,o=n-i;return rn(r,(function(e){return i+((e-t)/s*o||0)}))},_n=function(t,e,i){var n,r,s,o=t.labels,a=Ie;for(n in o)(r=o[n]-e)<0==!!i&&r&&a>(r=Math.abs(r))&&(s=n,a=r);return s},bn=function(t,e,i){var n,r,s,o=t.vars,a=o[e],l=de,u=t._ctx;if(a)return n=o[e+"Params"],r=o.callbackScope||t,i&&ci.length&&Ti(),u&&(de=u),s=n?a.apply(r,n):a.call(r),de=l,s},wn=function(t){return Di(t),t.scrollTrigger&&t.scrollTrigger.kill(!!ce),t.progress()<1&&bn(t,"onInterrupt"),t},Sn=[],Cn=function(t){if(t)if(t=!t.name&&t.default||t,Ge()||t.headless){var e=t.name,i=Be(t),n=e&&!i&&t.init?function(){this._props=[]}:t,r={init:oi,render:mr,add:Jn,kill:vr,modifier:gr,rawVars:0},s={targetTest:0,get:0,getSetter:cr,aliases:{},register:0};if(Fn(),t!==n){if(fi[e])return;Oi(n,Oi(Ri(t,r),s)),ki(n.prototype,ki(r,Ri(t,s))),fi[n.prop=e]=n,t.targetTest&&(gi.push(n),hi[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}si(e,n),t.register&&t.register(Rr,n,_r)}else Sn.push(t)},An=255,Tn={aqua:[0,An,An],lime:[0,An,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,An],navy:[0,0,128],white:[An,An,An],olive:[128,128,0],yellow:[An,An,0],orange:[An,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[An,0,0],pink:[An,192,203],cyan:[0,An,An],transparent:[An,An,An,0]},Pn=function(t,e,i){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(i-e)*t*6:t<.5?i:3*t<2?e+(i-e)*(2/3-t)*6:e)*An+.5|0},Mn=function(t,e,i){var n,r,s,o,a,l,u,h,c,d,f=t?Le(t)?[t>>16,t>>8&An,t&An]:0:Tn.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Tn[t])f=Tn[t];else if("#"===t.charAt(0)){if(t.length<6&&(n=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+n+n+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&An,f&An,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&An,t&An]}else if("hsl"===t.substr(0,3))if(f=d=t.match(Xe),e){if(~t.indexOf("="))return f=t.match(Ye),i&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,n=2*(l=+f[2]/100)-(r=l<=.5?l*(a+1):l+a-l*a),f.length>3&&(f[3]*=1),f[0]=Pn(o+1/3,n,r),f[1]=Pn(o,n,r),f[2]=Pn(o-1/3,n,r);else f=t.match(Xe)||Tn.transparent;f=f.map(Number)}return e&&!d&&(n=f[0]/An,r=f[1]/An,s=f[2]/An,l=((u=Math.max(n,r,s))+(h=Math.min(n,r,s)))/2,u===h?o=a=0:(c=u-h,a=l>.5?c/(2-u-h):c/(u+h),o=u===n?(r-s)/c+(r<s?6:0):u===r?(s-n)/c+2:(n-r)/c+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*l+.5)),i&&f.length<4&&(f[3]=1),f},In=function(t){var e=[],i=[],n=-1;return t.split(kn).forEach((function(t){var r=t.match(qe)||[];e.push.apply(e,r),i.push(n+=r.length+1)})),e.c=i,e},On=function(t,e,i){var n,r,s,o,a="",l=(t+a).match(kn),u=e?"hsla(":"rgba(",h=0;if(!l)return t;if(l=l.map((function(t){return(t=Mn(t,e,1))&&u+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),i&&(s=In(t),(n=i.c).join(a)!==s.c.join(a)))for(o=(r=t.replace(kn,"1").split(qe)).length-1;h<o;h++)a+=r[h]+(~n.indexOf(h)?l.shift()||u+"0,0,0,0)":(s.length?s:l.length?l:i).shift());if(!r)for(o=(r=t.split(kn)).length-1;h<o;h++)a+=r[h]+l[h];return a+r[o]},kn=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Tn)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),En=/hsl[a]?\(/,Rn=function(t){var e,i=t.join(" ");if(kn.lastIndex=0,kn.test(i))return e=En.test(i),t[1]=On(t[1],e),t[0]=On(t[0],e,In(t[1])),!0},zn=function(){var t,e,i,n,r,s,o=Date.now,a=500,l=33,u=o(),h=u,c=1e3/240,d=c,f=[],p=function i(p){var m,g,v,y,x=o()-h,_=!0===p;if((x>a||x<0)&&(u+=x-l),((m=(v=(h+=x)-u)-d)>0||_)&&(y=++n.frame,r=v-1e3*n.time,n.time=v/=1e3,d+=m+(m>=c?4:c-m),g=1),_||(t=e(i)),g)for(s=0;s<f.length;s++)f[s](v,r,y,p)};return n={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){ve&&(!me&&Ge()&&(pe=me=window,ge=pe.document||{},ti.gsap=Rr,(pe.gsapVersions||(pe.gsapVersions=[])).push(Rr.version),ii(ei||pe.GreenSockGlobals||!pe.gsap&&pe||{}),Sn.forEach(Cn)),i="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,t&&n.sleep(),e=i||function(t){return setTimeout(t,d-1e3*n.time+1|0)},_e=1,p(2))},sleep:function(){(i?cancelAnimationFrame:clearTimeout)(t),_e=0,e=oi},lagSmoothing:function(t,e){a=t||1/0,l=Math.min(e||33,a)},fps:function(t){c=1e3/(t||240),d=1e3*n.time+c},add:function(t,e,i){var r=e?function(e,i,s,o){t(e,i,s,o),n.remove(r)}:t;return n.remove(t),f[i?"unshift":"push"](r),Fn(),r},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&s>=e&&s--},_listeners:f},n}(),Fn=function(){return!_e&&zn.wake()},Un={},Dn=/^[\d.\-M][\d.\-,\s]/,Bn=/["']/g,Ln=function(t){for(var e,i,n,r={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)i=s[a],e=a!==l-1?i.lastIndexOf(","):i.length,n=i.substr(0,e),r[o]=isNaN(n)?n.replace(Bn,"").trim():+n,o=i.substr(e+1).trim();return r},Nn=function(t){return function(e){return 1-t(1-e)}},$n=function t(e,i){for(var n,r=e._first;r;)r instanceof qn?t(r,i):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===i||(r.timeline?t(r.timeline,i):(n=r._ease,r._ease=r._yEase,r._yEase=n,r._yoyo=i)),r=r._next},Vn=function(t,e){return t&&(Be(t)?t:Un[t]||function(t){var e,i,n,r,s=(t+"").split("("),o=Un[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[Ln(s[1])]:(e=t,i=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",i),e.substring(i,~r&&r<n?e.indexOf(")",n+1):n)).split(",").map(Mi)):Un._CE&&Dn.test(t)?Un._CE("",t):o}(t))||e},Gn=function(t,e,i,n){void 0===i&&(i=function(t){return 1-e(1-t)}),void 0===n&&(n=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:i,easeInOut:n};return bi(t,(function(t){for(var e in Un[t]=ti[t]=s,Un[r=t.toLowerCase()]=i,s)Un[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Un[t+"."+e]=s[e]})),s},jn=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Hn=function t(e,i,n){var r=i>=1?i:1,s=(n||(e?.3:.45))/(i<1?i:1),o=s/ke*(Math.asin(1/r)||0),a=function(t){return 1===t?1:r*Math.pow(2,-10*t)*Ue((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:jn(a);return s=ke/s,l.config=function(i,n){return t(e,i,n)},l},Wn=function t(e,i){void 0===i&&(i=1.70158);var n=function(t){return t?--t*t*((i+1)*t+i)+1:0},r="out"===e?n:"in"===e?function(t){return 1-n(1-t)}:jn(n);return r.config=function(i){return t(e,i)},r};bi("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var i=e<5?e+1:e;Gn(t+",Power"+(i-1),e?function(t){return Math.pow(t,i)}:function(t){return t},(function(t){return 1-Math.pow(1-t,i)}),(function(t){return t<.5?Math.pow(2*t,i)/2:1-Math.pow(2*(1-t),i)/2}))})),Un.Linear.easeNone=Un.none=Un.Linear.easeIn,Gn("Elastic",Hn("in"),Hn("out"),Hn()),be=7.5625,Ce=2*(Se=1/(we=2.75)),Ae=2.5*Se,Te=function(t){return t<Se?be*t*t:t<Ce?be*Math.pow(t-1.5/we,2)+.75:t<Ae?be*(t-=2.25/we)*t+.9375:be*Math.pow(t-2.625/we,2)+.984375},Gn("Bounce",(function(t){return 1-Te(1-t)}),Te),Gn("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),Gn("Circ",(function(t){return-(ze(1-t*t)-1)})),Gn("Sine",(function(t){return 1===t?1:1-Fe(t*Ee)})),Gn("Back",Wn("in"),Wn("out"),Wn()),Un.SteppedEase=Un.steps=ti.SteppedEase={config:function(t,e){void 0===t&&(t=1);var i=1/t,n=t+(e?0:1),r=e?1:0;return function(t){return((n*sn(0,.99999999,t)|0)+r)*i}}},Me.ease=Un["quad.out"],bi("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return vi+=t+","+t+"Params,"}));var Xn=function(t,e){this.id=Re++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:_i,this.set=e?e.getSetter:cr},Yn=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Qi(this,+t.duration,1,1),this.data=t.data,de&&(this._ctx=de,de.data.push(this)),_e||zn.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,Qi(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(Fn(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Hi(this,t),!i._dp||i.parent||Wi(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Xi(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===Oe||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Pi(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+$i(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+$i(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*i,e):this._repeat?Vi(this._tTime,i)+1:1},e.timeScale=function(t,e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var i=this.parent&&this._ts?Gi(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(sn(-Math.abs(this._delay),this._tDur,i),!1!==e),ji(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Fn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Oe&&(this._tTime-=Oe)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Xi(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Ve(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Gi(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=ui);var e=ce;return ce=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),ce=e,this},e.globalTime=function(t){for(var e=this,i=arguments.length?t:e.rawTime();e;)i=e._start+i/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):i},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,Ji(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,Ji(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(en(this,t),Ve(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Ve(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,i=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=i&&t<this.endTime(!0)-Oe))},e.eventCallback=function(t,e,i){var n=this.vars;return arguments.length>1?(e?(n[t]=e,i&&(n[t+"Params"]=i),"onUpdate"===t&&(this._onUpdate=e)):delete n[t],this):n[t]},e.then=function(t){var e=this;return new Promise((function(i){var n=Be(t)?t:Ii,r=function(){var t=e.then;e.then=null,Be(n)&&(n=n(e))&&(n.then||n===e)&&(e.then=t),i(n),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){wn(this)},t}();Oi(Yn.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var qn=function(t){function e(e,i){var n;return void 0===e&&(e={}),(n=t.call(this,e)||this).labels={},n.smoothChildTiming=!!e.smoothChildTiming,n.autoRemoveChildren=!!e.autoRemoveChildren,n._sort=Ve(e.sortChildren),fe&&Xi(e.parent||fe,le(n),i),e.reversed&&n.reverse(),e.paused&&n.paused(!0),e.scrollTrigger&&Yi(le(n),e.scrollTrigger),n}ue(e,t);var i=e.prototype;return i.to=function(t,e,i){return nn(0,arguments,this),this},i.from=function(t,e,i){return nn(1,arguments,this),this},i.fromTo=function(t,e,i,n){return nn(2,arguments,this),this},i.set=function(t,e,i){return e.duration=0,e.parent=this,zi(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new or(t,e,en(this,i),1),this},i.call=function(t,e,i){return Xi(this,or.delayedCall(0,t,e),i)},i.staggerTo=function(t,e,i,n,r,s,o){return i.duration=e,i.stagger=i.stagger||n,i.onComplete=s,i.onCompleteParams=o,i.parent=this,new or(t,i,en(this,r)),this},i.staggerFrom=function(t,e,i,n,r,s,o){return i.runBackwards=1,zi(i).immediateRender=Ve(i.immediateRender),this.staggerTo(t,e,i,n,r,s,o)},i.staggerFromTo=function(t,e,i,n,r,s,o,a){return n.startAt=i,zi(n).immediateRender=Ve(n.immediateRender),this.staggerTo(t,e,n,r,s,o,a)},i.render=function(t,e,i){var n,r,s,o,a,l,u,h,c,d,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=t<=0?0:Si(t),x=this._zTime<0!=t<0&&(this._initted||!v);if(this!==fe&&y>g&&t>=0&&(y=g),y!==this._tTime||i||x){if(m!==this._time&&v&&(y+=this._time-m,t+=this._time-m),n=y,c=this._start,l=!(h=this._ts),x&&(v||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,a=v+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,i);if(n=Si(y%a),y===g?(o=this._repeat,n=v):((o=~~(y/a))&&o===y/a&&(n=v,o--),n>v&&(n=v)),d=Vi(this._tTime,a),!m&&this._tTime&&d!==o&&this._tTime-d*a-this._dur<=0&&(d=o),f&&1&o&&(n=v-n,p=1),o!==d&&!this._lock){var _=f&&1&d,b=_===(f&&1&o);if(o<d&&(_=!_),m=_?0:y%v?v:y,this._lock=1,this.render(m||(p?0:Si(o*a)),e,!v)._lock=0,this._tTime=y,!e&&this.parent&&bn(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,b&&(this._lock=2,m=_?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;$n(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(t,e,i){var n;if(i>e)for(n=t._first;n&&n._start<=i;){if("isPause"===n.data&&n._start>e)return n;n=n._next}else for(n=t._last;n&&n._start>=i;){if("isPause"===n.data&&n._start<e)return n;n=n._prev}}(this,Si(m),Si(n)),u&&(y-=n-(n=u._start))),this._tTime=y,this._time=n,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&n&&!e&&!o&&(bn(this,"onStart"),this._tTime!==y))return this;if(n>=m&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||n>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,i);if(r.render(r._ts>0?(n-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(n-r._start)*r._ts,e,i),n!==this._time||!this._ts&&!l){u=0,s&&(y+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var w=t<0?t:n;r;){if(s=r._prev,(r._act||w<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,i);if(r.render(r._ts>0?(w-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(w-r._start)*r._ts,e,i||ce&&(r._initted||r._startAt)),n!==this._time||!this._ts&&!l){u=0,s&&(y+=this._zTime=w?-1e-8:Oe);break}}r=s}}if(u&&!e&&(this.pause(),u.render(n>=m?0:-1e-8)._zTime=n>=m?1:-1,this._ts))return this._start=c,ji(this),this.render(t,e,i);this._onUpdate&&!e&&bn(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(c!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&Di(this,1),e||t<0&&!m||!y&&!m&&g||(bn(this,y===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(t,e){var i=this;if(Le(e)||(e=en(this,e,t)),!(t instanceof Yn)){if(We(t))return t.forEach((function(t){return i.add(t,e)})),this;if(De(t))return this.addLabel(t,e);if(!Be(t))return this;t=or.delayedCall(0,t)}return this!==t?Xi(this,t,e):this},i.getChildren=function(t,e,i,n){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=-Ie);for(var r=[],s=this._first;s;)s._start>=n&&(s instanceof or?e&&r.push(s):(i&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,i)))),s=s._next;return r},i.getById=function(t){for(var e=this.getChildren(1,1,1),i=e.length;i--;)if(e[i].vars.id===t)return e[i]},i.remove=function(t){return De(t)?this.removeLabel(t):Be(t)?this.killTweensOf(t):(Ui(this,t),t===this._recent&&(this._recent=this._last),Bi(this))},i.totalTime=function(e,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Si(zn.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,i),this._forcing=0,this):this._tTime},i.addLabel=function(t,e){return this.labels[t]=en(this,e),this},i.removeLabel=function(t){return delete this.labels[t],this},i.addPause=function(t,e,i){var n=or.delayedCall(0,e||oi,i);return n.data="isPause",this._hasPause=1,Xi(this,n,en(this,t))},i.removePause=function(t){var e=this._first;for(t=en(this,t);e;)e._start===t&&"isPause"===e.data&&Di(e),e=e._next},i.killTweensOf=function(t,e,i){for(var n=this.getTweensOf(t,i),r=n.length;r--;)Kn!==n[r]&&n[r].kill(t,e);return this},i.getTweensOf=function(t,e){for(var i,n=[],r=hn(t),s=this._first,o=Le(e);s;)s instanceof or?Ai(s._targets,r)&&(o?(!Kn||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&n.push(s):(i=s.getTweensOf(r,e)).length&&n.push.apply(n,i),s=s._next;return n},i.tweenTo=function(t,e){e=e||{};var i,n=this,r=en(n,t),s=e,o=s.startAt,a=s.onStart,l=s.onStartParams,u=s.immediateRender,h=or.to(n,Oi({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||Oe,onStart:function(){if(n.pause(),!i){var t=e.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale());h._dur!==t&&Qi(h,t,0,1).render(h._time,!0,!0),i=1}a&&a.apply(h,l||[])}},e));return u?h.render(0):h},i.tweenFromTo=function(t,e,i){return this.tweenTo(e,Oi({startAt:{time:en(this,t)}},i))},i.recent=function(){return this._recent},i.nextLabel=function(t){return void 0===t&&(t=this._time),_n(this,en(this,t))},i.previousLabel=function(t){return void 0===t&&(t=this._time),_n(this,en(this,t),1)},i.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+Oe)},i.shiftChildren=function(t,e,i){void 0===i&&(i=0);for(var n,r=this._first,s=this.labels;r;)r._start>=i&&(r._start+=t,r._end+=t),r=r._next;if(e)for(n in s)s[n]>=i&&(s[n]+=t);return Bi(this)},i.invalidate=function(e){var i=this._first;for(this._lock=0;i;)i.invalidate(e),i=i._next;return t.prototype.invalidate.call(this,e)},i.clear=function(t){void 0===t&&(t=!0);for(var e,i=this._first;i;)e=i._next,this.remove(i),i=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Bi(this)},i.totalDuration=function(t){var e,i,n,r=0,s=this,o=s._last,a=Ie;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(n=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(i=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Xi(s,o,i-o._delay,1)._lock=0):a=i,i<0&&o._ts&&(r-=i,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=i/s._ts,s._time-=i,s._tTime-=i),s.shiftChildren(-i,!1,-Infinity),a=0),o._end>r&&o._ts&&(r=o._end),o=e;Qi(s,s===fe&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(fe._ts&&(Pi(fe,Gi(t,fe)),ye=zn.frame),zn.frame>=mi){mi+=Pe.autoSleep||120;var e=fe._first;if((!e||!e._ts)&&Pe.autoSleep&&zn._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||zn.sleep()}}},e}(Yn);Oi(qn.prototype,{_lock:0,_hasPause:0,_forcing:0});var Kn,Zn,Qn=function(t,e,i,n,r,s,o){var a,l,u,h,c,d,f,p,m=new _r(this._pt,t,e,0,1,pr,null,r),g=0,v=0;for(m.b=i,m.e=n,i+="",(f=~(n+="").indexOf("random("))&&(n=yn(n)),s&&(s(p=[i,n],t,e),i=p[0],n=p[1]),l=i.match(Ke)||[];a=Ke.exec(n);)h=a[0],c=n.substring(g,a.index),u?u=(u+1)%5:"rgba("===c.substr(-5)&&(u=1),h!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:c||1===v?c:",",s:d,c:"="===h.charAt(1)?Ci(d,h)-d:parseFloat(h)-d,m:u&&u<4?Math.round:0},g=Ke.lastIndex);return m.c=g<n.length?n.substring(g,n.length):"",m.fp=o,(Ze.test(n)||f)&&(m.e=0),this._pt=m,m},Jn=function(t,e,i,n,r,s,o,a,l,u){Be(n)&&(n=n(r||0,t,s));var h,c=t[e],d="get"!==i?i:Be(c)?l?t[e.indexOf("set")||!Be(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():c,f=Be(c)?l?ur:lr:ar;if(De(n)&&(~n.indexOf("random(")&&(n=yn(n)),"="===n.charAt(1)&&((h=Ci(d,n)+(on(d)||0))||0===h)&&(n=h)),!u||d!==n||Zn)return isNaN(d*n)||""===n?(!c&&!(e in t)&&ni(e,n),Qn.call(this,t,e,d,n,f,a||Pe.stringFilter,l)):(h=new _r(this._pt,t,e,+d||0,n-(d||0),"boolean"==typeof c?fr:dr,0,f),l&&(h.fp=l),o&&h.modifier(o,this,t),this._pt=h)},tr=function(t,e,i,n,r,s){var o,a,l,u;if(fi[t]&&!1!==(o=new fi[t]).init(r,o.rawVars?e[t]:function(t,e,i,n,r){if(Be(t)&&(t=nr(t,r,e,i,n)),!$e(t)||t.style&&t.nodeType||We(t)||He(t))return De(t)?nr(t,r,e,i,n):t;var s,o={};for(s in t)o[s]=nr(t[s],r,e,i,n);return o}(e[t],n,r,s,i),i,n,s)&&(i._pt=a=new _r(i._pt,r,t,0,1,o.render,o,0,o.priority),i!==xe))for(l=i._ptLookup[i._targets.indexOf(r)],u=o._props.length;u--;)l[o._props[u]]=a;return o},er=function t(e,i,n){var r,s,o,a,l,u,h,c,d,f,p,m,g,v=e.vars,y=v.ease,x=v.startAt,_=v.immediateRender,b=v.lazy,w=v.onUpdate,S=v.runBackwards,C=v.yoyoEase,A=v.keyframes,T=v.autoRevert,P=e._dur,M=e._startAt,I=e._targets,O=e.parent,k=O&&"nested"===O.data?O.vars.targets:I,E="auto"===e._overwrite&&!he,R=e.timeline;if(R&&(!A||!y)&&(y="none"),e._ease=Vn(y,Me.ease),e._yEase=C?Nn(Vn(!0===C?y:C,Me.ease)):0,C&&e._yoyo&&!e._repeat&&(C=e._yEase,e._yEase=e._ease,e._ease=C),e._from=!R&&!!v.runBackwards,!R||A&&!v.stagger){if(m=(c=I[0]?xi(I[0]).harness:0)&&v[c.prop],r=Ri(v,hi),M&&(M._zTime<0&&M.progress(1),i<0&&S&&_&&!T?M.render(-1,!0):M.revert(S&&P?li:ai),M._lazy=0),x){if(Di(e._startAt=or.set(I,Oi({data:"isStart",overwrite:!1,parent:O,immediateRender:!0,lazy:!M&&Ve(b),startAt:null,delay:0,onUpdate:w&&function(){return bn(e,"onUpdate")},stagger:0},x))),e._startAt._dp=0,e._startAt._sat=e,i<0&&(ce||!_&&!T)&&e._startAt.revert(li),_&&P&&i<=0&&n<=0)return void(i&&(e._zTime=i))}else if(S&&P&&!M)if(i&&(_=!1),o=Oi({overwrite:!1,data:"isFromStart",lazy:_&&!M&&Ve(b),immediateRender:_,stagger:0,parent:O},r),m&&(o[c.prop]=m),Di(e._startAt=or.set(I,o)),e._startAt._dp=0,e._startAt._sat=e,i<0&&(ce?e._startAt.revert(li):e._startAt.render(-1,!0)),e._zTime=i,_){if(!i)return}else t(e._startAt,Oe,Oe);for(e._pt=e._ptCache=0,b=P&&Ve(b)||b&&!P,s=0;s<I.length;s++){if(h=(l=I[s])._gsap||yi(I)[s]._gsap,e._ptLookup[s]=f={},di[h.id]&&ci.length&&Ti(),p=k===I?s:k.indexOf(l),c&&!1!==(d=new c).init(l,m||r,e,p,k)&&(e._pt=a=new _r(e._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(t){f[t]=a})),d.priority&&(u=1)),!c||m)for(o in r)fi[o]&&(d=tr(o,r,e,p,l,k))?d.priority&&(u=1):f[o]=a=Jn.call(e,l,o,"get",r[o],p,k,0,v.stringFilter);e._op&&e._op[s]&&e.kill(l,e._op[s]),E&&e._pt&&(Kn=e,fe.killTweensOf(l,f,e.globalTime(i)),g=!e.parent,Kn=0),e._pt&&b&&(di[h.id]=1)}u&&xr(e),e._onInit&&e._onInit(e)}e._onUpdate=w,e._initted=(!e._op||e._pt)&&!g,A&&i<=0&&R.render(Ie,!0,!0)},ir=function(t,e,i,n){var r,s,o=e.ease||n||"power1.inOut";if(We(e))s=i[t]||(i[t]=[]),e.forEach((function(t,i){return s.push({t:i/(e.length-1)*100,v:t,e:o})}));else for(r in e)s=i[r]||(i[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:o})},nr=function(t,e,i,n,r){return Be(t)?t.call(e,i,n,r):De(t)&&~t.indexOf("random(")?yn(t):t},rr=vi+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",sr={};bi(rr+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return sr[t]=1}));var or=function(t){function e(e,i,n,r){var s;"number"==typeof i&&(n.duration=i,i=n,n=null);var o,a,l,u,h,c,d,f,p=(s=t.call(this,r?i:zi(i))||this).vars,m=p.duration,g=p.delay,v=p.immediateRender,y=p.stagger,x=p.overwrite,_=p.keyframes,b=p.defaults,w=p.scrollTrigger,S=p.yoyoEase,C=i.parent||fe,A=(We(e)||He(e)?Le(e[0]):"length"in i)?[e]:hn(e);if(s._targets=A.length?yi(A):ri("GSAP target "+e+" not found. https://gsap.com",!Pe.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=x,_||y||je(m)||je(g)){if(i=s.vars,(o=s.timeline=new qn({data:"nested",defaults:b||{},targets:C&&"nested"===C.data?C.vars.targets:A})).kill(),o.parent=o._dp=le(s),o._start=0,y||je(m)||je(g)){if(u=A.length,d=y&&fn(y),$e(y))for(h in y)~rr.indexOf(h)&&(f||(f={}),f[h]=y[h]);for(a=0;a<u;a++)(l=Ri(i,sr)).stagger=0,S&&(l.yoyoEase=S),f&&ki(l,f),c=A[a],l.duration=+nr(m,le(s),a,c,A),l.delay=(+nr(g,le(s),a,c,A)||0)-s._delay,!y&&1===u&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),o.to(c,l,d?d(a,c,A):0),o._ease=Un.none;o.duration()?m=g=0:s.timeline=0}else if(_){zi(Oi(o.vars.defaults,{ease:"none"})),o._ease=Vn(_.ease||i.ease||"none");var T,P,M,I=0;if(We(_))_.forEach((function(t){return o.to(A,t,">")})),o.duration();else{for(h in l={},_)"ease"===h||"easeEach"===h||ir(h,_[h],l,_.easeEach);for(h in l)for(T=l[h].sort((function(t,e){return t.t-e.t})),I=0,a=0;a<T.length;a++)(M={ease:(P=T[a]).e,duration:(P.t-(a?T[a-1].t:0))/100*m})[h]=P.v,o.to(A,M,I),I+=M.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==x||he||(Kn=le(s),fe.killTweensOf(A),Kn=0),Xi(C,le(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),(v||!m&&!_&&s._start===Si(C._time)&&Ve(v)&&Ni(le(s))&&"nested"!==C.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),w&&Yi(le(s),w),s}ue(e,t);var i=e.prototype;return i.render=function(t,e,i){var n,r,s,o,a,l,u,h,c,d=this._time,f=this._tDur,p=this._dur,m=t<0,g=t>f-Oe&&!m?f:t<Oe?0:t;if(p){if(g!==this._tTime||!t||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m){if(n=g,h=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+t,e,i);if(n=Si(g%o),g===f?(s=this._repeat,n=p):((s=~~(g/o))&&s===Si(g/o)&&(n=p,s--),n>p&&(n=p)),(l=this._yoyo&&1&s)&&(c=this._yEase,n=p-n),a=Vi(this._tTime,o),n===d&&!i&&this._initted&&s===a)return this._tTime=g,this;s!==a&&(h&&this._yEase&&$n(h,l),this.vars.repeatRefresh&&!l&&!this._lock&&this._time!==o&&this._initted&&(this._lock=i=1,this.render(Si(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(qi(this,m?t:n,i,e,g))return this._tTime=0,this;if(!(d===this._time||i&&this.vars.repeatRefresh&&s!==a))return this;if(p!==this._dur)return this.render(t,e,i)}if(this._tTime=g,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(c||this._ease)(n/p),this._from&&(this.ratio=u=1-u),n&&!d&&!e&&!s&&(bn(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(u,r.d),r=r._next;h&&h.render(t<0?t:h._dur*h._ease(n/this._dur),e,i)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&Li(this,t,0,i),bn(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&bn(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&Li(this,t,0,!0),(t||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&Di(this,1),e||m&&!d||!(g||d||l)||(bn(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,i,n){var r,s,o,a=t.ratio,l=e<0||!e&&(!t._start&&Ki(t)&&(t._initted||!Zi(t))||(t._ts<0||t._dp._ts<0)&&!Zi(t))?0:1,u=t._rDelay,h=0;if(u&&t._repeat&&(h=sn(0,t._tDur,e),s=Vi(h,u),t._yoyo&&1&s&&(l=1-l),s!==Vi(t._tTime,u)&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||ce||n||t._zTime===Oe||!e&&t._zTime){if(!t._initted&&qi(t,e,n,i,h))return;for(o=t._zTime,t._zTime=e||(i?Oe:0),i||(i=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=h,r=t._pt;r;)r.r(l,r.d),r=r._next;e<0&&Li(t,e,0,!0),t._onUpdate&&!i&&bn(t,"onUpdate"),h&&t._repeat&&!i&&t.parent&&bn(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&Di(t,1),i||ce||(bn(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,i);return this},i.targets=function(){return this._targets},i.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},i.resetTo=function(t,e,i,n,r){_e||zn.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||er(this,s),function(t,e,i,n,r,s,o,a){var l,u,h,c,d=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!d)for(d=t._ptCache[e]=[],h=t._ptLookup,c=t._targets.length;c--;){if((l=h[c][e])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Zn=1,t.vars[e]="+=0",er(t,o),Zn=0,a?ri(e+" not eligible for reset"):1;d.push(l)}for(c=d.length;c--;)(l=(u=d[c])._pt||u).s=!n&&0!==n||r?l.s+(n||0)+s*l.c:n,l.c=i-l.s,u.e&&(u.e=wi(i)+on(u.e)),u.b&&(u.b=l.s+on(u.b))}(this,t,e,i,n,this._ease(s/this._dur),s,r)?this.resetTo(t,e,i,n,1):(Hi(this,0),this.parent||Fi(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?wn(this):this;if(this.timeline){var i=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Kn&&!0!==Kn.vars.overwrite)._first||wn(this),this.parent&&i!==this.timeline.totalDuration()&&Qi(this,this._dur*this.timeline._tDur/i,0,1),this}var n,r,s,o,a,l,u,h=this._targets,c=t?hn(t):h,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var i=t.length,n=i===e.length;n&&i--&&t[i]===e[i];);return i<0}(h,c))return"all"===e&&(this._pt=0),wn(this);for(n=this._op=this._op||[],"all"!==e&&(De(e)&&(a={},bi(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var i,n,r,s,o=t[0]?xi(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(n in i=ki({},e),a)if(n in i)for(r=(s=a[n].split(",")).length;r--;)i[s[r]]=i[n];return i}(h,e)),u=h.length;u--;)if(~c.indexOf(h[u]))for(a in r=d[u],"all"===e?(n[u]=e,o=r,s={}):(s=n[u]=n[u]||{},o=e),o)(l=r&&r[a])&&("kill"in l.d&&!0!==l.d.kill(a)||Ui(this,l,"_pt"),delete r[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&f&&wn(this),this},e.to=function(t,i){return new e(t,i,arguments[2])},e.from=function(t,e){return nn(1,arguments)},e.delayedCall=function(t,i,n,r){return new e(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:i,onReverseComplete:i,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},e.fromTo=function(t,e,i){return nn(2,arguments)},e.set=function(t,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new e(t,i)},e.killTweensOf=function(t,e,i){return fe.killTweensOf(t,e,i)},e}(Yn);Oi(or.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),bi("staggerTo,staggerFrom,staggerFromTo",(function(t){or[t]=function(){var e=new qn,i=an.call(arguments,0);return i.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,i)}}));var ar=function(t,e,i){return t[e]=i},lr=function(t,e,i){return t[e](i)},ur=function(t,e,i,n){return t[e](n.fp,i)},hr=function(t,e,i){return t.setAttribute(e,i)},cr=function(t,e){return Be(t[e])?lr:Ne(t[e])&&t.setAttribute?hr:ar},dr=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},fr=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},pr=function(t,e){var i=e._pt,n="";if(!t&&e.b)n=e.b;else if(1===t&&e.e)n=e.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*t):Math.round(1e4*(i.s+i.c*t))/1e4)+n,i=i._next;n+=e.c}e.set(e.t,e.p,n,e)},mr=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},gr=function(t,e,i,n){for(var r,s=this._pt;s;)r=s._next,s.p===n&&s.modifier(t,e,i),s=r},vr=function(t){for(var e,i,n=this._pt;n;)i=n._next,n.p===t&&!n.op||n.op===t?Ui(this,n,"_pt"):n.dep||(e=1),n=i;return!e},yr=function(t,e,i,n){n.mSet(t,e,n.m.call(n.tween,i,n.mt),n)},xr=function(t){for(var e,i,n,r,s=t._pt;s;){for(e=s._next,i=n;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:r)?s._prev._next=s:n=s,(s._next=i)?i._prev=s:r=s,s=e}t._pt=n},_r=function(){function t(t,e,i,n,r,s,o,a,l){this.t=e,this.s=n,this.c=r,this.p=i,this.r=s||dr,this.d=o||this,this.set=a||ar,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,i){this.mSet=this.mSet||this.set,this.set=yr,this.m=t,this.mt=i,this.tween=e},t}();bi(vi+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return hi[t]=1})),ti.TweenMax=ti.TweenLite=or,ti.TimelineLite=ti.TimelineMax=qn,fe=new qn({sortChildren:!1,defaults:Me,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Pe.stringFilter=Rn;var br=[],wr={},Sr=[],Cr=0,Ar=0,Tr=function(t){return(wr[t]||Sr).map((function(t){return t()}))},Pr=function(){var t=Date.now(),e=[];t-Cr>2&&(Tr("matchMediaInit"),br.forEach((function(t){var i,n,r,s,o=t.queries,a=t.conditions;for(n in o)(i=pe.matchMedia(o[n]).matches)&&(r=1),i!==a[n]&&(a[n]=i,s=1);s&&(t.revert(),r&&e.push(t))})),Tr("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t,(function(e){return t.add(null,e)}))})),Cr=t,Tr("matchMedia"))},Mr=function(){function t(t,e){this.selector=e&&cn(e),this.data=[],this._r=[],this.isReverted=!1,this.id=Ar++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,i){Be(t)&&(i=e,e=t,t=Be);var n=this,r=function(){var t,r=de,s=n.selector;return r&&r!==n&&r.data.push(n),i&&(n.selector=cn(i)),de=n,t=e.apply(n,arguments),Be(t)&&n._r.push(t),de=r,n.selector=s,n.isReverted=!1,t};return n.last=r,t===Be?r(n,(function(t){return n.add(null,t)})):t?n[t]=r:r},e.ignore=function(t){var e=de;de=null,t(this),de=e},e.getTweens=function(){var e=[];return this.data.forEach((function(i){return i instanceof t?e.push.apply(e,i.getTweens()):i instanceof or&&!(i.parent&&"nested"===i.parent.data)&&e.push(i)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var i=this;if(t?function(){for(var e,n=i.getTweens(),r=i.data.length;r--;)"isFlip"===(e=i.data[r]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach((function(t){return n.splice(n.indexOf(t),1)})));for(n.map((function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-1/0,t}})).sort((function(t,e){return e.g-t.g||-1/0})).forEach((function(e){return e.t.revert(t)})),r=i.data.length;r--;)(e=i.data[r])instanceof qn?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof or)&&e.revert&&e.revert(t);i._r.forEach((function(e){return e(t,i)})),i.isReverted=!0}():this.data.forEach((function(t){return t.kill&&t.kill()})),this.clear(),e)for(var n=br.length;n--;)br[n].id===this.id&&br.splice(n,1)},e.revert=function(t){this.kill(t||{})},t}(),Ir=function(){function t(t){this.contexts=[],this.scope=t,de&&de.data.push(this)}var e=t.prototype;return e.add=function(t,e,i){$e(t)||(t={matches:t});var n,r,s,o=new Mr(0,i||this.scope),a=o.conditions={};for(r in de&&!o.selector&&(o.selector=de.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===r?s=1:(n=pe.matchMedia(t[r]))&&(br.indexOf(o)<0&&br.push(o),(a[r]=n.matches)&&(s=1),n.addListener?n.addListener(Pr):n.addEventListener("change",Pr));return s&&e(o,(function(t){return o.add(null,t)})),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),Or={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach((function(t){return Cn(t)}))},timeline:function(t){return new qn(t)},getTweensOf:function(t,e){return fe.getTweensOf(t,e)},getProperty:function(t,e,i,n){De(t)&&(t=hn(t)[0]);var r=xi(t||{}).get,s=i?Ii:Mi;return"native"===i&&(i=""),t?e?s((fi[e]&&fi[e].get||r)(t,e,i,n)):function(e,i,n){return s((fi[e]&&fi[e].get||r)(t,e,i,n))}:t},quickSetter:function(t,e,i){if((t=hn(t)).length>1){var n=t.map((function(t){return Rr.quickSetter(t,e,i)})),r=n.length;return function(t){for(var e=r;e--;)n[e](t)}}t=t[0]||{};var s=fi[e],o=xi(t),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var n=new s;xe._pt=0,n.init(t,i?e+i:e,xe,0,[t]),n.render(1,n),xe._pt&&mr(1,xe)}:o.set(t,a);return s?l:function(e){return l(t,a,i?e+i:e,o,1)}},quickTo:function(t,e,i){var n,r=Rr.to(t,ki(((n={})[e]="+=0.1",n.paused=!0,n),i||{})),s=function(t,i,n){return r.resetTo(e,t,i,n)};return s.tween=r,s},isTweening:function(t){return fe.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Vn(t.ease,Me.ease)),Ei(Me,t||{})},config:function(t){return Ei(Pe,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,n=t.plugins,r=t.defaults,s=t.extendTimeline;(n||"").split(",").forEach((function(t){return t&&!fi[t]&&!ti[t]&&ri(e+" effect requires "+t+" plugin.")})),pi[e]=function(t,e,n){return i(hn(t),Oi(e||{},r),n)},s&&(qn.prototype[e]=function(t,i,n){return this.add(pi[e](t,$e(i)?i:(n=i)&&{},this),n)})},registerEase:function(t,e){Un[t]=Vn(e)},parseEase:function(t,e){return arguments.length?Vn(t,e):Un},getById:function(t){return fe.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var i,n,r=new qn(t);for(r.smoothChildTiming=Ve(t.smoothChildTiming),fe.remove(r),r._dp=0,r._time=r._tTime=fe._time,i=fe._first;i;)n=i._next,!e&&!i._dur&&i instanceof or&&i.vars.onComplete===i._targets[0]||Xi(r,i,i._start-i._delay),i=n;return Xi(fe,r,0),r},context:function(t,e){return t?new Mr(t,e):de},matchMedia:function(t){return new Ir(t)},matchMediaRefresh:function(){return br.forEach((function(t){var e,i,n=t.conditions;for(i in n)n[i]&&(n[i]=!1,e=1);e&&t.revert()}))||Pr()},addEventListener:function(t,e){var i=wr[t]||(wr[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=wr[t],n=i&&i.indexOf(e);n>=0&&i.splice(n,1)},utils:{wrap:function t(e,i,n){var r=i-e;return We(e)?vn(e,t(0,e.length),i):rn(n,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,i,n){var r=i-e,s=2*r;return We(e)?vn(e,t(0,e.length-1),i):rn(n,(function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)}))},distribute:fn,random:gn,snap:mn,normalize:function(t,e,i){return xn(t,e,0,1,i)},getUnit:on,clamp:function(t,e,i){return rn(i,(function(i){return sn(t,e,i)}))},splitColor:Mn,toArray:hn,selector:cn,mapRange:xn,pipe:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(i){return t(parseFloat(i))+(e||on(i))}},interpolate:function t(e,i,n,r){var s=isNaN(e+i)?0:function(t){return(1-t)*e+t*i};if(!s){var o,a,l,u,h,c=De(e),d={};if(!0===n&&(r=1)&&(n=null),c)e={p:e},i={p:i};else if(We(e)&&!We(i)){for(l=[],u=e.length,h=u-2,a=1;a<u;a++)l.push(t(e[a-1],e[a]));u--,s=function(t){t*=u;var e=Math.min(h,~~t);return l[e](t-e)},n=i}else r||(e=ki(We(e)?[]:{},e));if(!l){for(o in i)Jn.call(d,e,o,"get",i[o]);s=function(t){return mr(t,d)||(c?e.p:e)}}}return rn(n,s)},shuffle:dn},install:ii,effects:pi,ticker:zn,updateRoot:qn.updateRoot,plugins:fi,globalTimeline:fe,core:{PropTween:_r,globals:si,Tween:or,Timeline:qn,Animation:Yn,getCache:xi,_removeLinkedListItem:Ui,reverting:function(){return ce},context:function(t){return t&&de&&(de.data.push(t),t._ctx=de),de},suppressOverwrites:function(t){return he=t}}};bi("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Or[t]=or[t]})),zn.add(qn.updateRoot),xe=Or.to({},{duration:0});var kr=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},Er=function(t,e){return{name:t,rawVars:1,init:function(t,i,n){n._onInit=function(t){var n,r;if(De(i)&&(n={},bi(i,(function(t){return n[t]=1})),i=n),e){for(r in n={},i)n[r]=e(i[r]);i=n}!function(t,e){var i,n,r,s=t._targets;for(i in e)for(n=s.length;n--;)(r=t._ptLookup[n][i])&&(r=r.d)&&(r._pt&&(r=kr(r,i)),r&&r.modifier&&r.modifier(e[i],t,s[n],i))}(t,i)}}}},Rr=Or.registerPlugin({name:"attr",init:function(t,e,i,n,r){var s,o,a;for(s in this.tween=i,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],n,r,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var i=e._pt;i;)ce?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},Er("roundProps",pn),Er("modifiers"),Er("snap",mn))||Or;or.version=qn.version=Rr.version="3.12.5",ve=1,Ge()&&Fn();Un.Power0,Un.Power1,Un.Power2,Un.Power3,Un.Power4,Un.Linear,Un.Quad,Un.Cubic,Un.Quart,Un.Quint,Un.Strong,Un.Elastic,Un.Back,Un.SteppedEase,Un.Bounce,Un.Sine,Un.Expo,Un.Circ;var zr,Fr,Ur,Dr,Br,Lr,Nr,$r,Vr={},Gr=180/Math.PI,jr=Math.PI/180,Hr=Math.atan2,Wr=/([A-Z])/g,Xr=/(left|right|width|margin|padding|x)/i,Yr=/[\s,\(]\S/,qr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Kr=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Zr=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Qr=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},Jr=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},ts=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},es=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},is=function(t,e,i){return t.style[e]=i},ns=function(t,e,i){return t.style.setProperty(e,i)},rs=function(t,e,i){return t._gsap[e]=i},ss=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},os=function(t,e,i,n,r){var s=t._gsap;s.scaleX=s.scaleY=i,s.renderTransform(r,s)},as=function(t,e,i,n,r){var s=t._gsap;s[e]=i,s.renderTransform(r,s)},ls="transform",us=ls+"Origin",hs=function t(e,i){var n=this,r=this.target,s=r.style,o=r._gsap;if(e in Vr&&s){if(this.tfm=this.tfm||{},"transform"===e)return qr.transform.split(",").forEach((function(e){return t.call(n,e,i)}));if(~(e=qr[e]||e).indexOf(",")?e.split(",").forEach((function(t){return n.tfm[t]=Ms(r,t)})):this.tfm[e]=o.x?o[e]:Ms(r,e),e===us&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(ls)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(us,i,"")),e=ls}(s||i)&&this.props.push(e,i,s[e])},cs=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},ds=function(){var t,e,i=this.props,n=this.target,r=n.style,s=n._gsap;for(t=0;t<i.length;t+=3)i[t+1]?n[i[t]]=i[t+2]:i[t+2]?r[i[t]]=i[t+2]:r.removeProperty("--"===i[t].substr(0,2)?i[t]:i[t].replace(Wr,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(t=Nr())&&t.isStart||r[ls]||(cs(r),s.zOrigin&&r[us]&&(r[us]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},fs=function(t,e){var i={target:t,props:[],revert:ds,save:hs};return t._gsap||Rr.core.getCache(t),e&&e.split(",").forEach((function(t){return i.save(t)})),i},ps=function(t,e){var i=Fr.createElementNS?Fr.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Fr.createElement(t);return i&&i.style?i:Fr.createElement(t)},ms=function t(e,i,n){var r=getComputedStyle(e);return r[i]||r.getPropertyValue(i.replace(Wr,"-$1").toLowerCase())||r.getPropertyValue(i)||!n&&t(e,vs(i)||i,1)||""},gs="O,Moz,ms,Ms,Webkit".split(","),vs=function(t,e,i){var n=(e||Br).style,r=5;if(t in n&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(gs[r]+t in n););return r<0?null:(3===r?"ms":r>=0?gs[r]:"")+t},ys=function(){"undefined"!=typeof window&&window.document&&(zr=window,Fr=zr.document,Ur=Fr.documentElement,Br=ps("div")||{style:{}},ps("div"),ls=vs(ls),us=ls+"Origin",Br.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$r=!!vs("perspective"),Nr=Rr.core.reverting,Dr=1)},xs=function t(e){var i,n=ps("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(Ur.appendChild(n),n.appendChild(this),this.style.display="block",e)try{i=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(i=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),Ur.removeChild(n),this.style.cssText=o,i},_s=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},bs=function(t){var e;try{e=t.getBBox()}catch(i){e=xs.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===xs||(e=xs.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+_s(t,["x","cx","x1"])||0,y:+_s(t,["y","cy","y1"])||0,width:0,height:0}},ws=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!bs(t))},Ss=function(t,e){if(e){var i,n=t.style;e in Vr&&e!==us&&(e=ls),n.removeProperty?("ms"!==(i=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty("--"===i?e:e.replace(Wr,"-$1").toLowerCase())):n.removeAttribute(e)}},Cs=function(t,e,i,n,r,s){var o=new _r(t._pt,e,i,0,1,s?es:ts);return t._pt=o,o.b=n,o.e=r,t._props.push(i),o},As={deg:1,rad:1,turn:1},Ts={grid:1,flex:1},Ps=function t(e,i,n,r){var s,o,a,l,u=parseFloat(n)||0,h=(n+"").trim().substr((u+"").length)||"px",c=Br.style,d=Xr.test(i),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,v="%"===r;if(r===h||!u||As[r]||As[h])return u;if("px"!==h&&!g&&(u=t(e,i,n,"px")),l=e.getCTM&&ws(e),(v||"%"===h)&&(Vr[i]||~i.indexOf("adius")))return s=l?e.getBBox()[d?"width":"height"]:e[p],wi(v?u/s*m:u/100*s);if(c[d?"width":"height"]=m+(g?h:r),o=~i.indexOf("adius")||"em"===r&&e.appendChild&&!f?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==Fr&&o.appendChild||(o=Fr.body),(a=o._gsap)&&v&&a.width&&d&&a.time===zn.time&&!a.uncache)return wi(u/a.width*m);if(!v||"height"!==i&&"width"!==i)(v||"%"===h)&&!Ts[ms(o,"display")]&&(c.position=ms(e,"position")),o===e&&(c.position="static"),o.appendChild(Br),s=Br[p],o.removeChild(Br),c.position="absolute";else{var y=e.style[i];e.style[i]=m+r,s=e[p],y?e.style[i]=y:Ss(e,i)}return d&&v&&((a=xi(o)).time=zn.time,a.width=o[p]),wi(g?s*u/m:s&&u?m/s*u:0)},Ms=function(t,e,i,n){var r;return Dr||ys(),e in qr&&"transform"!==e&&~(e=qr[e]).indexOf(",")&&(e=e.split(",")[0]),Vr[e]&&"transform"!==e?(r=Ls(t,n),r="transformOrigin"!==e?r[e]:r.svg?r.origin:Ns(ms(t,us))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||n||~(r+"").indexOf("calc("))&&(r=Es[e]&&Es[e](t,e,i)||ms(t,e)||_i(t,e)||("opacity"===e?1:0)),i&&!~(r+"").trim().indexOf(" ")?Ps(t,e,r,i)+i:r},Is=function(t,e,i,n){if(!i||"none"===i){var r=vs(e,t,1),s=r&&ms(t,r,1);s&&s!==i?(e=r,i=s):"borderColor"===e&&(i=ms(t,"borderTopColor"))}var o,a,l,u,h,c,d,f,p,m,g,v=new _r(this._pt,t.style,e,0,1,pr),y=0,x=0;if(v.b=i,v.e=n,i+="","auto"===(n+="")&&(c=t.style[e],t.style[e]=n,n=ms(t,e)||n,c?t.style[e]=c:Ss(t,e)),Rn(o=[i,n]),n=o[1],l=(i=o[0]).match(qe)||[],(n.match(qe)||[]).length){for(;a=qe.exec(n);)d=a[0],p=n.substring(y,a.index),h?h=(h+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(h=1),d!==(c=l[x++]||"")&&(u=parseFloat(c)||0,g=c.substr((u+"").length),"="===d.charAt(1)&&(d=Ci(u,d)+g),f=parseFloat(d),m=d.substr((f+"").length),y=qe.lastIndex-m.length,m||(m=m||Pe.units[e]||g,y===n.length&&(n+=m,v.e+=m)),g!==m&&(u=Ps(t,e,c,m)||0),v._pt={_next:v._pt,p:p||1===x?p:",",s:u,c:f-u,m:h&&h<4||"zIndex"===e?Math.round:0});v.c=y<n.length?n.substring(y,n.length):""}else v.r="display"===e&&"none"===n?es:ts;return Ze.test(n)&&(v.e=0),this._pt=v,v},Os={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ks=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i,n,r,s=e.t,o=s.style,a=e.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",n=1;else for(r=(a=a.split(",")).length;--r>-1;)i=a[r],Vr[i]&&(n=1,i="transformOrigin"===i?us:ls),Ss(s,i);n&&(Ss(s,ls),l&&(l.svg&&s.removeAttribute("transform"),Ls(s,1),l.uncache=1,cs(o)))}},Es={clearProps:function(t,e,i,n,r){if("isFromStart"!==r.data){var s=t._pt=new _r(t._pt,e,i,0,0,ks);return s.u=n,s.pr=-10,s.tween=r,t._props.push(i),1}}},Rs=[1,0,0,1,0,0],zs={},Fs=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Us=function(t){var e=ms(t,ls);return Fs(e)?Rs:e.substr(7).match(Ye).map(wi)},Ds=function(t,e){var i,n,r,s,o=t._gsap||xi(t),a=t.style,l=Us(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Rs:l:(l!==Rs||t.offsetParent||t===Ur||o.svg||(r=a.display,a.display="block",(i=t.parentNode)&&t.offsetParent||(s=1,n=t.nextElementSibling,Ur.appendChild(t)),l=Us(t),r?a.display=r:Ss(t,"display"),s&&(n?i.insertBefore(t,n):i?i.appendChild(t):Ur.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Bs=function(t,e,i,n,r,s){var o,a,l,u=t._gsap,h=r||Ds(t,!0),c=u.xOrigin||0,d=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,m=h[0],g=h[1],v=h[2],y=h[3],x=h[4],_=h[5],b=e.split(" "),w=parseFloat(b[0])||0,S=parseFloat(b[1])||0;i?h!==Rs&&(a=m*y-g*v)&&(l=w*(-g/a)+S*(m/a)-(m*_-g*x)/a,w=w*(y/a)+S*(-v/a)+(v*_-y*x)/a,S=l):(w=(o=bs(t)).x+(~b[0].indexOf("%")?w/100*o.width:w),S=o.y+(~(b[1]||b[0]).indexOf("%")?S/100*o.height:S)),n||!1!==n&&u.smooth?(x=w-c,_=S-d,u.xOffset=f+(x*m+_*v)-x,u.yOffset=p+(x*g+_*y)-_):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=S,u.smooth=!!n,u.origin=e,u.originIsAbsolute=!!i,t.style[us]="0px 0px",s&&(Cs(s,u,"xOrigin",c,w),Cs(s,u,"yOrigin",d,S),Cs(s,u,"xOffset",f,u.xOffset),Cs(s,u,"yOffset",p,u.yOffset)),t.setAttribute("data-svg-origin",w+" "+S)},Ls=function(t,e){var i=t._gsap||new Xn(t);if("x"in i&&!e&&!i.uncache)return i;var n,r,s,o,a,l,u,h,c,d,f,p,m,g,v,y,x,_,b,w,S,C,A,T,P,M,I,O,k,E,R,z,F=t.style,U=i.scaleX<0,D="px",B="deg",L=getComputedStyle(t),N=ms(t,us)||"0";return n=r=s=l=u=h=c=d=f=0,o=a=1,i.svg=!(!t.getCTM||!ws(t)),L.translate&&("none"===L.translate&&"none"===L.scale&&"none"===L.rotate||(F[ls]=("none"!==L.translate?"translate3d("+(L.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==L.rotate?"rotate("+L.rotate+") ":"")+("none"!==L.scale?"scale("+L.scale.split(" ").join(",")+") ":"")+("none"!==L[ls]?L[ls]:"")),F.scale=F.rotate=F.translate="none"),g=Ds(t,i.svg),i.svg&&(i.uncache?(P=t.getBBox(),N=i.xOrigin-P.x+"px "+(i.yOrigin-P.y)+"px",T=""):T=!e&&t.getAttribute("data-svg-origin"),Bs(t,T||N,!!T||i.originIsAbsolute,!1!==i.smooth,g)),p=i.xOrigin||0,m=i.yOrigin||0,g!==Rs&&(_=g[0],b=g[1],w=g[2],S=g[3],n=C=g[4],r=A=g[5],6===g.length?(o=Math.sqrt(_*_+b*b),a=Math.sqrt(S*S+w*w),l=_||b?Hr(b,_)*Gr:0,(c=w||S?Hr(w,S)*Gr+l:0)&&(a*=Math.abs(Math.cos(c*jr))),i.svg&&(n-=p-(p*_+m*w),r-=m-(p*b+m*S))):(z=g[6],E=g[7],I=g[8],O=g[9],k=g[10],R=g[11],n=g[12],r=g[13],s=g[14],u=(v=Hr(z,k))*Gr,v&&(T=C*(y=Math.cos(-v))+I*(x=Math.sin(-v)),P=A*y+O*x,M=z*y+k*x,I=C*-x+I*y,O=A*-x+O*y,k=z*-x+k*y,R=E*-x+R*y,C=T,A=P,z=M),h=(v=Hr(-w,k))*Gr,v&&(y=Math.cos(-v),R=S*(x=Math.sin(-v))+R*y,_=T=_*y-I*x,b=P=b*y-O*x,w=M=w*y-k*x),l=(v=Hr(b,_))*Gr,v&&(T=_*(y=Math.cos(v))+b*(x=Math.sin(v)),P=C*y+A*x,b=b*y-_*x,A=A*y-C*x,_=T,C=P),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,h=180-h),o=wi(Math.sqrt(_*_+b*b+w*w)),a=wi(Math.sqrt(A*A+z*z)),v=Hr(C,A),c=Math.abs(v)>2e-4?v*Gr:0,f=R?1/(R<0?-R:R):0),i.svg&&(T=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!Fs(ms(t,ls)),T&&t.setAttribute("transform",T))),Math.abs(c)>90&&Math.abs(c)<270&&(U?(o*=-1,c+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,c+=c<=0?180:-180)),e=e||i.uncache,i.x=n-((i.xPercent=n&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-n)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+D,i.y=r-((i.yPercent=r&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+D,i.z=s+D,i.scaleX=wi(o),i.scaleY=wi(a),i.rotation=wi(l)+B,i.rotationX=wi(u)+B,i.rotationY=wi(h)+B,i.skewX=c+B,i.skewY=d+B,i.transformPerspective=f+D,(i.zOrigin=parseFloat(N.split(" ")[2])||!e&&i.zOrigin||0)&&(F[us]=Ns(N)),i.xOffset=i.yOffset=0,i.force3D=Pe.force3D,i.renderTransform=i.svg?Xs:$r?Ws:Vs,i.uncache=0,i},Ns=function(t){return(t=t.split(" "))[0]+" "+t[1]},$s=function(t,e,i){var n=on(e);return wi(parseFloat(e)+parseFloat(Ps(t,"x",i+"px",n)))+n},Vs=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Ws(t,e)},Gs="0deg",js="0px",Hs=") ",Ws=function(t,e){var i=e||this,n=i.xPercent,r=i.yPercent,s=i.x,o=i.y,a=i.z,l=i.rotation,u=i.rotationY,h=i.rotationX,c=i.skewX,d=i.skewY,f=i.scaleX,p=i.scaleY,m=i.transformPerspective,g=i.force3D,v=i.target,y=i.zOrigin,x="",_="auto"===g&&t&&1!==t||!0===g;if(y&&(h!==Gs||u!==Gs)){var b,w=parseFloat(u)*jr,S=Math.sin(w),C=Math.cos(w);w=parseFloat(h)*jr,b=Math.cos(w),s=$s(v,s,S*b*-y),o=$s(v,o,-Math.sin(w)*-y),a=$s(v,a,C*b*-y+y)}m!==js&&(x+="perspective("+m+Hs),(n||r)&&(x+="translate("+n+"%, "+r+"%) "),(_||s!==js||o!==js||a!==js)&&(x+=a!==js||_?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Hs),l!==Gs&&(x+="rotate("+l+Hs),u!==Gs&&(x+="rotateY("+u+Hs),h!==Gs&&(x+="rotateX("+h+Hs),c===Gs&&d===Gs||(x+="skew("+c+", "+d+Hs),1===f&&1===p||(x+="scale("+f+", "+p+Hs),v.style[ls]=x||"translate(0, 0)"},Xs=function(t,e){var i,n,r,s,o,a=e||this,l=a.xPercent,u=a.yPercent,h=a.x,c=a.y,d=a.rotation,f=a.skewX,p=a.skewY,m=a.scaleX,g=a.scaleY,v=a.target,y=a.xOrigin,x=a.yOrigin,_=a.xOffset,b=a.yOffset,w=a.forceCSS,S=parseFloat(h),C=parseFloat(c);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=jr,f*=jr,i=Math.cos(d)*m,n=Math.sin(d)*m,r=Math.sin(d-f)*-g,s=Math.cos(d-f)*g,f&&(p*=jr,o=Math.tan(f-p),r*=o=Math.sqrt(1+o*o),s*=o,p&&(o=Math.tan(p),i*=o=Math.sqrt(1+o*o),n*=o)),i=wi(i),n=wi(n),r=wi(r),s=wi(s)):(i=m,s=g,n=r=0),(S&&!~(h+"").indexOf("px")||C&&!~(c+"").indexOf("px"))&&(S=Ps(v,"x",h,"px"),C=Ps(v,"y",c,"px")),(y||x||_||b)&&(S=wi(S+y-(y*i+x*r)+_),C=wi(C+x-(y*n+x*s)+b)),(l||u)&&(o=v.getBBox(),S=wi(S+l/100*o.width),C=wi(C+u/100*o.height)),o="matrix("+i+","+n+","+r+","+s+","+S+","+C+")",v.setAttribute("transform",o),w&&(v.style[ls]=o)},Ys=function(t,e,i,n,r){var s,o,a=360,l=De(r),u=parseFloat(r)*(l&&~r.indexOf("rad")?Gr:1)-n,h=n+u+"deg";return l&&("short"===(s=r.split("_")[1])&&(u%=a)!==u%180&&(u+=u<0?a:-360),"cw"===s&&u<0?u=(u+36e9)%a-~~(u/a)*a:"ccw"===s&&u>0&&(u=(u-36e9)%a-~~(u/a)*a)),t._pt=o=new _r(t._pt,e,i,n,u,Zr),o.e=h,o.u="deg",t._props.push(i),o},qs=function(t,e){for(var i in e)t[i]=e[i];return t},Ks=function(t,e,i){var n,r,s,o,a,l,u,h=qs({},i._gsap),c=i.style;for(r in h.svg?(s=i.getAttribute("transform"),i.setAttribute("transform",""),c[ls]=e,n=Ls(i,1),Ss(i,ls),i.setAttribute("transform",s)):(s=getComputedStyle(i)[ls],c[ls]=e,n=Ls(i,1),c[ls]=s),Vr)(s=h[r])!==(o=n[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(a=on(s)!==(u=on(o))?Ps(i,r,s,u):parseFloat(s),l=parseFloat(o),t._pt=new _r(t._pt,n,r,a,l-a,Kr),t._pt.u=u||0,t._props.push(r));qs(n,h)};bi("padding,margin,Width,Radius",(function(t,e){var i="Top",n="Right",r="Bottom",s="Left",o=(e<3?[i,n,r,s]:[i+s,i+n,r+n,r+s]).map((function(i){return e<2?t+i:"border"+i+t}));Es[e>1?"border"+t:t]=function(t,e,i,n,r){var s,a;if(arguments.length<4)return s=o.map((function(e){return Ms(t,e,i)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(n+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,r)}}));var Zs,Qs,Js,to={name:"css",register:ys,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,n,r){var s,o,a,l,u,h,c,d,f,p,m,g,v,y,x,_,b,w,S,C,A=this._props,T=t.style,P=i.vars.startAt;for(c in Dr||ys(),this.styles=this.styles||fs(t),_=this.styles.props,this.tween=i,e)if("autoRound"!==c&&(o=e[c],!fi[c]||!tr(c,e,i,n,t,r)))if(u=typeof o,h=Es[c],"function"===u&&(u=typeof(o=o.call(i,n,t,r))),"string"===u&&~o.indexOf("random(")&&(o=yn(o)),h)h(this,t,c,o,i)&&(x=1);else if("--"===c.substr(0,2))s=(getComputedStyle(t).getPropertyValue(c)+"").trim(),o+="",kn.lastIndex=0,kn.test(s)||(d=on(s),f=on(o)),f?d!==f&&(s=Ps(t,c,s,f)+f):d&&(o+=d),this.add(T,"setProperty",s,o,n,r,0,0,c),A.push(c),_.push(c,0,T[c]);else if("undefined"!==u){if(P&&c in P?(s="function"==typeof P[c]?P[c].call(i,n,t,r):P[c],De(s)&&~s.indexOf("random(")&&(s=yn(s)),on(s+"")||"auto"===s||(s+=Pe.units[c]||on(Ms(t,c))||""),"="===(s+"").charAt(1)&&(s=Ms(t,c))):s=Ms(t,c),l=parseFloat(s),(p="string"===u&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),c in qr&&("autoAlpha"===c&&(1===l&&"hidden"===Ms(t,"visibility")&&a&&(l=0),_.push("visibility",0,T.visibility),Cs(this,T,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==c&&"transform"!==c&&~(c=qr[c]).indexOf(",")&&(c=c.split(",")[0])),m=c in Vr)if(this.styles.save(c),g||((v=t._gsap).renderTransform&&!e.parseTransform||Ls(t,e.parseTransform),y=!1!==e.smoothOrigin&&v.smooth,(g=this._pt=new _r(this._pt,T,ls,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===c)this._pt=new _r(this._pt,v,"scaleY",v.scaleY,(p?Ci(v.scaleY,p+a):a)-v.scaleY||0,Kr),this._pt.u=0,A.push("scaleY",c),c+="X";else{if("transformOrigin"===c){_.push(us,0,T[us]),w=void 0,S=void 0,C=void 0,w=(b=o).split(" "),S=w[0],C=w[1]||"50%","top"!==S&&"bottom"!==S&&"left"!==C&&"right"!==C||(b=S,S=C,C=b),w[0]=Os[S]||S,w[1]=Os[C]||C,o=w.join(" "),v.svg?Bs(t,o,0,y,0,this):((f=parseFloat(o.split(" ")[2])||0)!==v.zOrigin&&Cs(this,v,"zOrigin",v.zOrigin,f),Cs(this,T,c,Ns(s),Ns(o)));continue}if("svgOrigin"===c){Bs(t,o,1,y,0,this);continue}if(c in zs){Ys(this,v,c,l,p?Ci(l,p+o):o);continue}if("smoothOrigin"===c){Cs(this,v,"smooth",v.smooth,o);continue}if("force3D"===c){v[c]=o;continue}if("transform"===c){Ks(this,o,t);continue}}else c in T||(c=vs(c)||c);if(m||(a||0===a)&&(l||0===l)&&!Yr.test(o)&&c in T)a||(a=0),(d=(s+"").substr((l+"").length))!==(f=on(o)||(c in Pe.units?Pe.units[c]:d))&&(l=Ps(t,c,s,f)),this._pt=new _r(this._pt,m?v:T,c,l,(p?Ci(l,p+a):a)-l,m||"px"!==f&&"zIndex"!==c||!1===e.autoRound?Kr:Jr),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=Qr);else if(c in T)Is.call(this,t,c,s,p?p+o:o);else if(c in t)this.add(t,c,s||t[c],p?p+o:o,n,r);else if("parseTransform"!==c){ni(c,o);continue}m||(c in T?_.push(c,0,T[c]):_.push(c,1,s||t[c])),A.push(c)}x&&xr(this)},render:function(t,e){if(e.tween._time||!Nr())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:Ms,aliases:qr,getSetter:function(t,e,i){var n=qr[e];return n&&n.indexOf(",")<0&&(e=n),e in Vr&&e!==us&&(t._gsap.x||Ms(t,"x"))?i&&Lr===i?"scale"===e?ss:rs:(Lr=i||{})&&("scale"===e?os:as):t.style&&!Ne(t.style[e])?is:~e.indexOf("-")?ns:cr(t,e)},core:{_removeProperty:Ss,_getMatrix:Ds}};Rr.utils.checkPrefix=vs,Rr.core.getStyleSaver=fs,Js=bi((Zs="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Qs="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){Vr[t]=1})),bi(Qs,(function(t){Pe.units[t]="deg",zs[t]=1})),qr[Js[13]]=Zs+","+Qs,bi("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");qr[e[1]]=Js[e[0]]})),bi("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){Pe.units[t]="px"})),Rr.registerPlugin(to);var eo,io,no,ro,so,oo,ao,lo,uo,ho=Rr.registerPlugin(to)||Rr,co=(ho.core.Tween,function(){return"undefined"!=typeof window}),fo=function(){return eo||co()&&(eo=window.gsap)&&eo.registerPlugin&&eo},po=function(t){return"function"==typeof t},mo=function(t){return console.warn(t)},go=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],vo=.212671,yo=.71516,xo=.072169,_o=function(t){return po(ro[t])?ro[t]:ro.filters[t]},bo=function(t,e){var i,n,r=[],s=0,o=0;for(i=0;i<4;i++){for(n=0;n<5;n++)o=4===n?t[s+4]:0,r[s+n]=t[s]*e[n]+t[s+1]*e[n+5]+t[s+2]*e[n+10]+t[s+3]*e[n+15]+o;s+=5}return r},wo=function(t,e){var i=1-e,n=i*vo,r=i*yo,s=i*xo;return bo([n+e,r,s,0,0,n,r+e,s,0,0,n,r,s+e,0,0,0,0,0,1,0],t)},So=function(t,e,i){var n=io(e),r=n[0]/255,s=n[1]/255,o=n[2]/255,a=1-i;return bo([a+i*r*vo,i*r*yo,i*r*xo,0,0,i*s*vo,a+i*s*yo,i*s*xo,0,0,i*o*vo,i*o*yo,a+i*o*xo,0,0,0,0,0,1,0],t)},Co=function(t,e){e*=Math.PI/180;var i=Math.cos(e),n=Math.sin(e);return bo([vo+i*(1-vo)+n*-vo,yo+i*-yo+n*-yo,xo+i*-xo+n*(1-xo),0,0,vo+i*-vo+.143*n,yo+.28484*i+.14*n,xo+i*-xo+-.283*n,0,0,vo+i*-vo+-.787329*n,yo+i*-yo+n*yo,xo+i*(1-xo)+n*xo,0,0,0,0,0,1,0,0,0,0,0,1],t)},Ao=function(t,e){return bo([e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0],t)},To=function(t,e){var i,n=_o(e),r=t.filters||[],s=r.length;for(n||mo(e+" not found. PixiPlugin.registerPIXI(PIXI)");--s>-1;)if(r[s]instanceof n)return r[s];return i=new n,"BlurFilter"===e&&(i.blur=0),r.push(i),t.filters=r,i},Po=function(t,e,i,n){e.add(i,t,i[t],n[t]),e._props.push(t)},Mo=function(t,e){var i=new(_o("ColorMatrixFilter"));return i.matrix=e,i.brightness(t,!0),i.matrix},Io={contrast:1,saturation:1,colorizeAmount:0,colorize:"rgb(255,255,255)",hue:0,brightness:1},Oo=function(t,e,i){var n,r,s,o=To(t,"ColorMatrixFilter"),a=t._gsColorMatrixFilter=t._gsColorMatrixFilter||function(t){var e,i={};for(e in t)i[e]=t[e];return i}(Io),l=e.combineCMF&&!("colorMatrixFilter"in e&&!e.colorMatrixFilter);s=o.matrix,e.resolution&&(o.resolution=e.resolution),e.matrix&&e.matrix.length===s.length?(r=e.matrix,1!==a.contrast&&Po("contrast",i,a,Io),a.hue&&Po("hue",i,a,Io),1!==a.brightness&&Po("brightness",i,a,Io),a.colorizeAmount&&(Po("colorize",i,a,Io),Po("colorizeAmount",i,a,Io)),1!==a.saturation&&Po("saturation",i,a,Io)):(r=go.slice(),null!=e.contrast?(r=Ao(r,+e.contrast),Po("contrast",i,a,e)):1!==a.contrast&&(l?r=Ao(r,a.contrast):Po("contrast",i,a,Io)),null!=e.hue?(r=Co(r,+e.hue),Po("hue",i,a,e)):a.hue&&(l?r=Co(r,a.hue):Po("hue",i,a,Io)),null!=e.brightness?(r=Mo(+e.brightness,r),Po("brightness",i,a,e)):1!==a.brightness&&(l?r=Mo(a.brightness,r):Po("brightness",i,a,Io)),null!=e.colorize?(e.colorizeAmount="colorizeAmount"in e?+e.colorizeAmount:1,r=So(r,e.colorize,e.colorizeAmount),Po("colorize",i,a,e),Po("colorizeAmount",i,a,e)):a.colorizeAmount&&(l?r=So(r,a.colorize,a.colorizeAmount):(Po("colorize",i,a,Io),Po("colorizeAmount",i,a,Io))),null!=e.saturation?(r=wo(r,+e.saturation),Po("saturation",i,a,e)):1!==a.saturation&&(l?r=wo(r,a.saturation):Po("saturation",i,a,Io))),n=r.length;for(;--n>-1;)r[n]!==s[n]&&i.add(s,n,s[n],r[n],"colorMatrixFilter");i._props.push("colorMatrixFilter")},ko=function(t,e){var i=e.t,n=e.p,r=e.color;(0,e.set)(i,n,r[0]<<16|r[1]<<8|r[2])},Eo=function(t,e){var i=e.g;i&&(i.dirty++,i.clearDirty++)},Ro=function(t,e){e.t.visible=!!e.t.alpha},zo=function(t,e,i,n){var r=t[e],s=io(po(r)?t[e.indexOf("set")||!po(t["get"+e.substr(3)])?e:"get"+e.substr(3)]():r),o=io(i);n._pt=new so(n._pt,t,e,0,0,ko,{t,p:e,color:s,set:oo(t,e)}),n.add(s,0,s[0],o[0]),n.add(s,1,s[1],o[1]),n.add(s,2,s[2],o[2])},Fo={tint:1,lineColor:1,fillColor:1},Uo="position,scale,skew,pivot,anchor,tilePosition,tileScale".split(","),Do={x:"position",y:"position",tileX:"tilePosition",tileY:"tilePosition"},Bo={colorMatrixFilter:1,saturation:1,contrast:1,hue:1,colorize:1,colorizeAmount:1,brightness:1,combineCMF:1},Lo=Math.PI/180,No=function(t){return"string"==typeof t},$o=function(t){return No(t)&&"="===t.charAt(1)?t.substr(0,2)+parseFloat(t.substr(2))*Lo:t*Lo},Vo=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e5*(e.s+e.c*t))/1e5,e)},Go=function(t,e,i,n,r,s){var o,a,l=360*(s?Lo:1),u=No(r),h=u&&"="===r.charAt(1)?+(r.charAt(0)+"1"):0,c=parseFloat(h?r.substr(2):r)*(s?Lo:1),d=h?c*h:c-n,f=n+d;return u&&("short"===(o=r.split("_")[1])&&(d%=l)!==d%(l/2)&&(d+=d<0?l:-l),"cw"===o&&d<0?d=(d+1e10*l)%l-~~(d/l)*l:"ccw"===o&&d>0&&(d=(d-1e10*l)%l-~~(d/l)*l)),t._pt=a=new so(t._pt,e,i,n,d,Vo),a.e=f,a},jo=function(){no||(eo=fo(),ro=no=ro||co()&&window.PIXI,ao=ro&&ro.VERSION&&"4"===ro.VERSION.charAt(0),io=function(t){return eo.utils.splitColor("0x"===(t+"").substr(0,2)?"#"+t.substr(2):t)})};for(lo=0;lo<Uo.length;lo++)uo=Uo[lo],Do[uo+"X"]=uo,Do[uo+"Y"]=uo;var Ho={version:"3.12.5",name:"pixi",register:function(t,e,i){eo=t,so=i,oo=e.getSetter,jo()},headless:!0,registerPIXI:function(t){ro=t},init:function(t,e,i,n,r){if(ro||jo(),!ro)return mo("PIXI was not found. PixiPlugin.registerPIXI(PIXI);"),!1;var s,o,a,l,u,h,c,d,f;for(h in e){if(s=Do[h],a=e[h],s)o=~h.charAt(h.length-1).toLowerCase().indexOf("x")?"x":"y",this.add(t[s],o,t[s][o],"skew"===s?$o(a):a,0,0,0,0,0,1);else if("scale"===h||"anchor"===h||"pivot"===h||"tileScale"===h)this.add(t[h],"x",t[h].x,a),this.add(t[h],"y",t[h].y,a);else if("rotation"===h||"angle"===h)Go(this,t,h,t[h],a,"rotation"===h);else if(Bo[h])l||(Oo(t,e.colorMatrixFilter||e,this),l=!0);else if("blur"===h||"blurX"===h||"blurY"===h||"blurPadding"===h){if(u=To(t,"BlurFilter"),this.add(u,h,u[h],a),0!==e.blurPadding)for(c=e.blurPadding||2*Math.max(u[h],a),d=t.filters.length;--d>-1;)t.filters[d].padding=Math.max(t.filters[d].padding,c)}else if(Fo[h])if(("lineColor"===h||"fillColor"===h)&&t instanceof ro.Graphics)for(f=(t.geometry||t).graphicsData,this._pt=new so(this._pt,t,h,0,0,Eo,{g:t.geometry||t}),d=f.length;--d>-1;)zo(ao?f[d]:f[d][h.substr(0,4)+"Style"],ao?h:"color",a,this);else zo(t,h,a,this);else"autoAlpha"===h?(this._pt=new so(this._pt,t,"visible",0,0,Ro),this.add(t,"alpha",t.alpha,a),this._props.push("alpha","visible")):"resolution"!==h&&this.add(t,h,"get",a);this._props.push(h)}}};fo()&&eo.registerPlugin(Ho);var Wo=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};ho.registerPlugin(Ho);class Xo{constructor(){}static get width(){return Xo._width}static get height(){return Xo._height}static get GameConfig(){return Xo.gameConfig}static set GameConfig(t){this.gameConfig=t}static set PlayerData(t){this.playerData=t}static get PlayerData(){return this.playerData}static initialize(t){return Wo(this,void 0,void 0,(function*(){var e;Xo.app=new p,yield Xo.app.init({resizeTo:window,background:t}),Ho.registerPIXI(Xo.app),Xo._width=Xo.app.screen.width,Xo._height=Xo.app.screen.height,null===(e=document.getElementById("_pixi-content"))||void 0===e||e.appendChild(Xo.app.canvas),window.addEventListener("resize",this.resize.bind(this)),Xo.app.ticker.add(Xo.update)}))}static resize(){const t=window.innerWidth,e=window.innerHeight,i=t<320?320/t:1,n=e<640?640/e:1,r=i>n?i:n;Xo._width=t*r,Xo._height=e*r,Xo._width=Xo._width>430?430:Xo._width,Xo._height=Xo._height>932?932:Xo._height,window.scrollTo(0,0),Xo.app.renderer.resize(Xo._width,Xo._height),console.log(`renderer resize to: ${Xo.width} ${Xo.height}`),Xo.currentScreen.resize()}static update(t){Xo.currentScreen&&Xo.currentScreen.update(t.deltaTime),Xo.currentPopup&&Xo.currentPopup.update(t.deltaTime),Xo.currentToast&&Xo.currentToast.update(t.deltaTime)}static changeScreen(t){Xo.currentScreen&&(Xo.app.stage.removeChild(Xo.currentScreen),Xo.currentScreen.destroy()),Xo.currentScreen=t,this.resize(),Xo.app.stage.addChild(Xo.currentScreen)}static popModal(t){Xo.currentScreen.interactiveChildren=!1,Xo.currentScreen.blur&&Xo.currentScreen.blur(),this.closeCurrentPopup(),Xo.currentPopup=t,Xo.app.stage.addChild(Xo.currentPopup)}static popToast(t){this.removeToast(),Xo.currentToast=t,Xo.app.stage.addChild(Xo.currentToast)}static removeToast(){var t;Xo.currentToast&&(Xo.app.stage.removeChild(Xo.currentToast),null===(t=Xo.currentToast)||void 0===t||t.destroy(),Xo.currentToast=void 0)}static closeCurrentPopup(){Xo.currentPopup&&(Xo.app.stage.removeChild(Xo.currentPopup),Xo.currentPopup.destroy(),Xo.currentPopup=void 0,Xo.currentScreen.interactiveChildren=!0,Xo.currentScreen.focus&&Xo.currentScreen.focus())}blur(){var t,e,i,n;null===(e=null===(t=Xo.currentScreen)||void 0===t?void 0:t.blur)||void 0===e||e.call(t),null===(n=null===(i=Xo.currentPopup)||void 0===i?void 0:i.blur)||void 0===n||n.call(i)}focus(){var t,e,i,n;null===(e=null===(t=Xo.currentScreen)||void 0===t?void 0:t.focus)||void 0===e||e.call(t),null===(n=null===(i=Xo.currentPopup)||void 0===i?void 0:i.focus)||void 0===n||n.call(i)}}const Yo={bundles:[{name:"common",assets:[{alias:"screaming_sheep",src:"./screaming_sheep.jpg"},{alias:"btn_normal",src:"./interactable/yellowBtnNormal.png"},{alias:"btn_pressed",src:"./interactable/yellowBtnTapped.png"},{alias:"btn_disabled",src:"./interactable/yellowBtnInactive.png"},{alias:"example_bg",src:"./BG.png"},{alias:"btn_blue",src:"./blueBG.png"},{alias:"border_circle",src:"./borderCircle.png"}]},{name:"animal_dices",assets:[{alias:"nai",src:"./baucua/nai.png"},{alias:"bau",src:"./baucua/bau.png"},{alias:"ga",src:"./baucua/ga.png"},{alias:"ca",src:"./baucua/ca.png"},{alias:"cua",src:"./baucua/cua.png"},{alias:"tom",src:"./baucua/tom.png"},{alias:"r_nai",src:"./bet_icons/dice/nai.png"},{alias:"r_bau",src:"./bet_icons/dice/bau.png"},{alias:"r_ga",src:"./bet_icons/dice/ga.png"},{alias:"r_ca",src:"./bet_icons/dice/ca.png"},{alias:"r_cua",src:"./bet_icons/dice/cua.png"},{alias:"r_tom",src:"./bet_icons/dice/tom.png"},{alias:"game_bg",src:"./baucua/BG.png"},{alias:"disk",src:"./bet_icons/disk.png"},{alias:"bowl",src:"./bet_icons/bowl.png"},{alias:"coin_yellow",src:"./bet_icons/coin_yellow.png"},{alias:"coin_default",src:"./bet_icons/coin_default.png"},{alias:"coin_default_frame",src:"./bet_icons/coin_default_frame.png"},{alias:"owner",src:"./bet_icons/owner.png"},{alias:"owner_2",src:"./bet_icons/owner_2.png"},{alias:"game_logo",src:"./baucua/KV.png"},{alias:"game_name",src:"./baucua/Game_Name.png"},{alias:"play_btn",src:"./baucua/Play_Button.png"},{alias:"leaderboard_btn",src:"./baucua/LeaderBoard_Button.png"},{alias:"mission_btn",src:"./baucua/Mission_Button.png"},{alias:"htp_btn",src:"./baucua/HTP_Button.png"},{alias:"add_coin_btn",src:"./baucua/Add_Coin_Button.png"},{alias:"setting_btn",src:"./baucua/Setting_Button.png"},{alias:"currency",src:"./baucua/Coin.png"},{alias:"check_in_btn",src:"./baucua/Checkin_Button.png"},{alias:"unselect_coin",src:"./baucua/unselect_coin.png"},{alias:"selected_coin",src:"./baucua/selected_coin.png"},{alias:"checkin_icon",src:"./baucua/Checkin_Icon.png"},{alias:"check_icon",src:"./baucua/Check.png"},{alias:"white_border_button",src:"./baucua/White_Border_Button.png"},{alias:"back_button",src:"./baucua/Back_Button.png"},{alias:"leader_cup",src:"./baucua/cup.png"},{alias:"vui_balance",src:"./baucua/vui_balance.png"},{alias:"package",src:"./baucua/package.png"},{alias:"vui_icon",src:"./baucua/vui_icon.png"},{alias:"close_modal",src:"./baucua/close_modal.png"},{alias:"Archia Medium",src:"./fonts/Archia-Medium.otf"}]}]},qo={width:301,height:112,texture:"btn_blue"};class Ko extends te.k{constructor(t={}){const e=Object.assign(Object.assign({},qo),t);super(new Jt({texture:x.g.from(e.texture),leftWidth:100,rightWidth:100,topHeight:100,bottomHeight:100,width:e.width,height:e.height}))}}let Zo;Zo="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};class Qo{constructor(){Qo.prototype.__init.call(this),Qo.prototype.__init2.call(this),Qo.prototype.__init3.call(this),Qo.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Qo._shared||(Qo._shared=new Qo),Qo._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Zo}getAll(){return Object.keys(this._tweens).map((t=>this._tweens[t]))}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(null==t&&(null==this._lastUpdateTime?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const i=Object.keys(this._tweens);if(0==i.length)return!1;for(let n=0;n<i.length;n++){const r=this._tweens[i[n]];r&&0==r.update(t,!0)&&!e&&delete this._tweens[i[n]]}return!0}}const Jo={Step:{None:t=>t<.5?0:1},Linear:{None:t=>t},Quadratic:{In:t=>t*t,Out:t=>t*(2-t),InOut:t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},Cubic:{In:t=>t*t*t,Out:t=>--t*t*t+1,InOut:t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},Quartic:{In:t=>t*t*t*t,Out:t=>1- --t*t*t*t,InOut:t=>(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},Quintic:{In:t=>t*t*t*t*t,Out:t=>--t*t*t*t*t+1,InOut:t=>(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},Sinusoidal:{In:t=>1-Math.cos(t*Math.PI/2),Out:t=>Math.sin(t*Math.PI/2),InOut:t=>.5*(1-Math.cos(Math.PI*t))},Exponential:{In:t=>0==t?0:Math.pow(1024,t-1),Out:t=>1==t?1:1-Math.pow(2,-10*t),InOut:t=>0==t?0:1==t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},Circular:{In:t=>1-Math.sqrt(1-t*t),Out:t=>Math.sqrt(1- --t*t),InOut:t=>(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},Elastic:{In:t=>0==t?0:1==t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI),Out:t=>0==t?0:1==t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1,InOut:t=>0==t?0:1==t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1},Back:{In(t){const e=1.70158;return t*t*((e+1)*t-e)},Out(t){const e=1.70158;return--t*t*((e+1)*t+e)+1},InOut(t){const e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:t=>1-Jo.Bounce.Out(1-t),Out:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,InOut:t=>t<.5?.5*Jo.Bounce.In(2*t):.5*Jo.Bounce.Out(2*t-1)+.5}},ta={Geom:{Linear(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.Linear;return e<0?s(t[0],t[1],n):e>1?s(t[i],t[i-1],i-n):s(t[r],t[r+1>i?i:r+1],n-r)},Bezier(t,e){let i=0;const n=t.length-1,r=Math.pow,s=ta.Utils.Bernstein;for(let o=0;o<=n;o++)i+=s(n,o)*r(1-e,n-o)*r(e,o)*t[o];return i},QuadraticBezier(t,e){let i=0;const n=t.length-1;if(1==e)return t[n];const r=Math.pow,s=ta.Utils.Bernstein,o=n*e,a=Math.floor(o),l=.5*(o-a)+a%2*.5,u=a-a%2,h=u+1,c=u+2;return i+=s(2,0)*r(1-l,2)*r(l,0)*t[u],i+=s(2,1)*r(1-l,1)*r(l,1)*t[h],i+=s(2,2)*r(1-l,0)*r(l,2)*t[c],i},CubicBezier(t,e){let i=0;const n=t.length-1;if(1==e)return t[n];const r=Math.pow,s=ta.Utils.Bernstein,o=n*e,a=Math.floor(o),l=1/3*(o-a)+1/3*(a%3),u=a-a%3,h=u+1,c=u+2,d=u+3;return i+=s(3,0)*r(1-l,3)*r(l,0)*t[u],i+=s(3,1)*r(1-l,2)*r(l,1)*t[h],i+=s(3,2)*r(1-l,1)*r(l,2)*t[c],i+=s(3,3)*r(1-l,0)*r(l,3)*t[d],i},CatmullRom(t,e){const i=t.length-1;let n=i*e,r=Math.floor(n);const s=ta.Utils.CatmullRom;return t[0]==t[i]?(e<0&&(r=Math.floor(n=i*(1+e))),s(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):e<0?t[0]-(s(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(s(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):s(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)}},Angle:{Radians(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.WrapLinear;return e<0?s(t[0],t[1],n,2*Math.PI):e>1?s(t[i],t[i-1],i-n,2*Math.PI):s(t[r],t[r+1>i?i:r+1],n-r,2*Math.PI)},Degrees(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.WrapLinear;return e<0?s(t[0],t[1],n,360):e>1?s(t[i],t[i-1],i-n,360):s(t[r],t[r+1>i?i:r+1],n-r,360)}},Color:{RGB(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.RGBLinear;return e<0?s(t[0],t[1],n):e>1?s(t[i],t[i-1],i-n):s(t[r],t[r+1>i?i:r+1],n-r)},HSV(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.HSVLinear;return e<0?s(t[0],t[1],n):e>1?s(t[i],t[i-1],i-n):s(t[r],t[r+1>i?i:r+1],n-r)},HCL(t,e){const i=t.length-1,n=i*e,r=Math.floor(n),s=ta.Utils.HCLLinear;return e<0?s(t[0],t[1],n):e>1?s(t[i],t[i-1],i-n):s(t[r],t[r+1>i?i:r+1],n-r)}},Utils:{RGBsplit:t=>({a:t>>24&255,r:t>>16&255,g:t>>8&255,b:255&t}),HSVsplit(t){const e=ta.Utils.RGBsplit(t);e.r/=255,e.g/=255,e.b/=255;const i=Math.max(e.r,e.g,e.b),n=Math.min(e.r,e.g,e.b);let r;const s=i,o=i-n,a=0==i?0:o/i;if(i==n)r=0;else{switch(i){case e.r:r=(e.g-e.b)/o+(e.g<e.b?6:0);break;case e.g:r=(e.b-e.r)/o+2;break;case e.b:r=(e.r-e.g)/o+4}r/=6}return{a:e.a,h:r,s:a,v:s}},HSVJoin(t){let e,i,n;const r=Math.floor(6*t.h),s=6*t.h-r,o=t.v*(1-t.s),a=t.v*(1-s*t.s),l=t.v*(1-(1-s)*t.s);switch(r%6){case 0:e=t.v,i=l,n=o;break;case 1:e=a,i=t.v,n=o;break;case 2:e=o,i=t.v,n=l;break;case 3:e=o,i=a,n=t.v;break;case 4:e=l,i=o,n=t.v;break;case 5:e=t.v,i=o,n=a}return t.a<<24|e<<16|i<<8|n},HCLSplit(t){const e=ta.Utils.RGBsplit(t),i={a:e.a,h:0,c:0,l:0};let n=0;const r=Math.min(e.r,Math.min(e.g,e.b)),s=Math.max(e.r,Math.max(e.g,e.b));let o=.03;return i.c=s-r,0!=i.c&&(n=Math.atan2(e.g-e.b,e.r-e.g)/Math.PI,o*=r/s),o=Math.exp(o),i.h=(n/2-Math.min(n%1,-n%1)/6)%1,i.c*=o,i.l=ta.Utils.Linear(-r,s,o)/1.060909067907034,i},HCLJoin(t){const e={a:t.a,r:0,g:0,b:0};if(0!=t.l){let i=t.h;const n=t.c,r=.530454533953517*t.l,s=Math.exp(.03*(1-n/(2*r))),o=(2*r-n)/(2*s-1),a=n/s,l=(i+Math.min(2*i%1/4,-2*i%1/8))*Math.PI*2;let u;i*=6,i<=.999?(u=Math.tan(l),e.r=1,e.g=u/(1+u)):i<=1.001?(e.r=1,e.g=1):i<=2?(u=Math.tan(l),e.r=(1+u)/u,e.g=1):i<=3?(u=Math.tan(l),e.g=1,e.b=1+u):i<=3.999?(u=Math.tan(l),e.g=1/(1+u),e.b=1):i<=4.001?(e.g=0,e.b=1):i<=5?(u=Math.tan(l),e.r=-1/u,e.b=1):(u=Math.tan(l),e.r=1,e.b=-u),e.r=e.r*a+o,e.g=e.g*a+o,e.b=e.b*a+o}return e.a<<24|e.r<<16|e.g<<8|e.b},WrapLinear(t,e,i,n){let r;return t=(t+n*Math.trunc(Math.abs(t/n)))%n,e=(e+n*Math.trunc(Math.abs(e/n)))%n,Math.abs(t-e)<=.5*n?r=ta.Utils.Linear(t,e,i):(r=t<e?ta.Utils.Linear(t+n,e,i):ta.Utils.Linear(t,e+n,i),r%=n),r},RGBLinear(t,e,i){const n=ta.Utils.RGBsplit(t),r=ta.Utils.RGBsplit(e);return ta.Utils.Linear(n.a,r.a,i)<<24|ta.Utils.Linear(n.r,r.r,i)<<16|ta.Utils.Linear(n.g,r.g,i)<<8|ta.Utils.Linear(n.b,r.b,i)},HSVLinear(t,e,i){const n=ta.Utils.HSVsplit(t),r=ta.Utils.HSVsplit(e);let s;Math.abs(n.h-r.h)<=.5?s=ta.Utils.Linear(n.h,r.h,i):(s=n.h<r.h?ta.Utils.Linear(n.h+1,r.h,i):ta.Utils.Linear(n.h,r.h+1,i),s%=1);const o=ta.Utils.Linear(n.s,r.s,i),a=ta.Utils.Linear(n.v,r.v,i),l=ta.Utils.Linear(n.a,r.a,i);return ta.Utils.HSVJoin({a:l,h:s,s:o,v:a})},HCLLinear(t,e,i){const n=ta.Utils.HCLSplit(t),r=ta.Utils.HCLSplit(e);let s;Math.abs(n.h-r.h)<=.5?s=ta.Utils.Linear(n.h,r.h,i):(s=n.h<r.h?ta.Utils.Linear(n.h+1,r.h,i):ta.Utils.Linear(n.h,r.h+1,i),s%=1);const o=ta.Utils.Linear(n.c,r.c,i),a=ta.Utils.Linear(n.l,r.l,i),l=ta.Utils.Linear(n.a,r.a,i);return ta.Utils.HSVJoin({a:l,h:s,s:o,v:a})},Linear:(t,e,i)=>(e-t)*i+t,Bernstein(t,e){const i=ta.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){const t=[1];return function(e){let i=1;if(t[e])return t[e];for(let t=e;t>1;t--)i*=t;return t[e]=i,i}}(),CatmullRom(t,e,i,n,r){const s=.5*(i-t),o=.5*(n-e),a=r*r;return(2*e-2*i+s+o)*(r*a)+(-3*e+3*i-2*s-o)*a+s*r+e}}};class ea{static __initStatic(){this._nextId=0}static nextId(){return ea._nextId++}}ea.__initStatic();const ia={safetyCheckFunction:t=>!0,easingFunction:Jo.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:ta.Geom.Linear};class na{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!=0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=ia.safetyCheckFunction}__init15(){this._easingFunction=ia.easingFunction}__init16(){this._yoyoEasingFunction=ia.yoyoEasingFunction}__init17(){this._interpolationFunction=ia.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=ea.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Qo.shared}set _group(t){this._groupRef=t}constructor(t,e){na.prototype.__init.call(this),na.prototype.__init2.call(this),na.prototype.__init3.call(this),na.prototype.__init4.call(this),na.prototype.__init5.call(this),na.prototype.__init6.call(this),na.prototype.__init7.call(this),na.prototype.__init8.call(this),na.prototype.__init9.call(this),na.prototype.__init10.call(this),na.prototype.__init11.call(this),na.prototype.__init12.call(this),na.prototype.__init13.call(this),na.prototype.__init14.call(this),na.prototype.__init15.call(this),na.prototype.__init16.call(this),na.prototype.__init17.call(this),na.prototype.__init18.call(this),na.prototype.__init19.call(this),na.prototype.__init20.call(this),na.prototype.__init21.call(this),na.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch(t){throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch(i){return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return void 0!==e&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,void 0!==e&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying||(null!=t&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1)),this}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,i,n,r){for(const s in i){const o=t[s],a=Array.isArray(o),l=!Number.isNaN(Number(o)),u=a?"array":typeof o,h="object"==u,c="object"==typeof i[s],d=!a&&Array.isArray(i[s]);"undefined"!=u&&"function"!=u&&null!=i[s]&&(a||l||h)&&((h||a||c)&&o&&!d?(void 0===e[s]&&(e[s]=a?[]:{}),void 0===n[s]&&(n[s]=a?[]:{}),this._setupProperties(o,e[s],i[s],n[s],r)):((void 0===e[s]||r)&&(e[s]=o),(void 0===n[s]||r)&&(n[s]=d?i[s].slice().reverse()[0]:e[s]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying||(this._isPaused=!0,this._group.remove(this)),this}resume(){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._group.add(this),this):this}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const i=this._internalUpdate(t);return i||e||this._group.remove(this),i}_internalUpdate(t){if(!this._safetyCheckFunction(this._object))return!1;if(this._isPaused)return!1;let e;t*=this._timescale,this._elapsedTime+=t;const i=this._duration,n=this._startTime+this._elapsedTime;if(n>i&&!this._isPlaying)return!1;this.isPlaying||this.start(),0==this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),0==this._onAfterDelayCallbackFired&&n>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=n/this._duration,0==this._duration&&(e=n>=0?1:0),e=Math.min(1,e),e=Math.max(0,e);let r=Number.isFinite(n)?n%this._duration:n;Number.isNaN(r)&&(r=0);const s=Math.floor(n/this._duration);let o;if(o=this._reversed&&this._yoyoEasingFunction?this._yoyoEasingFunction(e):this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&(1!=e||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),1==e){if(this._repeat-this._repeatCount>0){const t=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+s),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||r<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),void 0!==this._repeatDelayTime?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let e=1;Number.isFinite(s)?e=this._repeatCount-t:Number.isFinite(this._repeat)&&(e=this._repeat-t);for(let i=0;i<e;i++)this._onRepeatCallback(this._object,t+1+i,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return r>0&&Number.isFinite(this._repeat)&&this._internalUpdate(r),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].start(),r>0&&this._chainedTweens[t].update(r);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,i,n){for(const r in i){if(null==e[r])continue;const s=e[r];let o=i[r];const a=Array.isArray(t[r]),l=Array.isArray(o);!a&&l?this._reversed?t[r]=this._interpolationFunction(o.concat([s]),n):t[r]=this._interpolationFunction([s].concat(o),n):"object"==typeof o&&o?this._updateProperties(t[r],s,o,n):(o=this._handleRelativeValue(s,o),"number"!=typeof o||"number"!=typeof s&&"string"!=typeof s||(t[r]=Number(s)+(o-Number(s))*n,"string"==typeof s&&(t[r]=String(t[r]))))}}_handleRelativeValue(t,e){return"string"!=typeof e?e:"+"==e.charAt(0)||"-"==e.charAt(0)?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const i in t){const n=!Array.isArray(t[i])&&Array.isArray(e[i]);if("object"==typeof t[i])this._swapEndStartRepeatValues(t[i],e[i]);else{const r=t[i];if("string"==typeof e[i])t[i]=Number(t[i])+Number(e[i]),e[i]=r;else if(n){const n=e[i].slice().reverse();t[i]=n[0],e[i]=n}else t[i]=e[i],e[i]=r}}}_moveForwardStartRepeatValues(t,e){for(const i in t)"object"==typeof e[i]?this._moveForwardStartRepeatValues(t[i],e[i]):"string"==typeof e[i]&&(t[i]=Number(t[i])+Number(e[i]))}}var ra=r(1852),sa=Object.defineProperty,oa=(t,e,i)=>(((t,e,i)=>{e in t?sa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class aa{constructor(){oa(this,"_isMouseIn"),oa(this,"_isDown"),oa(this,"onDown"),oa(this,"onUp"),oa(this,"onUpOut"),oa(this,"onOut"),oa(this,"onPress"),oa(this,"onHover"),this.onPress=new ra.HN,this.onDown=new ra.HN,this.onUp=new ra.HN,this.onHover=new ra.HN,this.onOut=new ra.HN,this.onUpOut=new ra.HN}connectEvents(t){oe.F.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){oe.F.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){oe.F.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var la=Object.defineProperty,ua=(t,e,i)=>(((t,e,i)=>{e in t?la(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class ha extends aa{constructor(t){super(),ua(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){!!this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){this.view?(this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()):console.error("Button view is not set. Please set it before enabling the button.")}get enabled(){return"static"===this.view.eventMode}}class ca extends h.mc{constructor(t){super(),ua(this,"button"),ua(this,"onDown"),ua(this,"onUp"),ua(this,"onUpOut"),ua(this,"onOut"),ua(this,"onPress"),ua(this,"onHover"),this.button=new ha(this),this.button.enabled=!0,t&&this.addChild(t),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(t){this.button.enabled=t}get enabled(){return this.button.enabled}}function da(t,e,i=0,n=!0){let r=e.scale.x,s=e.scale.y;if(!t)throw new Error("Parent is not defined");const o=t.width-2*i,a=t.height-2*i,l=o-Math.round(e.width),u=a-Math.round(e.height);if(l<0&&(r=o/(e.width/r)),u<0&&(s=a/(e.height/s)),r<=0||s<=0)e.scale.set(0);else if(n||e.scale.x===e.scale.y){const t=Math.min(r,s);e.scale.set(t,t)}else{const t=e.scale.x/e.scale.y;l<u?e.scale.set(r,r/t):e.scale.set(s*t,s)}}function fa(t){return"string"==typeof t?te.k.from(t):t}var pa=Object.defineProperty,ma=(t,e,i)=>(((t,e,i)=>{e in t?pa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class ga extends ca{constructor(t){super(),ma(this,"animations"),ma(this,"originalInnerViewState"),ma(this,"defaultDuration",100),ma(this,"options"),ma(this,"_padding"),ma(this,"_offset"),ma(this,"_textOffset"),ma(this,"iconOffset"),ma(this,"innerView",new h.mc),ma(this,"_views",{}),ma(this,"state"),ma(this,"anchor"),ma(this,"_defaultTextScale",{x:1,y:1}),ma(this,"_defaultIconScale",{x:1,y:1}),ma(this,"_defaultTextAnchor",{x:.5,y:.5}),ma(this,"_defaultIconAnchor",{x:.5,y:.5}),this.options=t??{};const{defaultView:e,hoverView:i,pressedView:n,disabledView:r,text:s,padding:o,offset:a,textOffset:l,iconOffset:u,defaultTextScale:c,defaultIconScale:d,defaultTextAnchor:f,defaultIconAnchor:p,scale:m,anchor:g,anchorX:v,anchorY:y,icon:x,animations:_}=t??{};this.addChild(this.innerView),this.anchor=new Ht.o({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(v??g??0,y??g??0),this.padding=o??0,this.offset=a,this.textOffset=l,this.iconOffset=u,this.defaultTextScale=c,this.defaultIconScale=d,this.defaultTextAnchor=f,this.defaultIconAnchor=p,this.scale.set(m??1),_&&(this.animations=_,se.R.shared.add((()=>Qo.shared.update()))),this.setState("default"),this.defaultView=e,this.hoverView=i,this.pressedView=n,this.disabledView=r,this.text=s,this.iconView=x,this.initStateControl()}set text(t){t&&0!==t?this._views.textView?this._views.textView.text=t.toString():this.createTextView(t):this.removeView("textView")}get text(){return this._views.textView?.text}set enabled(t){this.button.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.button.enabled}setState(t,e=!1){if(!e&&this.state===t)return;const i=this.getStateView(this.state);i&&(i.visible=!1),this.state=t;const n=this.getStateView(t);n&&(this.setOffset(n,t,this.offset),n.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){if(this._views.textView=function(t){return"string"==typeof t||"number"==typeof t?new re({text:String(t)}):t}(t),void 0===this.options?.defaultTextScale){const{x:t,y:e}=this._views.textView.scale;this._defaultTextScale={x:t,y:e}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(t,e,i){const n=i?i[e]:{x:0,y:0},r=i?.default;n?(t.x+=n.x??0,t.y+=n.y??0):r?(t.x+=r.x??0,t.y+=r.y??0):(i.x||i.y)&&(t.x+=i.x??0,t.y+=i.y??0)}getStateView(t){if(this._views)switch(t){case"hover":return this._views.hoverView??this._views.defaultView??void 0;case"pressed":return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case"disabled":return this._views.disabledView??this._views.defaultView??void 0;case"default":return this._views.defaultView??void 0;default:return}}adjustTextView(t){if(!this.text)return;const e=this.getStateView(this.state),{x:i,y:n}=this._defaultTextAnchor;e&&(this.options?.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),da(e,this._views.textView,this.padding,!1),this._views.textView.x=e.x+e.width/2,this._views.textView.y=e.y+e.height/2),this._views.textView.anchor.set(i,n),this.setOffset(this._views.textView,t,this.textOffset)}adjustIconView(t){if(!this._views.iconView)return;const e=this.getStateView(t);if(!e)return;this.options?.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y);const{x:i,y:n}=this._defaultIconAnchor;da(e,this._views.iconView,this.padding,!1),"anchor"in this._views.iconView?this._views.iconView.anchor.set(i,n):this._views.iconView.pivot.set(i*(this._views.iconView.width/this._views.iconView.scale.x),n*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=e.x+e.width/2,this._views.iconView.y=e.y+e.height/2,this.setOffset(this._views.iconView,t,this.iconOffset)}updateAnchor(){if(!this._views)return;const t=this.anchor.x??0,e=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach((i=>{i&&(i.anchor?.set(0),i.x=-i.width*t,i.y=-i.height*e)})),this._views.defaultView){const{x:t,y:e,width:i,height:n}=this._views.defaultView;this.hitArea=new y.M(t,e,i,n)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set defaultView(t){this.updateView("defaultView",t)}get defaultView(){return this._views.defaultView}set hoverView(t){this.updateView("hoverView",t),this._views.hoverView&&"hover"!==this.state&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(t){this.updateView("pressedView",t),this._views.pressedView&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(t){this.updateView("disabledView",t),this._views.disabledView&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(t,e){void 0!==e&&(this.removeView(t),null!==e&&(this.options?.nineSliceSprite&&("string"==typeof e?this._views[t]=new Jt({texture:x.g.from(e),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn("NineSliceSprite can not be used with views set as Container.")),this._views[t]||(this._views[t]=fa(e)),this.setOffset(this._views[t],this.state,this.offset),this._views[t].parent||this.innerView.addChild(this._views[t]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0)))}removeView(t){this._views[t]&&(this.innerView.removeChild(this._views[t]),this._views[t]=null)}set textView(t){void 0!==t&&(this.removeView("textView"),null!==t&&this.createTextView(t))}get textView(){return this._views.textView}set iconView(t){if(void 0!==t&&(this.removeView("iconView"),null!==t)){if(this._views.iconView=fa(t),void 0===this.options?.defaultIconScale){const{x:t,y:e}=this._views.iconView.scale;this._defaultIconScale={x:t,y:e}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(t){if(!this.animations)return;if("default"===t&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const t=this.animations?.default;if(t)return this.innerView.x=t.props.x??this.originalInnerViewState.x,this.innerView.y=t.props.y??this.originalInnerViewState.y,this.innerView.width=t.props.width??this.originalInnerViewState.width,this.innerView.height=t.props.height??this.originalInnerViewState.height,this.innerView.scale.x=t.props.scale.x??this.originalInnerViewState.scale.x,void(this.innerView.scale.y=t.props.scale.y??this.originalInnerViewState.scale.y)}const e=this.animations[t]??this.animations.default;if(e){const t=e;return this.defaultDuration=t.duration,void new na(this.innerView).to(t.props,t.duration).start()}new na(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}initStateControl(){this.onDown.connect((()=>{this.setState("pressed")})),this.onUp.connect((()=>{oe.F.any?this.setState("default"):this.setState("hover")})),this.onUpOut.connect((()=>{this.setState("default")})),this.onOut.connect((()=>{this.button.isDown||this.setState("default")})),this.onPress.connect((()=>{oe.F.any?this.setState("default"):this.setState("hover")})),this.onHover.connect((()=>{this.button.isDown||(oe.F.any?this.setState("default"):this.setState("hover"))}))}set padding(t){this._padding=t,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(t){this._offset=t,this.updateAnchor()}get offset(){return this._offset}set textOffset(t){this._textOffset=t,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(t){if(void 0===t)return;this.options.defaultTextScale=t;const e="number"==typeof t;this._defaultTextScale.x=e?t:t.x??1,this._defaultTextScale.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(t){if(void 0===t)return;this.options.defaultIconScale=t;const e="number"==typeof t;this._defaultIconScale.x=e?t:t.x??1,this._defaultIconScale.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(t){if(void 0===t)return;this.options.defaultTextAnchor=t;const e="number"==typeof t;this._defaultTextAnchor.x=e?t:t.x??1,this._defaultTextAnchor.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(t){if(void 0===t)return;this.options.defaultIconAnchor=t;const e="number"==typeof t;this._defaultIconAnchor.x=e?t:t.x??1,this._defaultIconAnchor.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(t){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=t),this._views.hoverView&&(this._views.hoverView.width=t),this._views.pressedView&&(this._views.pressedView.width=t),this._views.disabledView&&(this._views.disabledView.width=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=t}get width(){return super.width}set height(t){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=t),this._views.hoverView&&(this._views.hoverView.height=t),this._views.pressedView&&(this._views.pressedView.height=t),this._views.disabledView&&(this._views.disabledView.height=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=t}get height(){return super.height}setSize(t,e){this.options?.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(t,e),this._views.hoverView&&this._views.hoverView.setSize(t,e),this._views.pressedView&&this._views.pressedView.setSize(t,e),this._views.disabledView&&this._views.disabledView.setSize(t,e),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(t,e)}}const va={fontFamily:"Arial Rounded MT Bold",align:"center"};class ya extends re{constructor(t,e){super({text:t,style:e=Object.assign(Object.assign({},va),e)}),this.anchor.set(.5)}}const xa={text:"",fontFamily:"Archia Medium",fill:4868682,fontSize:15,width:301,height:112,texture:"btn_normal",icon:"",iconSize:0,offsetSlides:[0,0,0,0],onClick:()=>{}};class _a extends ga{constructor(t={}){const e=Object.assign(Object.assign({},xa),t);super({defaultView:new Jt({texture:x.g.from(e.texture),leftWidth:e.offsetSlides[0],rightWidth:e.offsetSlides[1],topHeight:e.offsetSlides[2],bottomHeight:e.offsetSlides[3],width:e.width,height:e.height}),anchor:.5,animations:{pressed:{props:{scale:{x:.95,y:.95},y:0},duration:.1}}}),this.width=e.width,this.height=e.height,this.onClick=e.onClick,e.text&&(this.messageLabel=new ya(e.text,{fontFamily:e.fontFamily,fill:e.fill,fontSize:e.fontSize}),this.messageLabel.anchor.set(.5),this.messageLabel.position.set(0,-e.height/6),this.addChild(this.messageLabel)),e.icon&&this.messageLabel&&(this.icon=te.k.from(e.icon),e.text&&(this.icon.position.set(this.messageLabel.x-this.messageLabel.width/2-10,-e.height/6),this.icon.anchor.set(1,.5),this.icon.width=e.iconSize,this.icon.height=e.iconSize,this.addChild(this.icon))),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this))}handleDown(){var t;if(null===(t=this.messageLabel)||void 0===t||t.scale.set(.9),this.icon){const t=this.icon.scale.x;this.icon.scale.set(t-.1)}}handleUp(){var t;if(null===(t=this.messageLabel)||void 0===t||t.scale.set(1),this.icon){const t=this.icon.scale.x;this.icon.scale.set(t+.1)}null!=this.onClick&&this.onClick()}}class ba extends h.mc{constructor(t,e){super(),this._isSelected=!1,this._iconName=t.icon||"coin",this._id=t.value,this._background=te.k.from(`unselect_${this._iconName}`),this._background.width=60,this._background.height=60,this._background.anchor.set(.5),t.color&&(this._background.tint=t.color);const i=new re({text:t.label,style:{fontFamily:"Archia Medium",fontSize:18,align:"center",fill:"#FFD85D"}});i.anchor.set(.5),this._background.on("pointerdown",(i=>{e.onSelectedDefaultBet(t.value,this.getGlobalPosition())})),this._background.eventMode="static",this.addChild(this._background),this.addChild(i)}onSelect(){this._background.texture=x.g.from(`selected_${this._iconName}`),this._isSelected=!0,this.scale.set(1.2)}onUnSelect(){this._background.texture=x.g.from(`unselect_${this._iconName}`),this._isSelected=!1,this.scale.set(1)}}class wa extends h.mc{constructor(t,e){super(),this.values=[];for(let i=0;i<e.length;i++){const n=new ba(e[i],t);this.values.push(n),n.position.y=Xo.height/1.6;const r=Xo.width/e.length;n.position.x=i*r+r/2,this.addChild(n)}}selectBetValue(t){for(let e=0;e<this.values.length;e++)this.values[e]._id===t?this.values[e].onSelect():this.values[e].onUnSelect()}}var Sa;!function(t){t[t.ReadyToShake=0]="ReadyToShake",t[t.MakeFirstBet=1]="MakeFirstBet",t[t.Betting=2]="Betting",t[t.OpeningBet=3]="OpeningBet",t[t.ShowResult=4]="ShowResult"}(Sa||(Sa={}));function Ca(t,e,i=Math.random){const n=Math.min(t,e);return n+(Math.max(t,e)-n)*i()}class Aa extends h.mc{constructor(){super(),this.dice_strings=[],this.diceUI=new re({text:this.dice(),style:{fontFamily:"Archia Medium",fill:"gold",fontSize:30,stroke:{color:"black",width:8},align:"center"}}),this.addChild(this.diceUI),this.spriteUI=te.k.from("btn_pressed"),this.spriteUI.width=100,this.spriteUI.height=100,this.spriteUI.anchor.set(0,0),this.addChild(this.spriteUI),this.dice_strings=["nai","bau","ga","ca","cua","tom"],this.updateDice(this.dice())}dice(){return this.dice_strings[Math.floor(Ca(0,6))]}updateDice(t){this.diceUI.position.set(17,50),this.diceUI.scale.set(1,.1),this.spriteUI.texture=x.g.from(`r_${t}`)}showResult(t){t?(this.diceUI.text=t,this.diceUI.style.fill="gold"):(this.diceUI.text="+ 0",this.diceUI.style.fill="red"),this.diceUI.visible=!0,Rr.to(this.diceUI.position,{x:17,y:-50,duration:.5,ease:"bounce.out",delay:.5}),Rr.to(this.diceUI.scale,{x:1,y:1,duration:.5,ease:"bounce.out",delay:.5})}}class Ta extends h.mc{constructor(t,e="yellow"){super();const i=te.k.from("unselect_coin");i.width=50,i.height=50;const n=new re({text:t,style:{fontFamily:"Archia Medium",fontSize:15,align:"center",fill:"#FFD85D"}});n.anchor.set(.5),n.position.set(25,25),this.coinState=Pa.INBET,this.addChild(i),this.addChild(n)}}var Pa;!function(t){t[t.INBET=0]="INBET",t[t.WIN=1]="WIN",t[t.LOSE=2]="LOSE",t[t.MOVING=3]="MOVING"}(Pa||(Pa={}));class Ma extends te.k{constructor(t){super(x.g.from("bowl")),this.isOpen=!1,this.eslapseTime=0,this.startPosition=new Wt.b,this.endPosition=new Wt.b,this.prevPosition=new Wt.b,this.context=t,this.width=360,this.height=300,this.position.set(Xo.width/2,Xo.height/5),this.anchor.set(.5),this.visible=!1,this.eventMode="static",this.on("pointerdown",this.onDragStart,this),this.on("pointerup",this.onDragEnd,this)}onDragMove(t){const e=t.client.x-this.prevPosition.x,i=t.client.y-this.prevPosition.y;this.position.x+=e,this.position.y+=i,this.prevPosition=new Wt.b(t.client.x,t.client.y),(Math.abs(this.startPosition.x-t.client.x)>100||Math.abs(this.startPosition.y-t.client.y)>100)&&this.onDragEnd(t)}onDragStart(t){0==this.isOpen&&this.context.canOpenBowl()&&(this.context.updateBetResult(this),this.startPosition.set(t.client.x,t.client.y),this.prevPosition=new Wt.b(t.client.x,t.client.y),this.isOpen=!0,this.on("pointermove",this.onDragMove,this))}onDragEnd(t){console.log("end drag"),this.isOpen&&(this.interactive=!1,this.isOpen=!1,this.endPosition.set(t.client.x,t.client.y),this.off("pointermove",this.onDragMove,this),ho.to(this,{x:this.startPosition.x>this.endPosition.x?-50:Xo.width+50,y:this.startPosition.y>this.endPosition.y?-50:Xo.height/2+50,onComplete:()=>{this.context.processCoinAnimation(),this.visible=!1}}))}}class Ia extends h.mc{constructor(t){super(),this.betDice_1=null,this.betDice_2=null,this.betDice_3=null,this.betDice_1=new Aa,this.betDice_1.position.set(Xo.width/2-25-80,Xo.height/6),this.betDice_2=new Aa,this.betDice_2.position.set(Xo.width/2-25+50,Xo.height/6),this.betDice_3=new Aa,this.betDice_3.position.set(Xo.width/2-25-10,Xo.height/6+30);new ne.x({fontFamily:"Archia Medium",fontSize:30,fontWeight:"bold",fill:"gold",stroke:{color:"#4a1850",width:5,join:"round"},dropShadow:{color:"#000000",blur:4,angle:Math.PI/3,distance:3},wordWrap:!0,wordWrapWidth:440});const e=new Ta("","yellow");e.width=30,e.height=30,e.position.y=Xo.height/2,e.position.x=10,this.betTimesUI=new re({text:`Lt t cn li: ${t.betTime}`,style:{fontFamily:"Archia Medium",fontSize:18}}),this.betTimesUI.y=Xo.height/2+10,this.betTimesUI.x=Xo.width/2-this.betTimesUI.width/2,this.addChild(this.betTimesUI),this.diskUI=te.k.from("disk"),this.diskUI.width=360,this.diskUI.height=300,this.diskUI.anchor.set(.5),this.diskUI.position.set(Xo.width/2,Xo.height/4),this.bowl=new Ma(t),this.shakingContainer=new h.mc,this.shakingContainer.addChild(this.diskUI),this.shakingContainer.addChild(this.betDice_1),this.shakingContainer.addChild(this.betDice_2),this.shakingContainer.addChild(this.betDice_3),this.shakingContainer.addChild(this.bowl),this.addChild(this.shakingContainer),this.shakingContainer.position.set(0,Xo.height/11)}showResult(t){var e,i,n;null===(e=this.betDice_1)||void 0===e||e.updateDice(t[0]),null===(i=this.betDice_2)||void 0===i||i.updateDice(t[1]),null===(n=this.betDice_3)||void 0===n||n.updateDice(t[2])}}class Oa extends h.mc{constructor(t,e){super();const i=new _a({width:130,height:130,texture:t,onClick:()=>{e.betOnValue(t,this.position)}});this.addChild(i)}onResize(){}}class ka extends h.mc{constructor(t){super(),this.betPlace_1=null,this.betPlace_2=null,this.betPlace_3=null,this.betPlace_4=null,this.betPlace_5=null,this.betPlace_6=null;const e=Xo.width/3;this.betPlace_1=new Oa("nai",t),this.betPlace_1.position.set(e/2,Xo.height/1.3),this.betPlace_2=new Oa("bau",t),this.betPlace_2.position.set(1*e+e/2,Xo.height/1.3),this.betPlace_3=new Oa("ga",t),this.betPlace_3.position.set(2*e+e/2,Xo.height/1.3),this.betPlace_4=new Oa("ca",t),this.betPlace_4.position.set(e/2,Xo.height/1.1),this.betPlace_5=new Oa("cua",t),this.betPlace_5.position.set(2*e+e/2,Xo.height/1.1),this.betPlace_6=new Oa("tom",t),this.betPlace_6.position.set(1*e+e/2,Xo.height/1.1),this.addChild(this.betPlace_1),this.addChild(this.betPlace_2),this.addChild(this.betPlace_3),this.addChild(this.betPlace_4),this.addChild(this.betPlace_5),this.addChild(this.betPlace_6)}}var Ea,Ra=r(8249);!function(t){let e,i,n,r,s;!function(t){t.GET_DATA="GetData",t.DoAction="DoAction"}(e=t.GAME_EVENTS||(t.GAME_EVENTS={})),function(t){t.GET_DATA="GetData",t.GET_SHOP="GetShop",t.GET_CHALLENGE="GetChallenge",t.GET_RANK="GetRank",t.OPEN_GIFT_TIME="OpenGiftTime",t.SPIN="Spin",t.START_PLAY="Play",t.CLAIM_CHALLENGE="ClaimChallenge",t.BUY_COIN="Buy",t.SHOW_TOAST="ShowToast",t.BUY="Buy",t.MESSAGE_BOX="ShowMessageBox"}(i=t.GAME_ACTION||(t.GAME_ACTION={})),function(t){t.COMMON="Common"}(n=t.GAME_HANDLER||(t.GAME_HANDLER={})),function(t){t[t.GET_CONFIG=0]="GET_CONFIG",t[t.GET_USER_PROFILE=1]="GET_USER_PROFILE"}(r=t.GAME_INFO||(t.GAME_INFO={})),function(t){t.UPDATE_ROOM_LIST="UpdateRoomList"}(s=t.GAME_ROOM_AVAILABLE_ACTIONS||(t.GAME_ROOM_AVAILABLE_ACTIONS={}))}(Ea||(Ea={}));class za{constructor(t){this._currentRoom=t}get currentRoom(){return this._currentRoom}leave(){this._currentRoom&&this._currentRoom.leave(!0)}_sendActionMessage(t,e,i){try{this.currentRoom&&(console.log("Send Action: ",e),this.currentRoom.send(Ea.GAME_EVENTS.DoAction,{handler:t,action:e,params:i||null}))}catch(t){}}}class Fa extends za{sendRequestResult(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.GET_DATA,{})}sendGetData(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.GET_DATA,{})}sendRequestPlay(t){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.START_PLAY,{listBet:t})}sendGetChallenge(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.GET_CHALLENGE,{})}sendOpenGiftTime(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.OPEN_GIFT_TIME,{})}sendLeaderboard(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.GET_RANK,{})}sendShop(){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.GET_SHOP,{})}sendBuyPackage(t){this._sendActionMessage(Ea.GAME_HANDLER.COMMON,Ea.GAME_ACTION.BUY,{id:t})}}console.log("init emitter");const Ua=new ae.A;var Da;!function(t){t.GET_DATA="GetData",t.GET_SHOP="GetShop",t.UPDATE_RESULT="UpdateResult",t.GET_MISSION_DATA="GetMissionData",t.GET_LEADERBOARD="GetLeaderBoard",t.TOAST="Toast",t.MESSAGE_BOX="MessageBox",t.LOADING_MESSAGES="LoadingMessages"}(Da||(Da={}));var Ba=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class La{constructor(){this._world=null,this._game=null}get Game(){return this._game}set Game(t){this._game=t}get World(){return this._world}set World(t){this._world=t}}const Na=new class{constructor(){this.hostname="localhost",this.port=2567,this.useSSL=!1,this.mainRoom=null,this._handlersMap=new Map,this._actionsMap=new Map,this._isLeavingProcessing=!1,this.uid=null,this.token=null,this.Senders=new La,this._isLeavingProcessing=!1,this.uri=""}getHandlerByEvent(t){let e=this._handlersMap.get(t);if(e&&e.length)return e[0]}getHandlersByEvent(t){return this._handlersMap.get(t)||[]}addActionHandler(t,e,i){this._actionsMap.set(`${i}.${t}`,e)}basicAuthen(t){return this.token=t,this}connect(t,e){return Ba(this,arguments,void 0,(function*(t,e,i=!1){try{return this.hostname=t,this.port=e,this.useSSL=i,this.uri=`${this.useSSL?"wss":"ws"}://${this.hostname}${[443,80].indexOf(this.port)>=0||this.useSSL?"":`:${this.port}`}`,this.client=new Ra.Kj({hostname:this.hostname,port:this.port,secure:this.useSSL}),this.mainRoom=yield this.client.joinOrCreate("baucua",{accessToken:this.token}),this.Senders&&(this.Senders.Game=new Fa(this.mainRoom)),this.mainRoom.onMessage(Ea.GAME_EVENTS.DoAction,(t=>{switch(console.log("--- on message: ",t),t.action){case Ea.GAME_ACTION.GET_DATA:Ua.emit(Da.GET_DATA,t);break;case Ea.GAME_ACTION.START_PLAY:Ua.emit(Da.UPDATE_RESULT,t);break;case Ea.GAME_ACTION.GET_CHALLENGE:Ua.emit(Da.GET_MISSION_DATA,t);break;case Ea.GAME_ACTION.SHOW_TOAST:Ua.emit(Da.TOAST,t);break;case Ea.GAME_ACTION.GET_RANK:Ua.emit(Da.GET_LEADERBOARD,t);break;case Ea.GAME_ACTION.GET_SHOP:Ua.emit(Da.GET_SHOP,t);break;case Ea.GAME_ACTION.MESSAGE_BOX:Ua.emit(Da.MESSAGE_BOX,t)}})),!0}catch(t){return console.error(t),!1}}))}onError(t,e){console.log(`onError : ${t}, ${e}`),e&&console.log(e)}};var $a="in vec2 aPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Va="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}",Ga=Object.defineProperty,ja=(t,e,i)=>(((t,e,i)=>{e in t?Ga(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Ha=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct AdjustmentUniforms {\n  uGamma: f32,\n  uContrast: f32,\n  uSaturation: f32,\n  uBrightness: f32,\n  uColor: vec4<f32>,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> adjustmentUniforms : AdjustmentUniforms;\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n  var sample = textureSample(uTexture, uSampler, uv);\n  let color = adjustmentUniforms.uColor;\n\n  if (sample.a > 0.0) \n  {\n    sample = vec4<f32>(sample.rgb / sample.a, sample.a);\n    var rgb: vec3<f32> = pow(sample.rgb, vec3<f32>(1. / adjustmentUniforms.uGamma));\n    rgb = mix(vec3<f32>(.5), mix(vec3<f32>(dot(vec3<f32>(.2125, .7154, .0721), rgb)), rgb, adjustmentUniforms.uSaturation), adjustmentUniforms.uContrast);\n    rgb.r *= color.r;\n    rgb.g *= color.g;\n    rgb.b *= color.b;\n    sample = vec4<f32>(rgb.rgb * adjustmentUniforms.uBrightness, sample.a);\n    sample = vec4<f32>(sample.rgb * sample.a, sample.a);\n  }\n\n  return sample * color.a;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uGamma;\nuniform float uContrast;\nuniform float uSaturation;\nuniform float uBrightness;\nuniform vec4 uColor;\n\nvoid main()\n{\n    vec4 c = texture(uTexture, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / uGamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, uSaturation), uContrast);\n        rgb.r *= uColor.r;\n        rgb.g *= uColor.g;\n        rgb.b *= uColor.b;\n        c.rgb = rgb * uBrightness;\n\n        c.rgb *= c.a;\n    }\n\n    finalColor = c * uColor.a;\n}\n",name:"adjustment-filter"}),resources:{adjustmentUniforms:{uGamma:{value:e.gamma,type:"f32"},uContrast:{value:e.contrast,type:"f32"},uSaturation:{value:e.saturation,type:"f32"},uBrightness:{value:e.brightness,type:"f32"},uColor:{value:[e.red,e.green,e.blue,e.alpha],type:"vec4<f32>"}}}}),ja(this,"uniforms"),this.uniforms=this.resources.adjustmentUniforms.uniforms}get gamma(){return this.uniforms.uGamma}set gamma(t){this.uniforms.uGamma=t}get contrast(){return this.uniforms.uContrast}set contrast(t){this.uniforms.uContrast=t}get saturation(){return this.uniforms.uSaturation}set saturation(t){this.uniforms.uSaturation=t}get brightness(){return this.uniforms.uBrightness}set brightness(t){this.uniforms.uBrightness=t}get red(){return this.uniforms.uColor[0]}set red(t){this.uniforms.uColor[0]=t}get green(){return this.uniforms.uColor[1]}set green(t){this.uniforms.uColor[1]=t}get blue(){return this.uniforms.uColor[2]}set blue(t){this.uniforms.uColor[2]=t}get alpha(){return this.uniforms.uColor[3]}set alpha(t){this.uniforms.uColor[3]=t}};ja(Ha,"DEFAULT_OPTIONS",{gamma:1,contrast:1,saturation:1,brightness:1,red:1,green:1,blue:1,alpha:1});var Wa=Object.defineProperty,Xa=(t,e,i)=>(((t,e,i)=>{e in t?Wa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Ya=class t extends Et.d{constructor(...e){let i=e[0]??{};("number"==typeof i||Array.isArray(i))&&((0,d.t6)("6.0.0","KawaseBlurFilter constructor params are now options object. See params: { strength, quality, clamp, pixelSize }"),i={strength:i},void 0!==e[1]&&(i.quality=e[1]),void 0!==e[2]&&(i.clamp=e[2])),i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:i?.clamp?"struct KawaseBlurUniforms {\n  uOffset:vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uOffset = kawaseBlurUniforms.uOffset;\n  var color: vec4<f32> = vec4(0.0);\n\n  // Sample top left pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample top right pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample bottom right pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample bottom left pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Average\n  color *= 0.25;\n    \n  return color;\n}":"struct KawaseBlurUniforms {\n  uOffset:vec2<f32>,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uOffset = kawaseBlurUniforms.uOffset;\n  var color: vec4<f32> = vec4<f32>(0.0);\n\n  // Sample top left pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y));\n  // Sample top right pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y));\n  // Sample bottom right pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y));\n  // Sample bottom left pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y));\n  // Average\n  color *= 0.25;\n\n  return color;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:i?.clamp?"\nprecision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uOffset;\n\nuniform vec4 uInputClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample top right pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    finalColor = color;\n}\n":"\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    finalColor = color;\n}",name:"kawase-blur-filter"}),resources:{kawaseBlurUniforms:{uOffset:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Xa(this,"uniforms"),Xa(this,"_pixelSize",{x:0,y:0}),Xa(this,"_clamp"),Xa(this,"_kernels",[]),Xa(this,"_blur"),Xa(this,"_quality"),this.uniforms=this.resources.kawaseBlurUniforms.uniforms,this.pixelSize=i.pixelSize??{x:1,y:1},Array.isArray(i.strength)?this.kernels=i.strength:"number"==typeof i.strength&&(this._blur=i.strength,this.quality=i.quality??3),this._clamp=!!i.clamp}apply(t,e,i,n){const r=this.pixelSizeX/e.source.width,s=this.pixelSizeY/e.source.height;let o;if(1===this._quality||0===this._blur)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*r,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,e,i,n);else{const a=Ut.W.getSameSizeTexture(e);let l,u=e,h=a;const c=this._quality-1;for(let e=0;e<c;e++)o=this._kernels[e]+.5,this.uniforms.uOffset[0]=o*r,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,u,h,!0),l=u,u=h,h=l;o=this._kernels[c]+.5,this.uniforms.uOffset[0]=o*r,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,u,i,n),Ut.W.returnTexture(a)}}get strength(){return this._blur}set strength(t){this._blur=t,this._generateKernels()}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get pixelSize(){return this._pixelSize}set pixelSize(t){if("number"!=typeof t)return Array.isArray(t)?(this.pixelSizeX=t[0],void(this.pixelSizeY=t[1])):void(this._pixelSize=t);this.pixelSizeX=this.pixelSizeY=t}get pixelSizeX(){return this.pixelSize.x}set pixelSizeX(t){this.pixelSize.x=t}get pixelSizeY(){return this.pixelSize.y}set pixelSizeY(t){this.pixelSize.y=t}get clamp(){return this._clamp}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce(((t,e)=>t+e+.5),0))}_generateKernels(){const t=this._blur,e=this._quality,i=[t];if(t>0){let n=t;const r=t/e;for(let t=1;t<e;t++)n-=r,i.push(n)}this._kernels=i,this._updatePadding()}};Xa(Ya,"DEFAULT_OPTIONS",{strength:4,quality:3,clamp:!1,pixelSize:{x:1,y:1}});let qa=Ya;var Ka=Object.defineProperty,Za=(t,e,i)=>(((t,e,i)=>{e in t?Ka(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Qa=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ExtractBrightnessUniforms {\n  uThreshold: f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> extractBrightnessUniforms : ExtractBrightnessUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  // A simple & fast algorithm for getting brightness.\n  // It's inaccurate, but good enough for this feature.\n  let max: f32 = max(max(color.r, color.g), color.b);\n  let min: f32 = min(min(color.r, color.g), color.b);\n  let brightness: f32 = (max + min) * 0.5;\n\n  return select(vec4<f32>(0.), color, brightness > extractBrightnessUniforms.uThreshold);\n}\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uThreshold;\n\nvoid main() {\n    vec4 color = texture(uTexture, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > uThreshold) {\n        finalColor = color;\n    } else {\n        finalColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n",name:"extract-brightness-filter"}),resources:{extractBrightnessUniforms:{uThreshold:{value:e.threshold,type:"f32"}}}}),Za(this,"uniforms"),this.uniforms=this.resources.extractBrightnessUniforms.uniforms}get threshold(){return this.uniforms.uThreshold}set threshold(t){this.uniforms.uThreshold=t}};Za(Qa,"DEFAULT_OPTIONS",{threshold:.5});let Ja=Qa;var tl=Object.defineProperty,el=(t,e,i)=>(((t,e,i)=>{e in t?tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const il=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct AdvancedBloomUniforms {\n  uBloomScale: f32,\n  uBrightness: f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> advancedBloomUniforms : AdvancedBloomUniforms;\n@group(1) @binding(1) var uMapTexture: texture_2d<f32>;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  var color = textureSample(uTexture, uSampler, uv);\n  color = vec4<f32>(color.rgb * advancedBloomUniforms.uBrightness, color.a);\n\n  var bloomColor = vec4<f32>(textureSample(uMapTexture, uSampler, uv).rgb, 0.0);\n  bloomColor = vec4<f32>(bloomColor.rgb * advancedBloomUniforms.uBloomScale, bloomColor.a);\n  \n  return color + bloomColor;\n}\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMapTexture;\nuniform float uBloomScale;\nuniform float uBrightness;\n\nvoid main() {\n    vec4 color = texture(uTexture, vTextureCoord);\n    color.rgb *= uBrightness;\n    vec4 bloomColor = vec4(texture(uMapTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= uBloomScale;\n    finalColor = color + bloomColor;\n}\n",name:"advanced-bloom-filter"}),resources:{advancedBloomUniforms:{uBloomScale:{value:e.bloomScale,type:"f32"},uBrightness:{value:e.brightness,type:"f32"}},uMapTexture:x.g.WHITE}}),el(this,"uniforms"),el(this,"bloomScale",1),el(this,"brightness",1),el(this,"_extractFilter"),el(this,"_blurFilter"),this.uniforms=this.resources.advancedBloomUniforms.uniforms,this._extractFilter=new Ja({threshold:e.threshold}),this._blurFilter=new qa({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),Object.assign(this,e)}apply(t,e,i,n){const r=Ut.W.getSameSizeTexture(e);this._extractFilter.apply(t,e,r,!0);const s=Ut.W.getSameSizeTexture(e);this._blurFilter.apply(t,r,s,!0),this.uniforms.uBloomScale=this.bloomScale,this.uniforms.uBrightness=this.brightness,this.resources.uMapTexture=s.source,t.applyFilter(this,e,i,n),Ut.W.returnTexture(s),Ut.W.returnTexture(r)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.strength}set blur(t){this._blurFilter.strength=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){"number"==typeof t&&(t={x:t,y:t}),Array.isArray(t)&&(t={x:t[0],y:t[1]}),this._blurFilter.pixelSize=t}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(t){this._blurFilter.pixelSizeX=t}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(t){this._blurFilter.pixelSizeY=t}};el(il,"DEFAULT_OPTIONS",{threshold:.5,bloomScale:1,brightness:1,blur:8,quality:4,pixelSize:{x:1,y:1}});var nl=Object.defineProperty,rl=(t,e,i)=>(((t,e,i)=>{e in t?nl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const sl=class t extends Et.d{constructor(...e){let i=e[0]??{};"number"==typeof i&&((0,d.t6)("6.0.0","AsciiFilter constructor params are now options object. See params: { size, color, replaceColor }"),i={size:i});const n=i?.color&&!1!==i.replaceColor;i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct AsciiUniforms {\n    uSize: f32,\n    uColor: vec3<f32>,\n    uReplaceColor: f32,\n};\n\nstruct GlobalFilterUniforms {\n    uInputSize:vec4<f32>,\n    uInputPixel:vec4<f32>,\n    uInputClamp:vec4<f32>,\n    uOutputFrame:vec4<f32>,\n    uGlobalFrame:vec4<f32>,\n    uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> asciiUniforms : AsciiUniforms;\n\n@fragment\nfn mainFragment(\n    @location(0) uv: vec2<f32>,\n    @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n    let pixelSize: f32 = asciiUniforms.uSize;\n    let coord: vec2<f32> = mapCoord(uv);\n\n    // get the rounded color..\n    var pixCoord: vec2<f32> = pixelate(coord, vec2<f32>(pixelSize));\n    pixCoord = unmapCoord(pixCoord);\n\n    var color = textureSample(uTexture, uSampler, pixCoord);\n\n    // determine the character to use\n    let gray: f32 = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;\n    \n    var n: f32 = 65536.0; // .\n    if (gray > 0.2) {\n        n = 65600.0;    // :\n    }\n    if (gray > 0.3) {\n        n = 332772.0;   // *\n    }\n    if (gray > 0.4) {\n        n = 15255086.0; // o\n    }\n    if (gray > 0.5) {\n        n = 23385164.0; // &\n    }\n    if (gray > 0.6) {\n        n = 15252014.0; // 8\n    }\n    if (gray > 0.7) {\n        n = 13199452.0; // @\n    }\n    if (gray > 0.8) {\n        n = 11512810.0; // #\n    }\n\n    // get the mod..\n    let modd: vec2<f32> = getMod(coord, vec2<f32>(pixelSize));\n    return select(color, vec4<f32>(asciiUniforms.uColor, 1.), asciiUniforms.uReplaceColor > 0.5) * character(n, vec2<f32>(-1.0) + modd * 2.0);\n}\n\nfn pixelate(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>\n{\n    return floor( coord / size ) * size;\n}\n\nfn getMod(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>\n{\n    return moduloVec2( coord , size) / size;\n}\n\nfn character(n: f32, p: vec2<f32>) -> f32\n{\n    var q: vec2<f32> = floor(p*vec2<f32>(4.0, 4.0) + 2.5);\n\n    if (clamp(q.x, 0.0, 4.0) == q.x)\n    {\n        if (clamp(q.y, 0.0, 4.0) == q.y)\n        {\n        if (i32(modulo(n/exp2(q.x + 5.0*q.y), 2.0)) == 1)\n        {\n            return 1.0;\n        }\n        }\n    }\n\n    return 0.0;\n}\n\nfn modulo(x: f32, y: f32) -> f32\n{\n  return x - y * floor(x/y);\n}\n\nfn moduloVec2(x: vec2<f32>, y: vec2<f32>) -> vec2<f32>\n{\n  return x - y * floor(x/y);\n}\n\nfn mapCoord(coord: vec2<f32> ) -> vec2<f32>\n{\n    var mappedCoord: vec2<f32> = coord;\n    mappedCoord *= gfu.uInputSize.xy;\n    mappedCoord += gfu.uOutputFrame.xy;\n    return mappedCoord;\n}\n\nfn unmapCoord(coord: vec2<f32> ) -> vec2<f32>\n{\n    var mappedCoord: vec2<f32> = coord;\n    mappedCoord -= gfu.uOutputFrame.xy;\n    mappedCoord /= gfu.uInputSize.xy;\n    return mappedCoord;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uSize;\nuniform vec3 uColor;\nuniform float uReplaceColor;\n\nuniform vec4 uInputSize;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= uInputSize.xy;\n    coord += uInputSize.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= uInputSize.zw;\n    coord /= uInputSize.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n    return floor(coord / size) * size;\n}\n\nvec2 getMod(vec2 coord, vec2 size)\n{\n    return mod(coord, size) / size;\n}\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, 4.0) + 2.5);\n\n    if (clamp(p.x, 0.0, 4.0) == p.x)\n    {\n        if (clamp(p.y, 0.0, 4.0) == p.y)\n        {\n            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n        }\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    // get the grid position\n    vec2 pixCoord = pixelate(coord, vec2(uSize));\n    pixCoord = unmapCoord(pixCoord);\n\n    // sample the color at grid position\n    vec4 color = texture(uTexture, pixCoord);\n\n    // brightness of the color as it's perceived by the human eye\n    float gray = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;\n\n    // determine the character to use\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    // get the mod..\n    vec2 modd = getMod(coord, vec2(uSize));\n\n    finalColor = (uReplaceColor > 0.5 ? vec4(uColor, 1.) : color) * character( n, vec2(-1.0) + modd * 2.0);\n}\n",name:"ascii-filter"}),resources:{asciiUniforms:{uSize:{value:i.size,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uReplaceColor:{value:Number(n),type:"f32"}}}}),rl(this,"uniforms"),rl(this,"_color"),this.uniforms=this.resources.asciiUniforms.uniforms,this._color=new Mt.Q,this.color=i.color??16777215}get size(){return this.uniforms.uSize}set size(t){this.uniforms.uSize=t}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get replaceColor(){return this.uniforms.uReplaceColor>.5}set replaceColor(t){this.uniforms.uReplaceColor=t?1:0}};rl(sl,"DEFAULT_OPTIONS",{size:8,color:16777215,replaceColor:!1});Object.defineProperty;var ol=Object.defineProperty,al=(t,e,i)=>(((t,e,i)=>{e in t?ol(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const ll=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct BevelUniforms {\n  uLightColor: vec3<f32>,\n  uLightAlpha: f32,\n  uShadowColor: vec3<f32>,\n  uShadowAlpha: f32,\n  uTransform: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> bevelUniforms : BevelUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let transform = vec2<f32>(1.0 / gfu.uInputSize.xy) * vec2<f32>(bevelUniforms.uTransform.x, bevelUniforms.uTransform.y);\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let lightSample: f32 = textureSample(uTexture, uSampler, uv - transform).a;\n  let shadowSample: f32 = textureSample(uTexture, uSampler, uv + transform).a;\n\n  let light = vec4<f32>(bevelUniforms.uLightColor, bevelUniforms.uLightAlpha);\n  let shadow = vec4<f32>(bevelUniforms.uShadowColor, bevelUniforms.uShadowAlpha);\n\n  color = vec4<f32>(mix(color.rgb, light.rgb, clamp((color.a - lightSample) * light.a, 0.0, 1.0)), color.a);\n  color = vec4<f32>(mix(color.rgb, shadow.rgb, clamp((color.a - shadowSample) * shadow.a, 0.0, 1.0)), color.a);\n  \n  return vec4<f32>(color.rgb * color.a, color.a);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uTransform;\nuniform vec3 uLightColor;\nuniform float uLightAlpha;\nuniform vec3 uShadowColor;\nuniform float uShadowAlpha;\n\nuniform vec4 uInputSize;\n\nvoid main(void) {\n    vec2 transform = vec2(1.0 / uInputSize) * vec2(uTransform.x, uTransform.y);\n    vec4 color = texture(uTexture, vTextureCoord);\n    float light = texture(uTexture, vTextureCoord - transform).a;\n    float shadow = texture(uTexture, vTextureCoord + transform).a;\n\n    color.rgb = mix(color.rgb, uLightColor, clamp((color.a - light) * uLightAlpha, 0.0, 1.0));\n    color.rgb = mix(color.rgb, uShadowColor, clamp((color.a - shadow) * uShadowAlpha, 0.0, 1.0));\n    finalColor = vec4(color.rgb * color.a, color.a);\n}\n",name:"bevel-filter"}),resources:{bevelUniforms:{uLightColor:{value:new Float32Array(3),type:"vec3<f32>"},uLightAlpha:{value:e.lightAlpha,type:"f32"},uShadowColor:{value:new Float32Array(3),type:"vec3<f32>"},uShadowAlpha:{value:e.shadowAlpha,type:"f32"},uTransform:{value:new Float32Array(2),type:"vec2<f32>"}}},padding:1}),al(this,"uniforms"),al(this,"_thickness"),al(this,"_rotation"),al(this,"_lightColor"),al(this,"_shadowColor"),this.uniforms=this.resources.bevelUniforms.uniforms,this._lightColor=new Mt.Q,this._shadowColor=new Mt.Q,this.lightColor=e.lightColor??16777215,this.shadowColor=e.shadowColor??0,Object.assign(this,e)}get rotation(){return this._rotation/jt.Td}set rotation(t){this._rotation=t*jt.Td,this._updateTransform()}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this._updateTransform()}get lightColor(){return this._lightColor.value}set lightColor(t){this._lightColor.setValue(t);const[e,i,n]=this._lightColor.toArray();this.uniforms.uLightColor[0]=e,this.uniforms.uLightColor[1]=i,this.uniforms.uLightColor[2]=n}get lightAlpha(){return this.uniforms.uLightAlpha}set lightAlpha(t){this.uniforms.uLightAlpha=t}get shadowColor(){return this._shadowColor.value}set shadowColor(t){this._shadowColor.setValue(t);const[e,i,n]=this._shadowColor.toArray();this.uniforms.uShadowColor[0]=e,this.uniforms.uShadowColor[1]=i,this.uniforms.uShadowColor[2]=n}get shadowAlpha(){return this.uniforms.uShadowAlpha}set shadowAlpha(t){this.uniforms.uShadowAlpha=t}_updateTransform(){this.uniforms.uTransform[0]=this.thickness*Math.cos(this._rotation),this.uniforms.uTransform[1]=this.thickness*Math.sin(this._rotation)}};al(ll,"DEFAULT_OPTIONS",{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7});var ul=Object.defineProperty,hl=(t,e,i)=>(((t,e,i)=>{e in t?ul(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const cl=class t extends Ft{constructor(...e){let i=e[0]??{};if("number"==typeof i||Array.isArray(i)||"x"in i&&"y"in i){(0,d.t6)("6.0.0","BloomFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }");let t=i;Array.isArray(t)&&(t={x:t[0],y:t[1]}),i={strength:t},void 0!==e[1]&&(i.quality=e[1]),void 0!==e[2]&&(i.resolution=e[2]),void 0!==e[3]&&(i.kernelSize=e[3])}i={...t.DEFAULT_OPTIONS,...i},super(),hl(this,"_blurXFilter"),hl(this,"_blurYFilter"),hl(this,"_strength"),this._strength={x:2,y:2},i.strength&&("number"==typeof i.strength?(this._strength.x=i.strength,this._strength.y=i.strength):(this._strength.x=i.strength.x,this._strength.y=i.strength.y)),this._blurXFilter=new Vt({...i,horizontal:!0,strength:this.strengthX}),this._blurYFilter=new Vt({...i,horizontal:!1,strength:this.strengthY}),this._blurYFilter.blendMode="screen",Object.assign(this,i)}apply(t,e,i,n){const r=Ut.W.getSameSizeTexture(e);t.applyFilter(this,e,i,n),this._blurXFilter.apply(t,e,r,!0),this._blurYFilter.apply(t,r,i,!1),Ut.W.returnTexture(r)}get strength(){return this._strength}set strength(t){this._strength="number"==typeof t?{x:t,y:t}:t,this._updateStrength()}get strengthX(){return this.strength.x}set strengthX(t){this.strength.x=t,this._updateStrength()}get strengthY(){return this.strength.y}set strengthY(t){this.strength.y=t,this._updateStrength()}_updateStrength(){this._blurXFilter.blur=this.strengthX,this._blurYFilter.blur=this.strengthY}get blur(){return(0,d.t6)("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strengthX}set blur(t){(0,d.t6)("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strength=t}get blurX(){return(0,d.t6)("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX}set blurX(t){(0,d.t6)("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX=t}get blurY(){return(0,d.t6)("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY}set blurY(t){(0,d.t6)("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY=t}};hl(cl,"DEFAULT_OPTIONS",{strength:{x:2,y:2},quality:4,resolution:1,kernelSize:5});var dl=Object.defineProperty,fl=(t,e,i)=>(((t,e,i)=>{e in t?dl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const pl=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct BulgePinchUniforms {\n  uDimensions: vec2<f32>,\n  uCenter: vec2<f32>,\n  uRadius: f32,\n  uStrength: f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> bulgePinchUniforms : BulgePinchUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let dimensions: vec2<f32> = bulgePinchUniforms.uDimensions;\n  let center: vec2<f32> = bulgePinchUniforms.uCenter;\n  let radius: f32 = bulgePinchUniforms.uRadius;\n  let strength: f32 = bulgePinchUniforms.uStrength;\n  var coord: vec2<f32> = (uv * gfu.uInputSize.xy) - center * dimensions.xy;\n\n  let distance: f32 = length(coord);\n\n  if (distance < radius) {\n      let percent: f32 = distance / radius;\n      if (strength > 0.0) {\n          coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n      } else {\n          coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n      }\n  }\n    coord += (center * dimensions.xy);\n    coord /= gfu.uInputSize.xy;\n\n    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);\n    var color: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);\n    if (coord.x != clampedCoord.x && coord.y != clampedCoord.y) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    return color;\n}\n\nfn compareVec2(x: vec2<f32>, y: vec2<f32>) -> bool\n{\n  if (x.x == y.x && x.y == y.y)\n  {\n    return true;\n  }\n\n  return false;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uDimensions;\nuniform vec2 uCenter;\nuniform float uRadius;\nuniform float uStrength;\n\nuniform vec4 uInputSize;\nuniform vec4 uInputClamp;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * uInputSize.xy;\n    coord -= uCenter * uDimensions.xy;\n    float distance = length(coord);\n\n    if (distance < uRadius) {\n        float percent = distance / uRadius;\n        if (uStrength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, uRadius / distance, percent), uStrength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + uStrength * 0.75) * uRadius / distance, 1.0 - percent);\n        }\n    }\n\n    coord += uCenter * uDimensions.xy;\n    coord /= uInputSize.xy;\n    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);\n    vec4 color = texture(uTexture, clampedCoord);\n\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    finalColor = color;\n}\n",name:"bulge-pinch-filter"}),resources:{bulgePinchUniforms:{uDimensions:{value:[0,0],type:"vec2<f32>"},uCenter:{value:e.center,type:"vec2<f32>"},uRadius:{value:e.radius,type:"f32"},uStrength:{value:e.strength,type:"f32"}}}}),fl(this,"uniforms"),this.uniforms=this.resources.bulgePinchUniforms.uniforms,Object.assign(this,e)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,t.applyFilter(this,e,i,n)}get center(){return this.uniforms.uCenter}set center(t){"number"==typeof t&&(t={x:t,y:t}),Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uCenter=t}get centerX(){return this.uniforms.uCenter.x}set centerX(t){this.uniforms.uCenter.x=t}get centerY(){return this.uniforms.uCenter.y}set centerY(t){this.uniforms.uCenter.y=t}get radius(){return this.uniforms.uRadius}set radius(t){this.uniforms.uRadius=t}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}};fl(pl,"DEFAULT_OPTIONS",{center:{x:.5,y:.5},radius:100,strength:1});var ml,gl,vl="struct BaseUniforms {\n  uOptions: vec4<f32>,\n  uCounts: vec2<f32>,\n};\n\nstruct StopsUniforms {\n  uColors: array<vec3<f32>, MAX_STOPS>,\n  uStops: array<vec4<f32>, MAX_STOPS>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> baseUniforms : BaseUniforms;\n@group(1) @binding(1) var<uniform> stopsUniforms : StopsUniforms;\n\nstruct VSOutput {\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>,\n  @location(1) coord : vec2<f32>\n};\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn filterCoord( vTextureCoord:vec2<f32> ) -> vec2<f32>\n{\n    return vTextureCoord * gfu.uInputSize.xy / gfu.uOutputFrame.zw;\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  let vTextureCoord: vec2<f32> = filterTextureCoord(aPosition);\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   vTextureCoord,\n   filterCoord(vTextureCoord),\n  );\n}\n\nstruct ColorStop {\n  offset: f32,\n  color: vec3<f32>,\n  alpha: f32,\n};\n\nfn rotate2d(angle: f32) -> mat2x2<f32>{\n  return mat2x2(cos(angle), -sin(angle),\n  sin(angle), cos(angle));\n}\n\nfn projectLinearPosition(pos: vec2<f32>, angle: f32) -> f32 {\n  var center: vec2<f32> = vec2<f32>(0.5);\n  var result: vec2<f32> = pos - center;\n  result = rotate2d(angle) * result;\n  result = result + center;\n  return clamp(result.x, 0.0, 1.0);\n}\n\nfn projectRadialPosition(pos: vec2<f32>) -> f32 {\n  var r: f32 = distance(pos, vec2<f32>(0.5));\n  return clamp(2.0 * r, 0.0, 1.0);\n}\n\nfn projectAnglePosition(pos: vec2<f32>, angle: f32) -> f32 {\n  var center: vec2<f32> = pos - vec2<f32>(0.5, 0.5);\n  var polarAngle: f32 = atan2(-center.y, center.x);\n  return ((polarAngle + angle) % PI_2) / PI_2;\n}\n\nfn projectPosition(pos: vec2<f32>, gradientType: i32, angle: f32) -> f32 {\n  if (gradientType == TYPE_LINEAR) {\n      return projectLinearPosition(pos, angle);\n  } else if (gradientType == TYPE_RADIAL) {\n      return projectRadialPosition(pos);\n  } else if (gradientType == TYPE_CONIC) {\n      return projectAnglePosition(pos, angle);\n  }\n\n  return pos.y;\n}\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>,\n  @location(1) coord : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uType: i32 = i32(baseUniforms.uOptions[0]);\n  let uAngle: f32 = baseUniforms.uOptions[1];\n  let uAlpha: f32 = baseUniforms.uOptions[2];\n  let uReplace: f32 = baseUniforms.uOptions[3];\n\n  let uNumStops: i32 = i32(baseUniforms.uCounts[0]);\n  let uMaxColors: f32 = baseUniforms.uCounts[1];\n\n  // current/original color\n  var currentColor: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  // skip calculations if gradient alpha is 0\n  if (uAlpha == 0.0) { return currentColor; }\n\n  // project position\n  var y: f32 = projectPosition(coord, uType, radians(uAngle));\n\n  // check gradient bounds\n  var offsetMin: f32 = stopsUniforms.uStops[0][0];\n  var offsetMax: f32 = 0.0;\n\n  let numStops: i32 = uNumStops;\n\n  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {\n      if (i == numStops - 1) { // last index\n          offsetMax = stopsUniforms.uStops[i][0];\n      }\n  }\n\n  if (y  < offsetMin || y > offsetMax) { return currentColor; }\n\n  // limit colors\n  if (uMaxColors > 0.0) {\n      var stepSize: f32 = 1.0 / uMaxColors;\n      var stepNumber: f32 = floor(y / stepSize);\n      y = stepSize * (stepNumber + 0.5); // offset by 0.5 to use color from middle of segment\n  }\n\n  // find color stops\n  var stopFrom: ColorStop;\n  var stopTo: ColorStop;\n\n  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {\n      if (y >= stopsUniforms.uStops[i][0]) {\n          stopFrom = ColorStop(stopsUniforms.uStops[i][0], stopsUniforms.uColors[i], stopsUniforms.uStops[i][1]);\n          stopTo = ColorStop(stopsUniforms.uStops[i + 1][0], stopsUniforms.uColors[i + 1], stopsUniforms.uStops[i + 1][1]);\n      }\n\n      if (i == numStops - 1) { // last index\n          break;\n      }\n  }\n\n  // mix colors from stops\n  var colorFrom: vec4<f32> = vec4<f32>(stopFrom.color * stopFrom.alpha, stopFrom.alpha);\n  var colorTo: vec4<f32> = vec4<f32>(stopTo.color * stopTo.alpha, stopTo.alpha);\n\n  var segmentHeight: f32 = stopTo.offset - stopFrom.offset;\n  var relativePos: f32 = y - stopFrom.offset; // position from 0 to [segmentHeight]\n  var relativePercent: f32 = relativePos / segmentHeight; // position in percent between [from.offset] and [to.offset].\n\n  var gradientAlpha: f32 = uAlpha * currentColor.a;\n  var gradientColor: vec4<f32> = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n  if (uReplace < 0.5) {\n      // mix resulting color with current color\n      return gradientColor + currentColor * (1.0 - gradientColor.a);\n  } else {\n      // replace with gradient color\n      return gradientColor;\n  }\n}\n\nconst PI: f32 = 3.14159265358979323846264;\nconst PI_2: f32 = PI * 2.0;\n\nconst TYPE_LINEAR: i32 = 0;\nconst TYPE_RADIAL: i32 = 1;\nconst TYPE_CONIC: i32 = 2;\nconst MAX_STOPS: i32 = 32;";(gl=gl||{}).stringify=(ml={"visit_linear-gradient":function(t){return ml.visit_gradient(t)},"visit_repeating-linear-gradient":function(t){return ml.visit_gradient(t)},"visit_radial-gradient":function(t){return ml.visit_gradient(t)},"visit_repeating-radial-gradient":function(t){return ml.visit_gradient(t)},visit_gradient:function(t){var e=ml.visit(t.orientation);return e&&(e+=", "),t.type+"("+e+ml.visit(t.colorStops)+")"},visit_shape:function(t){var e=t.value,i=ml.visit(t.at),n=ml.visit(t.style);return n&&(e+=" "+n),i&&(e+=" at "+i),e},"visit_default-radial":function(t){var e="",i=ml.visit(t.at);return i&&(e+=i),e},"visit_extent-keyword":function(t){var e=t.value,i=ml.visit(t.at);return i&&(e+=" at "+i),e},"visit_position-keyword":function(t){return t.value},visit_position:function(t){return ml.visit(t.value.x)+" "+ml.visit(t.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(t){return ml.visit_color(t.value,t)},visit_hex:function(t){return ml.visit_color("#"+t.value,t)},visit_rgb:function(t){return ml.visit_color("rgb("+t.value.join(", ")+")",t)},visit_rgba:function(t){return ml.visit_color("rgba("+t.value.join(", ")+")",t)},visit_color:function(t,e){var i=t,n=ml.visit(e.length);return n&&(i+=" "+n),i},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(t){var e="",i=t.length;return t.forEach((function(t,n){e+=ml.visit(t),n<i-1&&(e+=", ")})),e},visit:function(t){if(!t)return"";if(t instanceof Array)return ml.visit_array(t,"");if(t.type){var e=ml["visit_"+t.type];if(e)return e(t);throw Error("Missing visitor visit_"+t.type)}throw Error("Invalid node.")}},function(t){return ml.visit(t)}),(gl=gl||{}).parse=function(){var t=/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,e=/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,i=/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,n=/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,r=/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,s=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,o=/^(left|center|right|top|bottom)/i,a=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,c=/^\(/,d=/^\)/,f=/^,/,p=/^\#([0-9a-fA-F]+)/,m=/^([a-zA-Z]+)/,g=/^rgb/i,v=/^rgba/i,y=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function _(t){var e=new Error(x+": "+t);throw e.source=x,e}function b(){var t=k(w);return x.length>0&&_("Invalid input not EOF"),t}function w(){return S("linear-gradient",t,A)||S("repeating-linear-gradient",e,A)||S("radial-gradient",i,T)||S("repeating-radial-gradient",n,T)}function S(t,e,i){return C(e,(function(e){var n=i();return n&&(D(f)||_("Missing comma before color stops")),{type:t,orientation:n,colorStops:k(E)}}))}function C(t,e){var i=D(t);if(i){D(c)||_("Missing (");var n=e(i);return D(d)||_("Missing )"),n}}function A(){return U("directional",r,1)||U("angular",h,1)}function T(){var t,e,i=P();return i&&((t=[]).push(i),e=x,D(f)&&((i=P())?t.push(i):x=e)),t}function P(){var t=function(){var t=U("shape",/^(circle)/i,0);t&&(t.style=F()||M());return t}()||function(){var t=U("shape",/^(ellipse)/i,0);t&&(t.style=z()||M());return t}();if(t)t.at=I();else{var e=M();if(e){t=e;var i=I();i&&(t.at=i)}else{var n=O();n&&(t={type:"default-radial",at:n})}}return t}function M(){return U("extent-keyword",s,1)}function I(){if(U("position",/^at/,0)){var t=O();return t||_("Missing positioning value"),t}}function O(){var t={x:z(),y:z()};if(t.x||t.y)return{type:"position",value:t}}function k(t){var e=t(),i=[];if(e)for(i.push(e);D(f);)(e=t())?i.push(e):_("One extra comma");return i}function E(){var t=U("hex",p,1)||C(v,(function(){return{type:"rgba",value:k(R)}}))||C(g,(function(){return{type:"rgb",value:k(R)}}))||U("literal",m,0);return t||_("Expected color definition"),t.length=z(),t}function R(){return D(y)[1]}function z(){return U("%",l,1)||U("position-keyword",o,1)||F()}function F(){return U("px",a,1)||U("em",u,1)}function U(t,e,i){var n=D(e);if(n)return{type:t,value:n[i]}}function D(t){var e,i;return(i=/^[\n\r\t\s]+/.exec(x))&&B(i[0].length),(e=t.exec(x))&&B(e[0].length),e}function B(t){x=x.substr(t)}return function(t){return x=t.toString(),b()}}();var yl=gl.parse;function xl(t){const e=yl(function(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}(t));if(0===e.length)throw new Error("Invalid CSS gradient.");if(1!==e.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const i=e[0],n=function(t){const e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}(i.type),r=function(t){const e=function(t){const e=[],i=-1;for(let n=0;n<t.length;n++){const r=t[n];let s=i;"literal"===r.type&&r.length&&"type"in r.length&&"%"===r.length.type&&"value"in r.length&&(s=parseFloat(r.length.value)/100),e.push(s)}const n=t=>{for(let n=t;n<e.length;n++)if(e[n]!==i)return{indexDelta:n-t,offset:e[n]};return{indexDelta:e.length-1-t,offset:1}};let r=0;for(let t=0;t<e.length;t++){const s=e[t];if(s!==i)r=s;else if(0===t)e[t]=0;else if(t+1===e.length)e[t]=1;else{const i=n(t),s=(i.offset-r)/(1+i.indexDelta);for(let n=0;n<=i.indexDelta;n++)e[t+n]=r+(n+1)*s;t+=i.indexDelta,r=e[t]}}return e.map(bl)}(t),i=[],n=new Mt.Q;for(let r=0;r<t.length;r++){const s=_l(t[r]),o=n.setValue(s).toArray();i.push({offset:e[r],color:o.slice(0,3),alpha:o[3]})}return i}(i.colorStops);return{type:n,stops:r,angle:function(t){if(void 0===t)return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return function(t){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}(t.value)}return 0}(i.orientation)}}function _l(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}function bl(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}gl.stringify;var wl=Object.defineProperty,Sl=(t,e,i)=>(((t,e,i)=>{e in t?wl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Cl=class t extends Et.d{constructor(e){if(!(e=e&&"css"in e?{...xl(e.css||""),alpha:e.alpha??t.defaults.alpha,maxColors:e.maxColors??t.defaults.maxColors}:{...t.defaults,...e}).stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super({gpuProgram:Ot.B.from({vertex:{source:vl,entryPoint:"mainVertex"},fragment:{source:vl,entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:"in vec2 aPosition;\nout vec2 vTextureCoord;\nout vec2 vFilterCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n    vFilterCoord = vTextureCoord * uInputSize.xy / uOutputFrame.zw;\n}\n",fragment:"precision highp float;\nin vec2 vTextureCoord;\nin vec2 vFilterCoord;\nout vec4 finalColor;\n\nconst int TYPE_LINEAR = 0;\nconst int TYPE_RADIAL = 1;\nconst int TYPE_CONIC = 2;\nconst int MAX_STOPS = 32;\n\nuniform sampler2D uTexture;\nuniform vec4 uOptions;\nuniform vec2 uCounts;\nuniform vec3 uColors[MAX_STOPS];\nuniform vec4 uStops[MAX_STOPS];\n\nconst float PI = 3.1415926538;\nconst float PI_2 = PI*2.;\n\nstruct ColorStop {\n    float offset;\n    vec3 color;\n    float alpha;\n};\n\nmat2 rotate2d(float angle){\n    return mat2(cos(angle), -sin(angle),\n    sin(angle), cos(angle));\n}\n\nfloat projectLinearPosition(vec2 pos, float angle){\n    vec2 center = vec2(0.5);\n    vec2 result = pos - center;\n    result = rotate2d(angle) * result;\n    result = result + center;\n    return clamp(result.x, 0., 1.);\n}\n\nfloat projectRadialPosition(vec2 pos) {\n    float r = distance(pos, vec2(0.5));\n    return clamp(2.*r, 0., 1.);\n}\n\nfloat projectAnglePosition(vec2 pos, float angle) {\n    vec2 center = pos - vec2(0.5);\n    float polarAngle=atan(-center.y, center.x);\n    return mod(polarAngle + angle, PI_2) / PI_2;\n}\n\nfloat projectPosition(vec2 pos, int type, float angle) {\n    if (type == TYPE_LINEAR) {\n        return projectLinearPosition(pos, angle);\n    } else if (type == TYPE_RADIAL) {\n        return projectRadialPosition(pos);\n    } else if (type == TYPE_CONIC) {\n        return projectAnglePosition(pos, angle);\n    }\n\n    return pos.y;\n}\n\nvoid main(void) {\n    int uType = int(uOptions[0]);\n    float uAngle = uOptions[1];\n    float uAlpha = uOptions[2];\n    float uReplace = uOptions[3];\n\n    int uNumStops = int(uCounts[0]);\n    float uMaxColors = uCounts[1];\n\n    // current/original color\n    vec4 currentColor = texture(uTexture, vTextureCoord);\n\n    // skip calculations if gradient alpha is 0\n    if (0.0 == uAlpha) {\n        finalColor = currentColor;\n        return;\n    }\n\n    // project position\n    float y = projectPosition(vFilterCoord, int(uType), radians(uAngle));\n\n    // check gradient bounds\n    float offsetMin = uStops[0][0];\n    float offsetMax = 0.0;\n\n    int numStops = int(uNumStops);\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (i == numStops-1){ // last index\n            offsetMax = uStops[i][0];\n        }\n    }\n\n    if (y  < offsetMin || y > offsetMax) {\n        finalColor = currentColor;\n        return;\n    }\n\n    // limit colors\n    if (uMaxColors > 0.) {\n        float stepSize = 1./uMaxColors;\n        float stepNumber = float(floor(y/stepSize));\n        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment\n    }\n\n    // find color stops\n    ColorStop from;\n    ColorStop to;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (y >= uStops[i][0]) {\n            from = ColorStop(uStops[i][0], uColors[i], uStops[i][1]);\n            to = ColorStop(uStops[i+1][0], uColors[i+1], uStops[i+1][1]);\n        }\n\n        if (i == numStops-1){ // last index\n            break;\n        }\n    }\n\n    // mix colors from stops\n    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);\n    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);\n\n    float segmentHeight = to.offset - from.offset;\n    float relativePos = y - from.offset;// position from 0 to [segmentHeight]\n    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].\n\n    float gradientAlpha = uAlpha * currentColor.a;\n    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n    if (uReplace < 0.5) {\n        // mix resulting color with current color\n        finalColor = gradientColor + currentColor*(1.-gradientColor.a);\n    } else {\n        // replace with gradient color\n        finalColor = gradientColor;\n    }\n}\n",name:"color-gradient-filter"}),resources:{baseUniforms:{uOptions:{value:[e.type,e.angle??90,e.alpha,e.replace?1:0],type:"vec4<f32>"},uCounts:{value:[e.stops.length,e.maxColors],type:"vec2<f32>"}},stopsUniforms:{uColors:{value:new Float32Array(96),type:"vec3<f32>",size:32},uStops:{value:new Float32Array(128),type:"vec4<f32>",size:32}}}}),Sl(this,"baseUniforms"),Sl(this,"stopsUniforms"),Sl(this,"_stops",[]),this.baseUniforms=this.resources.baseUniforms.uniforms,this.stopsUniforms=this.resources.stopsUniforms.uniforms,Object.assign(this,e)}get stops(){return this._stops}set stops(t){const e=function(t){return[...t].sort(((t,e)=>t.offset-e.offset))}(t),i=new Mt.Q;let n,r,s;for(let t=0;t<e.length;t++){i.setValue(e[t].color);const o=3*t;[n,r,s]=i.toArray(),this.stopsUniforms.uColors[o]=n,this.stopsUniforms.uColors[o+1]=r,this.stopsUniforms.uColors[o+2]=s,this.stopsUniforms.uStops[4*t]=e[t].offset,this.stopsUniforms.uStops[4*t+1]=e[t].alpha}this.baseUniforms.uCounts[0]=e.length,this._stops=e}get type(){return this.baseUniforms.uOptions[0]}set type(t){this.baseUniforms.uOptions[0]=t}get angle(){return this.baseUniforms.uOptions[1]+90}set angle(t){this.baseUniforms.uOptions[1]=t-90}get alpha(){return this.baseUniforms.uOptions[2]}set alpha(t){this.baseUniforms.uOptions[2]=t}get maxColors(){return this.baseUniforms.uCounts[1]}set maxColors(t){this.baseUniforms.uCounts[1]=t}get replace(){return this.baseUniforms.uOptions[3]>.5}set replace(t){this.baseUniforms.uOptions[3]=t?1:0}};Sl(Cl,"LINEAR",0),Sl(Cl,"RADIAL",1),Sl(Cl,"CONIC",2),Sl(Cl,"defaults",{type:Cl.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1});let Al=Cl;var Tl=Object.defineProperty,Pl=(t,e,i)=>(((t,e,i)=>{e in t?Tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Ml=class t extends Et.d{constructor(...e){let i=e[0]??{};if((i instanceof x.g||i instanceof Xt.v)&&((0,d.t6)("6.0.0","ColorMapFilter constructor params are now options object. See params: { colorMap, nearest, mix }"),i={colorMap:i},void 0!==e[1]&&(i.nearest=e[1]),void 0!==e[2]&&(i.mix=e[2])),i={...t.DEFAULT_OPTIONS,...i},!i.colorMap)throw Error("No color map texture source was provided to ColorMapFilter");super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ColorMapUniforms {\n  uMix: f32,\n  uSize: f32,\n  uSliceSize: f32,\n  uSlicePixelSize: f32,\n  uSliceInnerSize: f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> colorMapUniforms : ColorMapUniforms;\n@group(1) @binding(1) var uMapTexture: texture_2d<f32>;\n@group(1) @binding(2) var uMapSampler: sampler;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  var color:vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  var adjusted: vec4<f32>;\n\n  var altColor: vec4<f32> = vec4<f32>(color.rgb / color.a, color.a);\n  let innerWidth: f32 = colorMapUniforms.uSize - 1.0;\n  let zSlice0: f32 = min(floor(color.b * innerWidth), innerWidth);\n  let zSlice1: f32 = min(zSlice0 + 1.0, innerWidth);\n  let xOffset: f32 = colorMapUniforms.uSlicePixelSize * 0.5 + color.r * colorMapUniforms.uSliceInnerSize;\n  let s0: f32 = xOffset + (zSlice0 * colorMapUniforms.uSliceSize);\n  let s1: f32 = xOffset + (zSlice1 * colorMapUniforms.uSliceSize);\n  let yOffset: f32 = colorMapUniforms.uSliceSize * 0.5 + color.g * (1.0 - colorMapUniforms.uSliceSize);\n  let slice0Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s0,yOffset));\n  let slice1Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s1,yOffset));\n  let zOffset: f32 = fract(color.b * innerWidth);\n  adjusted = mix(slice0Color, slice1Color, zOffset);\n  altColor = vec4<f32>(color.rgb * color.a, color.a);\n\n  let realColor: vec4<f32> = select(color, altColor, color.a > 0.0);\n\n  return vec4<f32>(mix(realColor, adjusted, colorMapUniforms.uMix).rgb, realColor.a);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMapTexture;\nuniform float uMix;\nuniform float uSize;\nuniform float uSliceSize;\nuniform float uSlicePixelSize;\nuniform float uSliceInnerSize;\n\nvoid main() {\n    vec4 color = texture(uTexture, vTextureCoord.xy);\n    vec4 adjusted;\n\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n        float innerWidth = uSize - 1.0;\n        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);\n        float zSlice1 = min(zSlice0 + 1.0, innerWidth);\n        float xOffset = uSlicePixelSize * 0.5 + color.r * uSliceInnerSize;\n        float s0 = xOffset + (zSlice0 * uSliceSize);\n        float s1 = xOffset + (zSlice1 * uSliceSize);\n        float yOffset = uSliceSize * 0.5 + color.g * (1.0 - uSliceSize);\n        vec4 slice0Color = texture(uMapTexture, vec2(s0,yOffset));\n        vec4 slice1Color = texture(uMapTexture, vec2(s1,yOffset));\n        float zOffset = fract(color.b * innerWidth);\n        adjusted = mix(slice0Color, slice1Color, zOffset);\n\n        color.rgb *= color.a;\n    }\n\n    finalColor = vec4(mix(color, adjusted, uMix).rgb, color.a);\n\n}",name:"color-map-filter"}),resources:{colorMapUniforms:{uMix:{value:i.mix,type:"f32"},uSize:{value:0,type:"f32"},uSliceSize:{value:0,type:"f32"},uSlicePixelSize:{value:0,type:"f32"},uSliceInnerSize:{value:0,type:"f32"}},uMapTexture:i.colorMap.source,uMapSampler:i.colorMap.source.style}}),Pl(this,"uniforms"),Pl(this,"_size",0),Pl(this,"_sliceSize",0),Pl(this,"_slicePixelSize",0),Pl(this,"_sliceInnerSize",0),Pl(this,"_nearest",!1),Pl(this,"_scaleMode","linear"),Pl(this,"_colorMap"),this.uniforms=this.resources.colorMapUniforms.uniforms,Object.assign(this,i)}get mix(){return this.uniforms.uMix}set mix(t){this.uniforms.uMix=t}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(t){if(!t||t===this.colorMap)return;const e=t instanceof x.g?t.source:t;e.style.scaleMode=this._scaleMode,e.autoGenerateMipmaps=!1,this._size=e.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms.uSize=this._size,this.uniforms.uSliceSize=this._sliceSize,this.uniforms.uSlicePixelSize=this._slicePixelSize,this.uniforms.uSliceInnerSize=this._sliceInnerSize,this.resources.uMapTexture=e,this._colorMap=t}get nearest(){return this._nearest}set nearest(t){this._nearest=t,this._scaleMode=t?"nearest":"linear";const e=this._colorMap;e&&e.source&&(e.source.scaleMode=this._scaleMode,e.source.autoGenerateMipmaps=!1,e.source.style.update(),e.source.update())}updateColorMap(){const t=this._colorMap;t?.source&&(t.source.update(),this.colorMap=t)}destroy(){this._colorMap?.destroy(),super.destroy()}};Pl(Ml,"DEFAULT_OPTIONS",{colorMap:x.g.WHITE,nearest:!1,mix:1});var Il=Object.defineProperty,Ol=(t,e,i)=>(((t,e,i)=>{e in t?Il(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const kl=class t extends Et.d{constructor(...e){let i=e[0]??{};("number"==typeof i||Array.isArray(i)||i instanceof Float32Array)&&((0,d.t6)("6.0.0","ColorOverlayFilter constructor params are now options object. See params: { color, alpha }"),i={color:i},void 0!==e[1]&&(i.alpha=e[1])),i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ColorOverlayUniforms {\n    uColor: vec3<f32>,\n    uAlpha: f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> colorOverlayUniforms : ColorOverlayUniforms;\n\n@fragment\nfn mainFragment(\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n    let c = textureSample(uTexture, uSampler, uv);\n    return vec4<f32>(mix(c.rgb, colorOverlayUniforms.uColor.rgb, c.a * colorOverlayUniforms.uAlpha), c.a);\n}\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec3 uColor;\nuniform float uAlpha;\n\nvoid main(void) {\n    vec4 c = texture(uTexture, vTextureCoord);\n    finalColor = vec4(mix(c.rgb, uColor.rgb, c.a * uAlpha), c.a);\n}\n",name:"color-overlay-filter"}),resources:{colorOverlayUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:i.alpha,type:"f32"}}}}),Ol(this,"uniforms"),Ol(this,"_color"),this.uniforms=this.resources.colorOverlayUniforms.uniforms,this._color=new Mt.Q,this.color=i.color??0}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};Ol(kl,"DEFAULT_OPTIONS",{color:0,alpha:1});var El=Object.defineProperty,Rl=(t,e,i)=>(((t,e,i)=>{e in t?El(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const zl=class t extends Et.d{constructor(...e){let i=e[0]??{};("number"==typeof i||Array.isArray(i)||i instanceof Float32Array)&&((0,d.t6)("6.0.0","ColorReplaceFilter constructor params are now options object. See params: { originalColor, targetColor, tolerance }"),i={originalColor:i},void 0!==e[1]&&(i.targetColor=e[1]),void 0!==e[2]&&(i.tolerance=e[2])),i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ColorReplaceUniforms {\n  uOriginalColor: vec3<f32>,\n  uTargetColor: vec3<f32>,\n  uTolerance: f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> colorReplaceUniforms : ColorReplaceUniforms;\n\n@fragment\nfn mainFragment(\n   @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let sample: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  let colorDiff: vec3<f32> = colorReplaceUniforms.uOriginalColor - (sample.rgb / max(sample.a, 0.0000000001));\n  let colorDistance: f32 = length(colorDiff);\n  let doReplace: f32 = step(colorDistance, colorReplaceUniforms.uTolerance);\n\n  return vec4<f32>(mix(sample.rgb, (colorReplaceUniforms.uTargetColor + colorDiff) * sample.a, doReplace), sample.a);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec3 uOriginalColor;\nuniform vec3 uTargetColor;\nuniform float uTolerance;\n\nvoid main(void) {\n    vec4 c = texture(uTexture, vTextureCoord);\n    vec3 colorDiff = uOriginalColor - (c.rgb / max(c.a, 0.0000000001));\n    float colorDistance = length(colorDiff);\n    float doReplace = step(colorDistance, uTolerance);\n    finalColor = vec4(mix(c.rgb, (uTargetColor + colorDiff) * c.a, doReplace), c.a);\n}\n",name:"color-replace-filter"}),resources:{colorReplaceUniforms:{uOriginalColor:{value:new Float32Array(3),type:"vec3<f32>"},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"},uTolerance:{value:i.tolerance,type:"f32"}}}}),Rl(this,"uniforms"),Rl(this,"_originalColor"),Rl(this,"_targetColor"),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this._originalColor=new Mt.Q,this._targetColor=new Mt.Q,this.originalColor=i.originalColor??16711680,this.targetColor=i.targetColor??0,Object.assign(this,i)}get originalColor(){return this._originalColor.value}set originalColor(t){this._originalColor.setValue(t);const[e,i,n]=this._originalColor.toArray();this.uniforms.uOriginalColor[0]=e,this.uniforms.uOriginalColor[1]=i,this.uniforms.uOriginalColor[2]=n}get targetColor(){return this._targetColor.value}set targetColor(t){this._targetColor.setValue(t);const[e,i,n]=this._targetColor.toArray();this.uniforms.uTargetColor[0]=e,this.uniforms.uTargetColor[1]=i,this.uniforms.uTargetColor[2]=n}get tolerance(){return this.uniforms.uTolerance}set tolerance(t){this.uniforms.uTolerance=t}set newColor(t){(0,d.t6)("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor=t}get newColor(){return(0,d.t6)("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor}set epsilon(t){(0,d.t6)("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance=t}get epsilon(){return(0,d.t6)("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance}};Rl(zl,"DEFAULT_OPTIONS",{originalColor:16711680,targetColor:0,tolerance:.4});var Fl=Object.defineProperty,Ul=(t,e,i)=>(((t,e,i)=>{e in t?Fl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Dl=class t extends Et.d{constructor(...e){let i=e[0]??{};Array.isArray(i)&&((0,d.t6)("6.0.0","ConvolutionFilter constructor params are now options object. See params: { matrix, width, height }"),i={matrix:i},void 0!==e[1]&&(i.width=e[1]),void 0!==e[2]&&(i.height=e[2])),i={...t.DEFAULT_OPTIONS,...i};const n=i.width??200,r=i.height??200;super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ConvolutionUniforms {\n    uMatrix: mat3x3<f32>,\n    uTexelSize: vec2<f32>,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> convolutionUniforms : ConvolutionUniforms;\n\n@fragment\nfn mainFragment(\n    @location(0) uv: vec2<f32>,\n    @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n    let texelSize = convolutionUniforms.uTexelSize;\n    let matrix = convolutionUniforms.uMatrix;\n\n    let c11: vec4<f32> = textureSample(uTexture, uSampler, uv - texelSize); // top left\n    let c12: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y - texelSize.y)); // top center\n    let c13: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y - texelSize.y)); // top right\n\n    let c21: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y)); // mid left\n    let c22: vec4<f32> = textureSample(uTexture, uSampler, uv); // mid center\n    let c23: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y)); // mid right\n\n    let c31: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y + texelSize.y)); // bottom left\n    let c32: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y + texelSize.y)); // bottom center\n    let c33: vec4<f32> = textureSample(uTexture, uSampler, uv + texelSize); // bottom right\n\n    var finalColor: vec4<f32> = vec4<f32>(\n        c11 * matrix[0][0] + c12 * matrix[0][1] + c13 * matrix[0][2] +\n        c21 * matrix[1][0] + c22 * matrix[1][1] + c23 * matrix[1][2] +\n        c31 * matrix[2][0] + c32 * matrix[2][1] + c33 * matrix[2][2]\n    );\n\n    finalColor.a = c22.a;\n\n    return finalColor;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uTexelSize;\nuniform mat3 uMatrix;\n\nvoid main(void)\n{\n    vec4 c11 = texture(uTexture, vTextureCoord - uTexelSize); // top left\n    vec4 c12 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y - uTexelSize.y)); // top center\n    vec4 c13 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y - uTexelSize.y)); // top right\n\n    vec4 c21 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y)); // mid left\n    vec4 c22 = texture(uTexture, vTextureCoord); // mid center\n    vec4 c23 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y)); // mid right\n\n    vec4 c31 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y + uTexelSize.y)); // bottom left\n    vec4 c32 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y + uTexelSize.y)); // bottom center\n    vec4 c33 = texture(uTexture, vTextureCoord + uTexelSize); // bottom right\n\n    finalColor =\n        c11 * uMatrix[0][0] + c12 * uMatrix[0][1] + c13 * uMatrix[0][2] +\n        c21 * uMatrix[1][0] + c22 * uMatrix[1][1] + c23 * uMatrix[1][2] +\n        c31 * uMatrix[2][0] + c32 * uMatrix[2][1] + c33 * uMatrix[2][2];\n\n    finalColor.a = c22.a;\n}",name:"convolution-filter"}),resources:{convolutionUniforms:{uMatrix:{value:i.matrix,type:"mat3x3<f32>"},uTexelSize:{value:{x:1/n,y:1/r},type:"vec2<f32>"}}}}),Ul(this,"uniforms"),this.uniforms=this.resources.convolutionUniforms.uniforms,this.width=n,this.height=r}get matrix(){return this.uniforms.uMatrix}set matrix(t){t.forEach(((t,e)=>{this.uniforms.uMatrix[e]=t}))}get width(){return 1/this.uniforms.uTexelSize.x}set width(t){this.uniforms.uTexelSize.x=1/t}get height(){return 1/this.uniforms.uTexelSize.y}set height(t){this.uniforms.uTexelSize.y=1/t}};Ul(Dl,"DEFAULT_OPTIONS",{matrix:new Float32Array(9),width:200,height:200});Et.d;var Bl=Object.defineProperty,Ll=(t,e,i)=>(((t,e,i)=>{e in t?Bl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Nl=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct CRTUniforms {\n    uLine: vec4<f32>,\n    uNoise: vec2<f32>,\n    uVignette: vec3<f32>,\n    uSeed: f32,\n    uTime: f32,\n    uDimensions: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n    \n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;\n\n  let uNoise = crtUniforms.uNoise;\n\n  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)\n  {\n    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);\n  }\n\n  if (crtUniforms.uVignette[0] > 0.)\n  {\n    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);\n  }\n\n  if (crtUniforms.uLine[1] > 0.0)\n  {\n    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  \n  }\n\n  return color;\n}\n\nconst SQRT_2: f32 = 1.414213;\n\nfn modulo(x: f32, y: f32) -> f32\n{\n  return x - y * floor(x/y);\n}\n\nfn rand(co: vec2<f32>) -> f32\n{\n  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);\n}\n\nfn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32\n{\n  let uVignette = crtUniforms.uVignette;\n  let uDimensions = crtUniforms.uDimensions;\n  \n  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;\n  var dir: vec2<f32> = vec2<f32>(0.5) - coord;\n  dir.y *= uDimensions.y / uDimensions.x;\n  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);\n  return darker + (1.0 - darker) * (1.0 - uVignette[1]);\n}\n\nfn noise(coord: vec2<f32>) -> f32\n{\n  let uNoise = crtUniforms.uNoise;\n  let uSeed = crtUniforms.uSeed;\n\n  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;\n  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);\n  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);\n  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];\n}\n\nfn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>\n{\n  var color = co;\n\n  let uDimensions = crtUniforms.uDimensions;\n\n  let curvature: f32 = crtUniforms.uLine[0];\n  let lineWidth: f32 = crtUniforms.uLine[1];\n  let lineContrast: f32 = crtUniforms.uLine[2];\n  let verticalLine: f32 = crtUniforms.uLine[3];\n\n  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);\n\n  let _c: f32 = select(1., curvature, curvature > 0.);\n  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);\n  let uv: vec2<f32> = dir * k;\n  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;\n  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;\n  color *= j;\n\n  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);\n  color *= 0.99 + ceil(segment) * 0.015;\n\n  return color;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec4 uLine;\nuniform vec2 uNoise;\nuniform vec3 uVignette;\nuniform float uSeed;\nuniform float uTime;\nuniform vec2 uDimensions;\n\nuniform vec4 uInputSize;\n\nconst float SQRT_2 = 1.414213;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat vignette(vec3 co, vec2 coord)\n{\n    float outter = SQRT_2 - uVignette[0] * SQRT_2;\n    vec2 dir = vec2(0.5) - coord;\n    dir.y *= uDimensions.y / uDimensions.x;\n    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);\n    return darker + (1.0 - darker) * (1.0 - uVignette[1]);\n}\n\nfloat noise(vec2 coord)\n{\n    vec2 pixelCoord = coord * uInputSize.xy;\n    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);\n    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);\n    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];\n}\n\nvec3 interlaceLines(vec3 co, vec2 coord)\n{\n    vec3 color = co;\n\n    float curvature = uLine[0];\n    float lineWidth = uLine[1];\n    float lineContrast = uLine[2];\n    float verticalLine = uLine[3];\n\n    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);\n\n    float _c = curvature > 0. ? curvature : 1.;\n    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n    vec2 uv = dir * k;\n    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;\n    v *= min(1.0, 2.0 / lineWidth ) / _c;\n    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;\n    color *= j;\n\n    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);\n    color *= 0.99 + ceil(segment) * 0.015;\n\n    return color;\n}\n\nvoid main(void)\n{\n    finalColor = texture(uTexture, vTextureCoord);\n    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;\n\n    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)\n    {\n        float n = noise(vTextureCoord);\n        finalColor += vec4(n, n, n, finalColor.a);\n    }\n\n    if (uVignette[0] > 0.)\n    {\n        float v = vignette(finalColor.rgb, coord);\n        finalColor *= vec4(v, v, v, finalColor.a);\n    }\n\n    if (uLine[1] > 0.0)\n    {\n        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  \n    }\n}\n",name:"crt-filter"}),resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Ll(this,"uniforms"),Ll(this,"seed"),Ll(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,e)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get curvature(){return this.uniforms.uLine[0]}set curvature(t){this.uniforms.uLine[0]=t}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(t){this.uniforms.uLine[1]=t}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(t){this.uniforms.uLine[2]=t}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(t){this.uniforms.uLine[3]=t?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(t){this.uniforms.uNoise[0]=t}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(t){this.uniforms.uNoise[1]=t}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(t){this.uniforms.uVignette[0]=t}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(t){this.uniforms.uVignette[1]=t}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(t){this.uniforms.uVignette[2]=t}};Ll(Nl,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});var $l=Object.defineProperty;const Vl=class t extends Et.d{constructor(...e){let i=e[0]??{};"number"==typeof i&&((0,d.t6)("6.0.0","DotFilter constructor params are now options object. See params: { scale, angle, grayscale }"),i={scale:i},void 0!==e[1]&&(i.angle=e[1]),void 0!==e[2]&&(i.grayscale=e[2])),i={...t.DEFAULT_OPTIONS,...i};const n={uScale:{value:i.scale,type:"f32"},uAngle:{value:i.angle,type:"f32"},uGrayScale:{value:i.grayscale?1:0,type:"f32"}};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct DotUniforms {\n  uScale:f32,\n  uAngle:f32,\n  uGrayScale:f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> dotUniforms : DotUniforms;\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let gray: vec3<f32> = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)));\n  // dotUniforms.uGrayScale == 1 doesn't ever pass so it is converted to a float and compared to 0.5 instead \n  let finalColor: vec3<f32> = select(color.rgb, gray, f32(dotUniforms.uGrayScale) >= 0.5);\n\n  return vec4<f32>(finalColor * 10.0 - 5.0 + pattern(uv), color.a);\n}\n\nfn pattern(uv: vec2<f32>) -> f32\n{\n  let s: f32 = sin(dotUniforms.uAngle);\n  let c: f32 = cos(dotUniforms.uAngle);\n  \n  let tex: vec2<f32> = uv * gfu.uInputSize.xy;\n  \n  let p: vec2<f32> = vec2<f32>(\n      c * tex.x - s * tex.y,\n      s * tex.x + c * tex.y\n  ) * dotUniforms.uScale;\n\n  return (sin(p.x) * sin(p.y)) * 4.0;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uAngle;\nuniform float uScale;\nuniform bool uGrayScale;\n\nuniform vec4 uInputSize;\n\nfloat pattern()\n{\n    float s = sin(uAngle), c = cos(uAngle);\n    vec2 tex = vTextureCoord * uInputSize.xy;\n    vec2 point = vec2(\n        c * tex.x - s * tex.y,\n        s * tex.x + c * tex.y\n    ) * uScale;\n    return (sin(point.x) * sin(point.y)) * 4.0;\n    }\n\n    void main()\n    {\n    vec4 color = texture(uTexture, vTextureCoord);\n    vec3 colorRGB = vec3(color);\n\n    if (uGrayScale)\n    {\n        colorRGB = vec3(color.r + color.g + color.b) / 3.0;\n    }\n\n    finalColor = vec4(colorRGB * 10.0 - 5.0 + pattern(), color.a);\n}\n",name:"dot-filter"}),resources:{dotUniforms:n}})}get scale(){return this.resources.dotUniforms.uniforms.uScale}set scale(t){this.resources.dotUniforms.uniforms.uScale=t}get angle(){return this.resources.dotUniforms.uniforms.uAngle}set angle(t){this.resources.dotUniforms.uniforms.uAngle=t}get grayscale(){return 1===this.resources.dotUniforms.uniforms.uGrayScale}set grayscale(t){this.resources.dotUniforms.uniforms.uGrayScale=t?1:0}};var Gl;((t,e,i)=>{e in t?$l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(Vl,"symbol"!=typeof(Gl="DEFAULT_OPTIONS")?Gl+"":Gl,{scale:1,angle:5,grayscale:!0});var jl=Object.defineProperty,Hl=(t,e,i)=>(((t,e,i)=>{e in t?jl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Wl=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct DropShadowUniforms {\n  uAlpha: f32,\n  uColor: vec3<f32>,\n  uOffset: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> dropShadowUniforms : DropShadowUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv - dropShadowUniforms.uOffset * gfu.uInputSize.zw);\n\n  // Premultiply alpha\n  color = vec4<f32>(vec3<f32>(dropShadowUniforms.uColor.rgb * color.a), color.a);\n  // alpha user alpha\n  color *= dropShadowUniforms.uAlpha;\n\n  return color;\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uAlpha;\nuniform vec3 uColor;\nuniform vec2 uOffset;\n\nuniform vec4 uInputSize;\n\nvoid main(void){\n    vec4 sample = texture(uTexture, vTextureCoord - uOffset * uInputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = uColor.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= uAlpha;\n\n    finalColor = sample;\n}",name:"drop-shadow-filter"}),resources:{dropShadowUniforms:{uAlpha:{value:e.alpha,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},resolution:e.resolution}),Hl(this,"uniforms"),Hl(this,"shadowOnly",!1),Hl(this,"_color"),Hl(this,"_blurFilter"),Hl(this,"_basePass"),this.uniforms=this.resources.dropShadowUniforms.uniforms,this._color=new Mt.Q,this.color=e.color??0,this._blurFilter=new qa({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),this._basePass=new Et.d({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"\n                    @group(0) @binding(1) var uTexture: texture_2d<f32>; \n                    @group(0) @binding(2) var uSampler: sampler;\n                    @fragment\n                    fn mainFragment(\n                        @builtin(position) position: vec4<f32>,\n                        @location(0) uv : vec2<f32>\n                    ) -> @location(0) vec4<f32> {\n                        return textureSample(uTexture, uSampler, uv);\n                    }\n                    ",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"\n                in vec2 vTextureCoord;\n                out vec4 finalColor;\n                uniform sampler2D uTexture;\n\n                void main(void){\n                    finalColor = texture(uTexture, vTextureCoord);\n                }\n                ",name:"drop-shadow-filter"}),resources:{}}),Object.assign(this,e)}apply(t,e,i,n){const r=Ut.W.getSameSizeTexture(e);t.applyFilter(this,e,r,!0),this._blurFilter.apply(t,r,i,n),this.shadowOnly||t.applyFilter(this._basePass,e,i,!1),Ut.W.returnTexture(r)}get offset(){return this.uniforms.uOffset}set offset(t){this.uniforms.uOffset=t,this._updatePadding()}get offsetX(){return this.offset.x}set offsetX(t){this.offset.x=t,this._updatePadding()}get offsetY(){return this.offset.y}set offsetY(t){this.offset.y=t,this._updatePadding()}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get blur(){return this._blurFilter.strength}set blur(t){this._blurFilter.strength=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t,this._updatePadding()}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){"number"==typeof t&&(t={x:t,y:t}),Array.isArray(t)&&(t={x:t[0],y:t[1]}),this._blurFilter.pixelSize=t}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(t){this._blurFilter.pixelSizeX=t}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(t){this._blurFilter.pixelSizeY=t}_updatePadding(){const t=Math.max(Math.abs(this.offsetX),Math.abs(this.offsetY));this.padding=t+2*this.blur+4*this.quality}};Hl(Wl,"DEFAULT_OPTIONS",{offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:void 0,blur:2,quality:3,pixelSize:{x:1,y:1},resolution:1});let Xl=Wl;Object.defineProperty;Et.d;var Yl=Object.defineProperty,ql=(t,e,i)=>(((t,e,i)=>{e in t?Yl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Kl=class t extends Et.d{constructor(e){e={...t.defaults,...e};const i=Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct GlitchUniforms {\n  uSeed: f32,\n  uDimensions: vec2<f32>,\n  uAspect: f32,\n  uFillMode: f32,\n  uOffset: f32,\n  uDirection: f32,\n  uRed: vec2<f32>,\n  uGreen: vec2<f32>,\n  uBlue: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> glitchUniforms : GlitchUniforms;\n@group(1) @binding(1) var uDisplacementMap: texture_2d<f32>; \n@group(1) @binding(2) var uDisplacementSampler: sampler; \n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uSeed: f32 = glitchUniforms.uSeed;\n  let uDimensions: vec2<f32> = glitchUniforms.uDimensions;\n  let uAspect: f32 = glitchUniforms.uAspect;\n  let uOffset: f32 = glitchUniforms.uOffset;\n  let uDirection: f32 = glitchUniforms.uDirection;\n  let uRed: vec2<f32> = glitchUniforms.uRed;\n  let uGreen: vec2<f32> = glitchUniforms.uGreen;\n  let uBlue: vec2<f32> = glitchUniforms.uBlue;\n\n  let uInputSize: vec4<f32> = gfu.uInputSize;\n  let uInputClamp: vec4<f32> = gfu.uInputClamp;\n\n  var discarded: bool = false;\n  var coord: vec2<f32> = (uv * uInputSize.xy) / uDimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n      discarded = true;\n    }\n\n    let sinDir: f32 = sin(uDirection);\n    let cosDir: f32 = cos(uDirection);\n\n    let cx: f32 = coord.x - 0.5;\n    let cy: f32 = (coord.y - 0.5) * uAspect;\n    var ny: f32 = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;\n\n    ny = select(select(ny, -ny, ny < 0.0), 2.0 - ny, ny > 1.0);\n\n    let dc: vec4<f32> = textureSample(uDisplacementMap, uDisplacementSampler, vec2<f32>(0.5, ny));\n\n    let displacement: f32 = (dc.r - dc.g) * (uOffset / uInputSize.x);\n\n    coord = uv + vec2<f32>(cosDir * displacement, sinDir * displacement * uAspect);\n\n    let fillMode: i32 = i32(glitchUniforms.uFillMode);\n\n    if (fillMode == CLAMP) {\n      coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);\n    } else {\n      if (coord.x > uInputClamp.z) {\n        if (fillMode == TRANSPARENT) {\n          discarded = true;\n        } else if (fillMode == LOOP) {\n          coord.x = coord.x - uInputClamp.z;\n        } else if (fillMode == MIRROR) {\n          coord.x = uInputClamp.z * 2.0 - coord.x;\n        }\n      } else if (coord.x < uInputClamp.x) {\n        if (fillMode == TRANSPARENT) {\n          discarded = true;\n        } else if (fillMode == LOOP) {\n          coord.x = coord.x + uInputClamp.z;\n        } else if (fillMode == MIRROR) {\n          coord.x = coord.x * -uInputClamp.z;\n        }\n      }\n\n      if (coord.y > uInputClamp.w) {\n        if (fillMode == TRANSPARENT) {\n          discarded = true;\n        } else if (fillMode == LOOP) {\n          coord.y = coord.y - uInputClamp.w;\n        } else if (fillMode == MIRROR) {\n          coord.y = uInputClamp.w * 2.0 - coord.y;\n        }\n      } else if (coord.y < uInputClamp.y) {\n        if (fillMode == TRANSPARENT) {\n          discarded = true;\n        } else if (fillMode == LOOP) {\n          coord.y = coord.y + uInputClamp.w;\n        } else if (fillMode == MIRROR) {\n          coord.y = coord.y * -uInputClamp.w;\n        }\n      }\n    }\n\n    let seedR: f32 = 1.0 - uSeed * 0.4;\n    let seedG: f32 = 1.0 - uSeed * 0.3;\n    let seedB: f32 = 1.0 - uSeed * 0.2;\n\n    let offsetR: vec2<f32> = vec2(uRed.x * seedR / uInputSize.x, uRed.y * seedR / uInputSize.y);\n    let offsetG: vec2<f32> = vec2(uGreen.x * seedG / uInputSize.x, uGreen.y * seedG / uInputSize.y);\n    let offsetB: vec2<f32> = vec2(uBlue.x * seedB / uInputSize.x, uBlue.y * seedB / uInputSize.y);\n\n    let r = textureSample(uTexture, uSampler, coord + offsetR).r;\n    let g = textureSample(uTexture, uSampler, coord + offsetG).g;\n    let b = textureSample(uTexture, uSampler, coord + offsetB).b;\n    let a = textureSample(uTexture, uSampler, coord).a;\n\n    return select(vec4<f32>(r, g, b, a), vec4<f32>(0.0,0.0,0.0,0.0), discarded);\n}\n\nconst TRANSPARENT: i32 = 0;\nconst ORIGINAL: i32 = 1;\nconst LOOP: i32 = 2;\nconst CLAMP: i32 = 3;\nconst MIRROR: i32 = 4;",entryPoint:"mainFragment"}}),n=It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform sampler2D uDisplacementMap;\nuniform float uSeed;\nuniform vec2 uDimensions;\nuniform float uAspect;\nuniform float uFillMode;\nuniform float uOffset;\nuniform float uDirection;\nuniform vec2 uRed;\nuniform vec2 uGreen;\nuniform vec2 uBlue;\n\nuniform vec4 uInputSize;\nuniform vec4 uInputClamp;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * uInputSize.xy) / uDimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float sinDir = sin(uDirection);\n    float cosDir = cos(uDirection);\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * uAspect;\n    float ny = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture(uDisplacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (uOffset / uInputSize.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * uAspect);\n\n    int fillMode = int(uFillMode);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);\n    } else {\n        if( coord.x > uInputClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= uInputClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = uInputClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < uInputClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += uInputClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -uInputClamp.z;\n            }\n        }\n\n        if( coord.y > uInputClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= uInputClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = uInputClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < uInputClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += uInputClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -uInputClamp.w;\n            }\n        }\n    }\n\n    finalColor.r = texture(uTexture, coord + uRed * (1.0 - uSeed * 0.4) / uInputSize.xy).r;\n    finalColor.g = texture(uTexture, coord + uGreen * (1.0 - uSeed * 0.3) / uInputSize.xy).g;\n    finalColor.b = texture(uTexture, coord + uBlue * (1.0 - uSeed * 0.2) / uInputSize.xy).b;\n    finalColor.a = texture(uTexture, coord).a;\n}\n",name:"glitch-filter"}),r=document.createElement("canvas");r.width=4,r.height=e.sampleSize??512;const s=new x.g({source:new it.b({resource:r})});super({gpuProgram:i,glProgram:n,resources:{glitchUniforms:{uSeed:{value:e?.seed??0,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"},uAspect:{value:1,type:"f32"},uFillMode:{value:e?.fillMode??0,type:"f32"},uOffset:{value:e?.offset??100,type:"f32"},uDirection:{value:e?.direction??0,type:"f32"},uRed:{value:e.red,type:"vec2<f32>"},uGreen:{value:e.green,type:"vec2<f32>"},uBlue:{value:e.blue,type:"vec2<f32>"}},uDisplacementMap:s.source,uDisplacementSampler:s.source.style}}),ql(this,"uniforms"),ql(this,"average",!1),ql(this,"minSize",8),ql(this,"sampleSize",512),ql(this,"_canvas"),ql(this,"texture"),ql(this,"_slices",0),ql(this,"_sizes",new Float32Array(1)),ql(this,"_offsets",new Float32Array(1)),this.uniforms=this.resources.glitchUniforms.uniforms,this._canvas=r,this.texture=s,Object.assign(this,e)}apply(t,e,i,n){const{width:r,height:s}=e.frame;this.uniforms.uDimensions[0]=r,this.uniforms.uDimensions[1]=s,this.uniforms.uAspect=s/r,t.applyFilter(this,e,i,n)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,i=this.sampleSize,n=Math.min(this.minSize/i,.9/this._slices);if(this.average){const i=this._slices;let r=1;for(let s=0;s<e;s++){const e=r/(i-s),o=Math.max(e*(1-.6*Math.random()),n);t[s]=o,r-=o}t[e]=r}else{let i=1;const r=Math.sqrt(1/this._slices);for(let s=0;s<e;s++){const e=Math.max(r*i*Math.random(),n);t[s]=e,i-=e}t[e]=i}this.shuffle()}shuffle(){const t=this._sizes;for(let e=this._slices-1;e>0;e--){const i=Math.random()*e|0,n=t[e];t[e]=t[i],t[i]=n}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,i=this._canvas.getContext("2d");let n;i.clearRect(0,0,8,t);let r=0;for(let e=0;e<this._slices;e++){n=Math.floor(256*this._offsets[e]);const s=this._sizes[e]*t,o=n>0?n:0,a=n<0?-n:0;i.fillStyle=`rgba(${o}, ${a}, 0, 1)`,i.fillRect(0,r|0,t,s+1|0),r+=s}e.source.update()}set sizes(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._sizes[i]=t[i]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._offsets[i]=t[i]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this._sizes=new Float32Array(t),this._offsets=new Float32Array(t),this.refresh())}get offset(){return this.uniforms.uOffset}set offset(t){this.uniforms.uOffset=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}get fillMode(){return this.uniforms.uFillMode}set fillMode(t){this.uniforms.uFillMode=t}get direction(){return this.uniforms.uDirection/jt.Td}set direction(t){this.uniforms.uDirection=t*jt.Td}get red(){return this.uniforms.uRed}set red(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uRed=t}get green(){return this.uniforms.uGreen}set green(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uGreen=t}get blue(){return this.uniforms.uBlue}set blue(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uBlue=t}destroy(){this.texture?.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};ql(Kl,"defaults",{slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:{x:0,y:0},green:{x:0,y:0},blue:{x:0,y:0},minSize:8,sampleSize:512});var Zl=Object.defineProperty,Ql=(t,e,i)=>(((t,e,i)=>{e in t?Zl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Jl=class t extends Et.d{constructor(e){const i=(e={...t.DEFAULT_OPTIONS,...e}).distance??10,n=e.quality??.1;super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct GlowUniforms {\n  uDistance: f32,\n  uStrength: vec2<f32>,\n  uColor: vec3<f32>,\n  uAlpha: f32,\n  uQuality: f32,\n  uKnockout: f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> glowUniforms : GlowUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let quality = glowUniforms.uQuality;\n  let distance = glowUniforms.uDistance;\n\n  let dist: f32 = glowUniforms.uDistance;\n  let angleStepSize: f32 = min(1. / quality / distance, PI * 2.0);\n  let angleStepNum: f32 = ceil(PI * 2.0 / angleStepSize);\n\n  let px: vec2<f32> = vec2<f32>(1.0 / gfu.uInputSize.xy);\n\n  var totalAlpha: f32 = 0.0;\n\n  var direction: vec2<f32>;\n  var displaced: vec2<f32>;\n  var curColor: vec4<f32>;\n\n  for (var angle = 0.0; angle < PI * 2.0; angle += angleStepSize) {\n    direction = vec2<f32>(cos(angle), sin(angle)) * px;\n    for (var curDistance = 0.0; curDistance < dist; curDistance+=1) {\n      displaced = vec2<f32>(clamp(uv + direction * (curDistance + 1.0), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n      curColor = textureSample(uTexture, uSampler, displaced);\n      totalAlpha += (dist - curDistance) * curColor.a;\n    }\n  }\n    \n  curColor = textureSample(uTexture, uSampler, uv);\n\n  let glowColorRGB = glowUniforms.uColor;\n  let glowAlpha = glowUniforms.uAlpha;\n  let glowColor = vec4<f32>(glowColorRGB, glowAlpha);\n  let knockout: bool = glowUniforms.uKnockout > 0.5;\n  let innerStrength = glowUniforms.uStrength[0];\n  let outerStrength = glowUniforms.uStrength[1];\n\n  let alphaRatio: f32 = (totalAlpha / (angleStepNum * dist * (dist + 1.0) / 2.0));\n  let innerGlowAlpha: f32 = (1.0 - alphaRatio) * innerStrength * curColor.a * glowAlpha;\n  let innerGlowStrength: f32 = min(1.0, innerGlowAlpha);\n  \n  let innerColor: vec4<f32> = mix(curColor, glowColor, innerGlowStrength);\n  let outerGlowAlpha: f32 = alphaRatio * outerStrength * (1. - curColor.a) * glowAlpha;\n  let outerGlowStrength: f32 = min(1.0 - innerColor.a, outerGlowAlpha);\n  let outerGlowColor: vec4<f32> = outerGlowStrength * glowColor.rgba;\n  \n  if (knockout) {\n    let resultAlpha: f32 = outerGlowAlpha + innerGlowAlpha;\n    return vec4<f32>(glowColor.rgb * resultAlpha, resultAlpha);\n  }\n  else {\n    return innerColor + outerGlowColor;\n  }\n}\n\nconst PI: f32 = 3.14159265358979323846264;",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uStrength;\nuniform vec3 uColor;\nuniform float uKnockout;\nuniform float uAlpha;\n\nuniform vec4 uInputSize;\nuniform vec4 uInputClamp;\n\nconst float PI = 3.14159265358979323846264;\n\n// Hard-assignment of DIST and ANGLE_STEP_SIZE instead of using uDistance and uQuality to allow them to be use on GLSL loop conditions\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.);\nconst float ANGLE_STEP_NUM = ceil(PI * 2. / ANGLE_STEP_SIZE);\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.) / 2.;\n\nvoid main(void) {\n    vec2 px = vec2(1.) / uInputSize.xy;\n\n    float totalAlpha = 0.;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.; angle < PI * 2.; angle += ANGLE_STEP_SIZE) {\n      direction = vec2(cos(angle), sin(angle)) * px;\n\n      for (float curDistance = 0.; curDistance < DIST; curDistance++) {\n          displaced = clamp(vTextureCoord + direction * (curDistance + 1.), uInputClamp.xy, uInputClamp.zw);\n          curColor = texture(uTexture, displaced);\n          totalAlpha += (DIST - curDistance) * curColor.a;\n      }\n    }\n    \n    curColor = texture(uTexture, vTextureCoord);\n\n    vec4 glowColor = vec4(uColor, uAlpha);\n    bool knockout = uKnockout > .5;\n    float innerStrength = uStrength[0];\n    float outerStrength = uStrength[1];\n\n    float alphaRatio = totalAlpha / MAX_TOTAL_ALPHA;\n    float innerGlowAlpha = (1. - alphaRatio) * innerStrength * curColor.a * uAlpha;\n    float innerGlowStrength = min(1., innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a) * uAlpha;\n    float outerGlowStrength = min(1. - innerColor.a, outerGlowAlpha);\n    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;\n\n    if (knockout) {\n      float resultAlpha = outerGlowAlpha + innerGlowAlpha;\n      finalColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      finalColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,`${(1/n/i).toFixed(7)}`).replace(/__DIST__/gi,`${i.toFixed(0)}.0`),name:"glow-filter"}),resources:{glowUniforms:{uDistance:{value:i,type:"f32"},uStrength:{value:[e.innerStrength,e.outerStrength],type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:e.alpha,type:"f32"},uQuality:{value:n,type:"f32"},uKnockout:{value:e?.knockout?1:0,type:"f32"}}},padding:i}),Ql(this,"uniforms"),Ql(this,"_color"),this.uniforms=this.resources.glowUniforms.uniforms,this._color=new Mt.Q,this.color=e.color??16777215}get distance(){return this.uniforms.uDistance}set distance(t){this.uniforms.uDistance=this.padding=t}get innerStrength(){return this.uniforms.uStrength[0]}set innerStrength(t){this.uniforms.uStrength[0]=t}get outerStrength(){return this.uniforms.uStrength[1]}set outerStrength(t){this.uniforms.uStrength[1]=t}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get quality(){return this.uniforms.uQuality}set quality(t){this.uniforms.uQuality=t}get knockout(){return 1===this.uniforms.uKnockout}set knockout(t){this.uniforms.uKnockout=t?1:0}};Ql(Jl,"DEFAULT_OPTIONS",{distance:10,outerStrength:4,innerStrength:0,color:16777215,alpha:1,quality:.1,knockout:!1});var tu=Object.defineProperty,eu=(t,e,i)=>(((t,e,i)=>{e in t?tu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const iu=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct GodrayUniforms {\n  uLight: vec2<f32>,\n  uParallel: f32,\n  uAspect: f32,\n  uTime: f32,\n  uRay: vec3<f32>,\n  uDimensions: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> godrayUniforms : GodrayUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uDimensions: vec2<f32> = godrayUniforms.uDimensions;\n  let uParallel: bool = godrayUniforms.uParallel > 0.5;\n  let uLight: vec2<f32> = godrayUniforms.uLight;\n  let uAspect: f32 = godrayUniforms.uAspect;\n\n  let coord: vec2<f32> = uv * gfu.uInputSize.xy / uDimensions;\n\n  var d: f32;\n\n  if (uParallel) {\n    let _cos: f32 = uLight.x;\n    let _sin: f32 = uLight.y;\n    d = (_cos * coord.x) + (_sin * coord.y * uAspect);\n  } else {\n    let dx: f32 = coord.x - uLight.x / uDimensions.x;\n    let dy: f32 = (coord.y - uLight.y / uDimensions.y) * uAspect;\n    let dis: f32 = sqrt(dx * dx + dy * dy) + 0.00001;\n    d = dy / dis;\n  }\n\n  let uTime: f32 = godrayUniforms.uTime;\n  let uRay: vec3<f32> = godrayUniforms.uRay;\n  \n  let gain = uRay[0];\n  let lacunarity = uRay[1];\n  let alpha = uRay[2];\n\n  let dir: vec3<f32> = vec3<f32>(d, d, 0.0);\n  var noise: f32 = turb(dir + vec3<f32>(uTime, 0.0, 62.1 + uTime) * 0.05, vec3<f32>(480.0, 320.0, 480.0), lacunarity, gain);\n  noise = mix(noise, 0.0, 0.3);\n  //fade vertically.\n  var mist: vec4<f32> = vec4<f32>(vec3<f32>(noise), 1.0) * (1.0 - coord.y);\n  mist.a = 1.0;\n  // apply user alpha\n  mist *= alpha;\n  return textureSample(uTexture, uSampler, uv) + mist;\n}\n\n${PERLIN}".replace("${PERLIN}","// Taken from https://gist.github.com/munrocket/236ed5ba7e409b8bdf1ff6eca5dcdc39\n\nfn moduloVec3(x: vec3<f32>, y: vec3<f32>) -> vec3<f32>\n{\n  return x - y * floor(x/y);\n}\nfn mod289Vec3(x: vec3<f32>) -> vec3<f32>\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nfn mod289Vec4(x: vec4<f32>) -> vec4<f32>\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nfn permute4(x: vec4<f32>) -> vec4<f32>\n{\n    return mod289Vec4(((x * 34.0) + 1.0) * x);\n}\nfn taylorInvSqrt(r: vec4<f32>) -> vec4<f32>\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nfn fade3(t: vec3<f32>) -> vec3<f32>\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\nfn fade2(t: vec2<f32>) -> vec2<f32> { return t * t * t * (t * (t * 6. - 15.) + 10.); }\n\nfn perlinNoise2(P: vec2<f32>) -> f32 {\n  var Pi: vec4<f32> = floor(P.xyxy) + vec4<f32>(0., 0., 1., 1.);\n  let Pf = fract(P.xyxy) - vec4<f32>(0., 0., 1., 1.);\n  Pi = Pi % vec4<f32>(289.); // To avoid truncation effects in permutation\n  let ix = Pi.xzxz;\n  let iy = Pi.yyww;\n  let fx = Pf.xzxz;\n  let fy = Pf.yyww;\n  let i = permute4(permute4(ix) + iy);\n  var gx: vec4<f32> = 2. * fract(i * 0.0243902439) - 1.; // 1/41 = 0.024...\n  let gy = abs(gx) - 0.5;\n  let tx = floor(gx + 0.5);\n  gx = gx - tx;\n  var g00: vec2<f32> = vec2<f32>(gx.x, gy.x);\n  var g10: vec2<f32> = vec2<f32>(gx.y, gy.y);\n  var g01: vec2<f32> = vec2<f32>(gx.z, gy.z);\n  var g11: vec2<f32> = vec2<f32>(gx.w, gy.w);\n  let norm = 1.79284291400159 - 0.85373472095314 *\n      vec4<f32>(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));\n  g00 = g00 * norm.x;\n  g01 = g01 * norm.y;\n  g10 = g10 * norm.z;\n  g11 = g11 * norm.w;\n  let n00 = dot(g00, vec2<f32>(fx.x, fy.x));\n  let n10 = dot(g10, vec2<f32>(fx.y, fy.y));\n  let n01 = dot(g01, vec2<f32>(fx.z, fy.z));\n  let n11 = dot(g11, vec2<f32>(fx.w, fy.w));\n  let fade_xy = fade2(Pf.xy);\n  let n_x = mix(vec2<f32>(n00, n01), vec2<f32>(n10, n11), vec2<f32>(fade_xy.x));\n  let n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\n// Classic Perlin noise, periodic variant\nfn perlinNoise3(P: vec3<f32>, rep: vec3<f32>) -> f32\n{\n    var Pi0: vec3<f32> = moduloVec3(floor(P), rep); // Integer part, modulo period\n    var Pi1: vec3<f32> = moduloVec3(Pi0 + vec3<f32>(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289Vec3(Pi0);\n    Pi1 = mod289Vec3(Pi1);\n    let Pf0: vec3<f32> = fract(P); // Fractional part for interpolation\n    let Pf1: vec3<f32> = Pf0 - vec3<f32>(1.0); // Fractional part - 1.0\n    let ix: vec4<f32> = vec4<f32>(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    let iy: vec4<f32> = vec4<f32>(Pi0.yy, Pi1.yy);\n    let iz0: vec4<f32> = Pi0.zzzz;\n    let iz1: vec4<f32> = Pi1.zzzz;\n    let ixy: vec4<f32> = permute4(permute4(ix) + iy);\n    let ixy0: vec4<f32> = permute4(ixy + iz0);\n    let ixy1: vec4<f32> = permute4(ixy + iz1);\n    var gx0: vec4<f32> = ixy0 * (1.0 / 7.0);\n    var gy0: vec4<f32> = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    let gz0: vec4<f32> = vec4<f32>(0.5) - abs(gx0) - abs(gy0);\n    let sz0: vec4<f32> = step(gz0, vec4<f32>(0.0));\n    gx0 -= sz0 * (step(vec4<f32>(0.0), gx0) - 0.5);\n    gy0 -= sz0 * (step(vec4<f32>(0.0), gy0) - 0.5);\n    var gx1: vec4<f32> = ixy1 * (1.0 / 7.0);\n    var gy1: vec4<f32> = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    let gz1: vec4<f32> = vec4<f32>(0.5) - abs(gx1) - abs(gy1);\n    let sz1: vec4<f32> = step(gz1, vec4<f32>(0.0));\n    gx1 -= sz1 * (step(vec4<f32>(0.0), gx1) - 0.5);\n    gy1 -= sz1 * (step(vec4<f32>(0.0), gy1) - 0.5);\n    var g000: vec3<f32> = vec3<f32>(gx0.x, gy0.x, gz0.x);\n    var g100: vec3<f32> = vec3<f32>(gx0.y, gy0.y, gz0.y);\n    var g010: vec3<f32> = vec3<f32>(gx0.z, gy0.z, gz0.z);\n    var g110: vec3<f32> = vec3<f32>(gx0.w, gy0.w, gz0.w);\n    var g001: vec3<f32> = vec3<f32>(gx1.x, gy1.x, gz1.x);\n    var g101: vec3<f32> = vec3<f32>(gx1.y, gy1.y, gz1.y);\n    var g011: vec3<f32> = vec3<f32>(gx1.z, gy1.z, gz1.z);\n    var g111: vec3<f32> = vec3<f32>(gx1.w, gy1.w, gz1.w);\n    let norm0: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    let norm1: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    let n000: f32 = dot(g000, Pf0);\n    let n100: f32 = dot(g100, vec3<f32>(Pf1.x, Pf0.yz));\n    let n010: f32 = dot(g010, vec3<f32>(Pf0.x, Pf1.y, Pf0.z));\n    let n110: f32 = dot(g110, vec3<f32>(Pf1.xy, Pf0.z));\n    let n001: f32 = dot(g001, vec3<f32>(Pf0.xy, Pf1.z));\n    let n101: f32 = dot(g101, vec3<f32>(Pf1.x, Pf0.y, Pf1.z));\n    let n011: f32 = dot(g011, vec3<f32>(Pf0.x, Pf1.yz));\n    let n111: f32 = dot(g111, Pf1);\n    let fade_xyz: vec3<f32> = fade3(Pf0);\n    let n_z: vec4<f32> = mix(vec4<f32>(n000, n100, n010, n110), vec4<f32>(n001, n101, n011, n111), fade_xyz.z);\n    let n_yz: vec2<f32> = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    let n_xyz: f32 = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfn turb(P: vec3<f32>, rep: vec3<f32>, lacunarity: f32, gain: f32) -> f32\n{\n    var sum: f32 = 0.0;\n    var sc: f32 = 1.0;\n    var totalgain: f32 = 1.0;\n    for (var i = 0.0; i < 6.0; i += 1)\n    {\n        sum += totalgain * perlinNoise3(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}"),entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uDimensions;\nuniform float uParallel;\nuniform vec2 uLight;\nuniform float uAspect;\nuniform float uTime;\nuniform vec3 uRay;\n\nuniform vec4 uInputSize;\n\n${PERLIN}\n\nvoid main(void) {\n    vec2 uDimensions = uDimensions;\n    bool uParallel = uParallel > 0.5;\n    vec2 uLight = uLight;\n    float uAspect = uAspect;\n\n    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;\n\n    float d;\n\n    if (uParallel) {\n        float _cos = uLight.x;\n        float _sin = uLight.y;\n        d = (_cos * coord.x) + (_sin * coord.y * uAspect);\n    } else {\n        float dx = coord.x - uLight.x / uDimensions.x;\n        float dy = (coord.y - uLight.y / uDimensions.y) * uAspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    float uTime = uTime;\n    vec3 uRay = uRay;\n\n    float gain = uRay[0];\n    float lacunarity = uRay[1];\n    float alpha = uRay[2];\n\n    vec3 dir = vec3(d, d, 0.0);\n    float noise = turb(dir + vec3(uTime, 0.0, 62.1 + uTime) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(vec3(noise), 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    finalColor = texture(uTexture, vTextureCoord) + mist;\n}\n".replace("${PERLIN}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n"),name:"god-ray-filter"}),resources:{godrayUniforms:{uLight:{value:new Float32Array(2),type:"vec2<f32>"},uParallel:{value:0,type:"f32"},uAspect:{value:0,type:"f32"},uTime:{value:e.time,type:"f32"},uRay:{value:new Float32Array(3),type:"vec3<f32>"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),eu(this,"uniforms"),eu(this,"time",0),eu(this,"_angleLight",[0,0]),eu(this,"_angle",0),eu(this,"_center"),this.uniforms=this.resources.godrayUniforms.uniforms,Object.assign(this,e)}apply(t,e,i,n){const r=e.frame.width,s=e.frame.height;this.uniforms.uLight[0]=this.parallel?this._angleLight[0]:this._center.x,this.uniforms.uLight[1]=this.parallel?this._angleLight[1]:this._center.y,this.uniforms.uDimensions[0]=r,this.uniforms.uDimensions[1]=s,this.uniforms.uAspect=s/r,this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*jt.Td;this._angleLight[0]=Math.cos(e),this._angleLight[1]=Math.sin(e)}get parallel(){return this.uniforms.uParallel>.5}set parallel(t){this.uniforms.uParallel=t?1:0}get center(){return this._center}set center(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this._center=t}get centerX(){return this.center.x}set centerX(t){this.center.x=t}get centerY(){return this.center.y}set centerY(t){this.center.y=t}get gain(){return this.uniforms.uRay[0]}set gain(t){this.uniforms.uRay[0]=t}get lacunarity(){return this.uniforms.uRay[1]}set lacunarity(t){this.uniforms.uRay[1]=t}get alpha(){return this.uniforms.uRay[2]}set alpha(t){this.uniforms.uRay[2]=t}};eu(iu,"DEFAULT_OPTIONS",{angle:30,gain:.5,lacunarity:2.5,parallel:!0,time:0,center:{x:0,y:0},alpha:1});class nu extends Et.d{constructor(){super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  let g: f32 = dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114));\n  return vec4<f32>(vec3<f32>(g), 1.);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\n\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nvoid main()\n{\n    vec4 c = texture(uTexture, vTextureCoord);\n    finalColor = vec4(\n        vec3(c.r * weight.r + c.g * weight.g  + c.b * weight.b),\n        c.a\n    );\n}\n",name:"grayscale-filter"}),resources:{}})}}var ru=Object.defineProperty,su=(t,e,i)=>(((t,e,i)=>{e in t?ru(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const ou=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct HslUniforms {\n  uHsl:vec3<f32>,\n  uColorize:f32,\n  uAlpha:f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> hslUniforms : HslUniforms;\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n    let color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n    var resultRGB: vec3<f32> = color.rgb;\n\n    let hue: f32 = hslUniforms.uHsl[0];\n    let saturation: f32 = hslUniforms.uHsl[1];\n    let lightness: f32 = hslUniforms.uHsl[2];\n\n    // colorize\n    if (hslUniforms.uColorize > 0.5) {\n        resultRGB = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)), 0., 0.);\n    }\n\n    // hue\n    resultRGB = hueShift(resultRGB, hue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    let average: f32 = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;\n\n    if (saturation > 0.) {\n        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));\n    } else {\n        resultRGB -= (average - resultRGB) * saturation;\n    }\n\n    // lightness\n    resultRGB = mix(resultRGB, vec3<f32>(ceil(lightness)) * color.a, abs(lightness));\n\n    // alpha\n    return mix(color, vec4<f32>(resultRGB, color.a), hslUniforms.uAlpha);\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst k: vec3<f32> = vec3(0.57735, 0.57735, 0.57735);\n\nfn hueShift(color: vec3<f32>, angle: f32) -> vec3<f32> \n{\n    let cosAngle: f32 = cos(angle);\n    return vec3<f32>(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec3 uHsl;\nuniform float uAlpha;\nuniform float uColorize;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nfloat getWeightedAverage(vec3 rgb) {\n    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst vec3 k = vec3(0.57735, 0.57735, 0.57735);\n\nvec3 hueShift(vec3 color, float angle) {\n    float cosAngle = cos(angle);\n    return vec3(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}\n\nvoid main()\n{\n    vec4 color = texture(uTexture, vTextureCoord);\n    vec3 resultRGB = color.rgb;\n\n    float hue = uHsl[0];\n    float saturation = uHsl[1];\n    float lightness = uHsl[2];\n\n    // colorize\n    if (uColorize > 0.5) {\n        resultRGB = vec3(getWeightedAverage(resultRGB), 0., 0.);\n    }\n\n    // hue\n    resultRGB = hueShift(resultRGB, hue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    float average = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;\n\n    if (saturation > 0.) {\n        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));\n    } else {\n        resultRGB -= (average - resultRGB) * saturation;\n    }\n\n    // lightness\n    resultRGB = mix(resultRGB, vec3(ceil(lightness)) * color.a, abs(lightness));\n\n    // alpha\n    finalColor = mix(color, vec4(resultRGB, color.a), uAlpha);\n}\n",name:"hsl-adjustment-filter"}),resources:{hslUniforms:{uHsl:{value:new Float32Array(3),type:"vec3<f32>"},uColorize:{value:e.colorize?1:0,type:"f32"},uAlpha:{value:e.alpha,type:"f32"}}}}),su(this,"uniforms"),su(this,"_hue"),this.uniforms=this.resources.hslUniforms.uniforms,Object.assign(this,e)}get hue(){return this._hue}set hue(t){this._hue=t,this.uniforms.uHsl[0]=t*(Math.PI/180)}get saturation(){return this.uniforms.uHsl[1]}set saturation(t){this.uniforms.uHsl[1]=t}get lightness(){return this.uniforms.uHsl[2]}set lightness(t){this.uniforms.uHsl[2]=t}get colorize(){return 1===this.uniforms.uColorize}set colorize(t){this.uniforms.uColorize=t?1:0}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};su(ou,"DEFAULT_OPTIONS",{hue:0,saturation:0,lightness:0,colorize:!1,alpha:1});var au=Object.defineProperty,lu=(t,e,i)=>(((t,e,i)=>{e in t?au(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const uu=class t extends Et.d{constructor(...e){let i=e[0]??{};if(Array.isArray(i)||"x"in i&&"y"in i||i instanceof Ht.o){(0,d.t6)("6.0.0","MotionBlurFilter constructor params are now options object. See params: { velocity, kernelSize, offset }");i={velocity:{x:"x"in i?i.x:i[0],y:"y"in i?i.y:i[1]}},void 0!==e[1]&&(i.kernelSize=e[1]),void 0!==e[2]&&(i.offset=e[2])}i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct MotionBlurUniforms {\n  uVelocity: vec2<f32>,\n  uKernelSize: f32,\n  uOffset: f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> motionBlurUniforms : MotionBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uVelocity = motionBlurUniforms.uVelocity;\n  let uKernelSize = motionBlurUniforms.uKernelSize;\n  let uOffset = motionBlurUniforms.uOffset;\n\n  let velocity: vec2<f32> = uVelocity / gfu.uInputSize.xy;\n  let offset: f32 = -uOffset / length(uVelocity) - 0.5;\n  let k: i32 = i32(min(uKernelSize - 1, MAX_KERNEL_SIZE - 1));\n\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  for(var i: i32 = 0; i < k; i += 1) {\n    let bias: vec2<f32> = velocity * (f32(i) / f32(k) + offset);\n    color += textureSample(uTexture, uSampler, uv + bias);\n  }\n  \n  return select(color / f32(uKernelSize), textureSample(uTexture, uSampler, uv), uKernelSize == 0);\n}\n\nconst MAX_KERNEL_SIZE: f32 = 2048;",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uVelocity;\nuniform int uKernelSize;\nuniform float uOffset;\n\nuniform vec4 uInputSize;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\n// Notice:\n// the perfect way:\n//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);\n// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.\n// So use uKernelSize directly.\n\nvoid main(void)\n{\n    vec4 color = texture(uTexture, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        finalColor = color;\n        return;\n    }\n\n    vec2 velocity = uVelocity / uInputSize.xy;\n    float offset = -uOffset / length(uVelocity) - 0.5;\n    int k = uKernelSize - 1;\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n        vec2 bias = velocity * (float(i) / float(k) + offset);\n        color += texture(uTexture, vTextureCoord + bias);\n    }\n    finalColor = color / float(uKernelSize);\n}\n",name:"motion-blur-filter"}),resources:{motionBlurUniforms:{uVelocity:{value:i.velocity,type:"vec2<f32>"},uKernelSize:{value:Math.trunc(i.kernelSize??5),type:"i32"},uOffset:{value:i.offset,type:"f32"}}}}),lu(this,"uniforms"),lu(this,"_kernelSize"),this.uniforms=this.resources.motionBlurUniforms.uniforms,Object.assign(this,i)}get velocity(){return this.uniforms.uVelocity}set velocity(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uVelocity=t,this._updateDirty()}get velocityX(){return this.velocity.x}set velocityX(t){this.velocity.x=t,this._updateDirty()}get velocityY(){return this.velocity.y}set velocityY(t){this.velocity.y=t,this._updateDirty()}get kernelSize(){return this._kernelSize}set kernelSize(t){this._kernelSize=t,this._updateDirty()}get offset(){return this.uniforms.uOffset}set offset(t){this.uniforms.uOffset=t}_updateDirty(){this.padding=1+(Math.max(Math.abs(this.velocityX),Math.abs(this.velocityY))|0),this.uniforms.uKernelSize=0!==this.velocityX||0!==this.velocityY?this._kernelSize:0}};lu(uu,"DEFAULT_OPTIONS",{velocity:{x:0,y:0},kernelSize:5,offset:0});var hu=Object.defineProperty,cu=(t,e,i)=>(((t,e,i)=>{e in t?hu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const du=class t extends Et.d{constructor(...e){let i=e[0]??{};Array.isArray(i)&&((0,d.t6)("6.0.0","MultiColorReplaceFilter constructor params are now options object. See params: { replacements, tolerance, maxColors }"),i={replacements:i},e[1]&&(i.tolerance=e[1]),e[2]&&(i.maxColors=e[2])),i={...t.DEFAULT_OPTIONS,...i};const n=i.maxColors??i.replacements.length;super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct MultiColorReplaceUniforms {\n  uOriginalColors: array<vec3<f32>, MAX_COLORS>,\n  uTargetColors: array<vec3<f32>, MAX_COLORS>,\n  uTolerance:f32,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> multiColorReplaceUniforms : MultiColorReplaceUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uOriginalColors = multiColorReplaceUniforms.uOriginalColors;\n  let uTargetColors = multiColorReplaceUniforms.uTargetColors;\n  let uTolerance = multiColorReplaceUniforms.uTolerance;\n\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  let alpha: f32 = color.a;\n\n  if (alpha > 0.0001)\n  {\n    var modColor: vec3<f32> = vec3<f32>(color.rgb) / alpha;\n\n    for(var i: i32 = 0; i < MAX_COLORS; i += 1)\n    {\n      let origColor: vec3<f32> = uOriginalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      let colorDiff: vec3<f32> = origColor - modColor;\n      \n      if (length(colorDiff) < uTolerance)\n      {\n        let targetColor: vec3<f32> = uTargetColors[i];\n        color = vec4((targetColor + colorDiff) * alpha, alpha);\n        return color;\n      }\n    }\n  }\n\n  return color;\n}\n\nconst MAX_COLORS: i32 = ${MAX_COLORS};".replace(/\$\{MAX_COLORS\}/g,n.toFixed(0)),entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nconst int MAX_COLORS = ${MAX_COLORS};\n\nuniform sampler2D uTexture;\nuniform vec3 uOriginalColors[MAX_COLORS];\nuniform vec3 uTargetColors[MAX_COLORS];\nuniform float uTolerance;\n\nvoid main(void)\n{\n    finalColor = texture(uTexture, vTextureCoord);\n\n    float alpha = finalColor.a;\n    if (alpha < 0.0001)\n    {\n      return;\n    }\n\n    vec3 color = finalColor.rgb / alpha;\n\n    for(int i = 0; i < MAX_COLORS; i++)\n    {\n      vec3 origColor = uOriginalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      vec3 colorDiff = origColor - color;\n      if (length(colorDiff) < uTolerance)\n      {\n        vec3 targetColor = uTargetColors[i];\n        finalColor = vec4((targetColor + colorDiff) * alpha, alpha);\n        return;\n      }\n    }\n}\n".replace(/\$\{MAX_COLORS\}/g,n.toFixed(0)),name:"multi-color-replace-filter"}),resources:{multiColorReplaceUniforms:{uOriginalColors:{value:new Float32Array(3*n),type:"vec3<f32>",size:n},uTargetColors:{value:new Float32Array(3*n),type:"vec3<f32>",size:n},uTolerance:{value:i.tolerance,type:"f32"}}}}),cu(this,"uniforms"),cu(this,"_replacements",[]),cu(this,"_maxColors"),this._maxColors=n,this.uniforms=this.resources.multiColorReplaceUniforms.uniforms,this.replacements=i.replacements}set replacements(t){const e=this.uniforms.uOriginalColors,i=this.uniforms.uTargetColors,n=t.length,r=new Mt.Q;if(n>this._maxColors)throw new Error(`Length of replacements (${n}) exceeds the maximum colors length (${this._maxColors})`);let s,o,a;e[3*n]=-1;for(let l=0;l<n;l++){const n=t[l];r.setValue(n[0]),[s,o,a]=r.toArray(),e[3*l]=s,e[3*l+1]=o,e[3*l+2]=a,r.setValue(n[1]),[s,o,a]=r.toArray(),i[3*l]=s,i[3*l+1]=o,i[3*l+2]=a}this._replacements=t}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}get tolerance(){return this.uniforms.uTolerance}set tolerance(t){this.uniforms.uTolerance=t}set epsilon(t){(0,d.t6)("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance=t}get epsilon(){return(0,d.t6)("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance}};cu(du,"DEFAULT_OPTIONS",{replacements:[[16711680,255]],tolerance:.05,maxColors:void 0});var fu=Object.defineProperty,pu=(t,e,i)=>(((t,e,i)=>{e in t?fu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const mu=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct OldFilmUniforms {\n    uSepia: f32,\n    uNoise: vec2<f32>,\n    uScratch: vec3<f32>,\n    uVignetting: vec3<f32>,\n    uSeed: f32,\n    uDimensions: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> oldFilmUniforms : OldFilmUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n\n  if (oldFilmUniforms.uSepia > 0.)\n  {\n    color = vec4<f32>(sepia(color.rgb), color.a);\n  }\n\n  let coord: vec2<f32> = uv * gfu.uInputSize.xy / oldFilmUniforms.uDimensions;\n\n  if (oldFilmUniforms.uVignetting[0] > 0.)\n  {\n    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);\n  }\n\n  let uScratch = oldFilmUniforms.uScratch; \n\n  if (uScratch[1] > oldFilmUniforms.uSeed && uScratch[0] != 0.)\n  {\n    color = vec4<f32>(scratch(color.rgb, coord), color.a);\n  }\n\n  let uNoise = oldFilmUniforms.uNoise;\n\n  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)\n  {\n    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);\n  }\n\n  return color;\n}\n\nconst SQRT_2: f32 = 1.414213;\nconst SEPIA_RGB: vec3<f32> = vec3<f32>(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfn modulo(x: f32, y: f32) -> f32\n{\n  return x - y * floor(x/y);\n}\n\nfn rand(co: vec2<f32>) -> f32\n{\n  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);\n}\n\nfn overlay(src: vec3<f32>, dst: vec3<f32>) -> vec3<f32>\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n\n    return vec3<f32>(\n      select((1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)), (2.0 * src.x * dst.x), (dst.x <= 0.5)), \n      select((1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)), (2.0 * src.y * dst.y), (dst.y <= 0.5)),\n      select((1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)), (2.0 * src.z * dst.z), (dst.z <= 0.5))\n    );\n}\n\nfn sepia(co: vec3<f32>) -> vec3<f32>\n{\n  let gray: f32 = (co.x + co.y + co.z) / 3.0;\n  let grayscale: vec3<f32> = vec3<f32>(gray);\n  let color = overlay(SEPIA_RGB, grayscale);\n  return grayscale + oldFilmUniforms.uSepia * (color - grayscale);\n}\n\nfn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32\n{\n  let uVignetting = oldFilmUniforms.uVignetting;\n  let uDimensions = oldFilmUniforms.uDimensions;\n  \n  let outter: f32 = SQRT_2 - uVignetting[0] * SQRT_2;\n  var dir: vec2<f32> = vec2<f32>(vec2<f32>(0.5) - coord);\n  dir.y *= uDimensions.y / uDimensions.x;\n  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignetting[2] * SQRT_2), 0.0, 1.0);\n  return darker + (1.0 - darker) * (1.0 - uVignetting[1]);\n}\n\nfn scratch(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>\n{\n  var color = co;\n  let uScratch = oldFilmUniforms.uScratch;\n  let uSeed = oldFilmUniforms.uSeed;\n  let uDimensions = oldFilmUniforms.uDimensions;\n\n  let phase: f32 = uSeed * 256.0;\n  let s: f32 = modulo(floor(phase), 2.0);\n  let dist: f32 = 1.0 / uScratch[1];\n  let d: f32 = distance(coord, vec2<f32>(uSeed * dist, abs(s - uSeed * dist)));\n\n  if (d < uSeed * 0.6 + 0.4)\n  {\n    let period: f32 = uScratch[1] * 10.0;\n\n    let xx: f32 = coord.x * period + phase;\n    let aa: f32 = abs(modulo(xx, 0.5) * 4.0);\n    let bb: f32 = modulo(floor(xx / 0.5), 2.0);\n    let yy: f32 = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n    let kk: f32 = 2.0 * period;\n    let dw: f32 = uScratch[2] / uDimensions.x * (0.75 + uSeed);\n    let dh: f32 = dw * kk;\n\n    var tine: f32 = (yy - (2.0 - dh));\n\n    if (tine > 0.0) {\n        let _sign: f32 = sign(uScratch[0]);\n\n        tine = s * tine / period + uScratch[0] + 0.1;\n        tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n        color *= tine;\n    }\n  }\n\n  return color;\n}\n\nfn noise(coord: vec2<f32>) -> f32\n{\n  let uNoise = oldFilmUniforms.uNoise;\n  let uSeed = oldFilmUniforms.uSeed;\n\n  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;\n  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);\n  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);\n  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uSepia;\nuniform vec2 uNoise;\nuniform vec3 uScratch;\nuniform vec3 uVignetting;\nuniform float uSeed;\nuniform vec2 uDimensions;\n\nuniform vec4 uInputSize;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    finalColor = texture(uTexture, vTextureCoord);\n    vec3 color = finalColor.rgb;\n\n    if (uSepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + uSepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions.xy;\n\n    float vignette = uVignetting[0];\n    float vignetteAlpha = uVignetting[1];\n    float vignetteBlur = uVignetting[2];\n\n    if (vignette > 0.0)\n    {\n        float outter = SQRT_2 - vignette * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= uDimensions.y / uDimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignetteBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignetteAlpha);\n    }\n\n    float scratch = uScratch[0];\n    float scratchDensity = uScratch[1];\n    float scratchWidth = uScratch[2];\n\n    if (scratchDensity > uSeed && scratch != 0.0)\n    {\n        float phase = uSeed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(uSeed * dist, abs(s - uSeed * dist)));\n        if (d < uSeed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / uDimensions.x * (0.75 + uSeed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    float noise = uNoise[0];\n    float noiseSize = uNoise[1];\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + uSeed * 512.0, 1024.0 - uSeed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * uSeed) - 0.5;\n        color += _noise * noise;\n    }\n\n    finalColor.rgb = color;\n}",name:"old-film-filter"}),resources:{oldFilmUniforms:{uSepia:{value:e.sepia,type:"f32"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uScratch:{value:new Float32Array(3),type:"vec3<f32>"},uVignetting:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),pu(this,"uniforms"),pu(this,"seed"),this.uniforms=this.resources.oldFilmUniforms.uniforms,Object.assign(this,e)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,this.uniforms.uSeed=this.seed,t.applyFilter(this,e,i,n)}get sepia(){return this.uniforms.uSepia}set sepia(t){this.uniforms.uSepia=t}get noise(){return this.uniforms.uNoise[0]}set noise(t){this.uniforms.uNoise[0]=t}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(t){this.uniforms.uNoise[1]=t}get scratch(){return this.uniforms.uScratch[0]}set scratch(t){this.uniforms.uScratch[0]=t}get scratchDensity(){return this.uniforms.uScratch[1]}set scratchDensity(t){this.uniforms.uScratch[1]=t}get scratchWidth(){return this.uniforms.uScratch[2]}set scratchWidth(t){this.uniforms.uScratch[2]=t}get vignetting(){return this.uniforms.uVignetting[0]}set vignetting(t){this.uniforms.uVignetting[0]=t}get vignettingAlpha(){return this.uniforms.uVignetting[1]}set vignettingAlpha(t){this.uniforms.uVignetting[1]=t}get vignettingBlur(){return this.uniforms.uVignetting[2]}set vignettingBlur(t){this.uniforms.uVignetting[2]=t}};pu(mu,"DEFAULT_OPTIONS",{sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,seed:0});var gu=Object.defineProperty,vu=(t,e,i)=>(((t,e,i)=>{e in t?gu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const yu=class t extends Et.d{constructor(...e){let i=e[0]??{};"number"==typeof i&&((0,d.t6)("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),i={thickness:i},void 0!==e[1]&&(i.color=e[1]),void 0!==e[2]&&(i.quality=e[2]),void 0!==e[3]&&(i.alpha=e[3]),void 0!==e[4]&&(i.knockout=e[4])),i={...t.DEFAULT_OPTIONS,...i};const n=i.quality??.1;super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct OutlineUniforms {\n  uThickness:vec2<f32>,\n  uColor:vec3<f32>,\n  uAlpha:f32,\n  uAngleStep:f32,\n  uKnockout:f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);\n  \n  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);\n  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);\n  \n  return contentColor + outlineColor;\n}\n\nfn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {\n  let thickness = outlineUniforms.uThickness;\n\n  if (thickness.x == 0. || thickness.y == 0.) {\n    return 0.;\n  }\n  \n  let angleStep = outlineUniforms.uAngleStep;\n\n  var displacedColor: vec4<f32>;\n  var displacedPos: vec2<f32>;\n\n  var maxAlpha: f32 = 0.;\n  var displaced: vec2<f32>;\n  var curColor: vec4<f32>;\n\n  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)\n  {\n    displaced.x = uv.x + thickness.x * cos(angle);\n    displaced.y = uv.y + thickness.y * sin(angle);\n    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n    maxAlpha = max(maxAlpha, curColor.a);\n  }\n\n  return maxAlpha;\n}\n\nconst DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uThickness;\nuniform vec3 uColor;\nuniform float uAlpha;\nuniform float uKnockout;\n\nuniform vec4 uInputClamp;\n\nconst float DOUBLE_PI = 2. * 3.14159265358979323846264;\nconst float ANGLE_STEP = ${ANGLE_STEP};\n\nfloat outlineMaxAlphaAtPos(vec2 pos) {\n    if (uThickness.x == 0. || uThickness.y == 0.) {\n        return 0.;\n    }\n\n    vec4 displacedColor;\n    vec2 displacedPos;\n    float maxAlpha = 0.;\n\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {\n        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);\n        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);\n        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));\n        maxAlpha = max(maxAlpha, displacedColor.a);\n    }\n\n    return maxAlpha;\n}\n\nvoid main(void) {\n    vec4 sourceColor = texture(uTexture, vTextureCoord);\n    vec4 contentColor = sourceColor * float(uKnockout < 0.5);\n    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);\n    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);\n    finalColor = contentColor + outlineColor;\n}\n".replace(/\$\{ANGLE_STEP\}/,t.getAngleStep(n).toFixed(7)),name:"outline-filter"}),resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:i.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:i.knockout?1:0,type:"f32"}}}}),vu(this,"uniforms"),vu(this,"_thickness"),vu(this,"_quality"),vu(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=t.getAngleStep(n),this._color=new Mt.Q,this.color=i.color??0,Object.assign(this,i)}apply(t,e,i,n){this.uniforms.uThickness[0]=this.thickness/e.source.width,this.uniforms.uThickness[1]=this.thickness/e.source.height,t.applyFilter(this,e,i,n)}static getAngleStep(e){return parseFloat((2*Math.PI/Math.max(e*t.MAX_SAMPLES,t.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(t){this._thickness=this.padding=t}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get quality(){return this._quality}set quality(e){this._quality=e,this.uniforms.uAngleStep=t.getAngleStep(e)}get knockout(){return 1===this.uniforms.uKnockout}set knockout(t){this.uniforms.uKnockout=t?1:0}};vu(yu,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1}),vu(yu,"MIN_SAMPLES",1),vu(yu,"MAX_SAMPLES",100);let xu=yu;Et.d;var _u=Object.defineProperty,bu=(t,e,i)=>(((t,e,i)=>{e in t?_u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const wu=class t extends Et.d{constructor(...e){let i=e[0]??{};if("number"==typeof i){if((0,d.t6)("6.0.0","RadialBlurFilter constructor params are now options object. See params: { angle, center, kernelSize, radius }"),i={angle:i},e[1]){const t="x"in e[1]?e[1].x:e[1][0],n="y"in e[1]?e[1].y:e[1][1];i.center={x:t,y:n}}e[2]&&(i.kernelSize=e[2]),e[3]&&(i.radius=e[3])}i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct RadialBlurUniforms {\n  uRadian: f32,\n  uCenter: vec2<f32>,\n  uKernelSize: f32,\n  uRadius: f32,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> radialBlurUniforms : RadialBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uRadian = radialBlurUniforms.uRadian;\n  let uCenter = radialBlurUniforms.uCenter;\n  let uKernelSize = radialBlurUniforms.uKernelSize;\n  let uRadius = radialBlurUniforms.uRadius;\n  \n  var returnColorOnly = false;\n\n  if (uKernelSize == 0)\n  {\n    returnColorOnly = true;\n  }\n\n  let aspect: f32 = gfu.uInputSize.y / gfu.uInputSize.x;\n  let center: vec2<f32> = uCenter.xy / gfu.uInputSize.xy;\n  let gradient: f32 = uRadius / gfu.uInputSize.x * 0.3;\n  let radius: f32 = uRadius / gfu.uInputSize.x - gradient * 0.5;\n  let k: i32 = i32(uKernelSize - 1);\n\n  var coord: vec2<f32> = uv;\n  let dir: vec2<f32> = vec2<f32>(center - coord);\n  let dist: f32 = length(vec2<f32>(dir.x, dir.y * aspect));\n\n  var radianStep: f32 = uRadian;\n  \n  if (radius >= 0.0 && dist > radius)\n  {\n    let delta: f32 = dist - radius;\n    let gap: f32 = gradient;\n    let scale: f32 = 1.0 - abs(delta / gap);\n    if (scale <= 0.0) {\n      returnColorOnly = true;\n    }\n    radianStep *= scale;\n  }\n\n  radianStep /= f32(k);\n\n  let s: f32 = sin(radianStep);\n  let c: f32 = cos(radianStep);\n  let rotationMatrix: mat2x2<f32> = mat2x2<f32>(vec2<f32>(c, -s), vec2<f32>(s, c));\n  \n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let baseColor = vec4<f32>(color);\n\n  let minK: i32 = min(i32(uKernelSize) - 1, MAX_KERNEL_SIZE - 1);\n\n  for(var i: i32 = 0; i < minK; i += 1) \n  {\n    coord -= center;\n    coord.y *= aspect;\n    coord = rotationMatrix * coord;\n    coord.y /= aspect;\n    coord += center;\n    let sample: vec4<f32> = textureSample(uTexture, uSampler, coord);\n    // switch to pre-multiplied alpha to correctly blur transparent images\n    // sample.rgb *= sample.a;\n    color += sample;\n  }\n\n  return select(color / f32(uKernelSize), baseColor, returnColorOnly);\n}\n\nconst MAX_KERNEL_SIZE: i32 = 2048;",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uRadian;\nuniform vec2 uCenter;\nuniform float uRadius;\nuniform int uKernelSize;\n\nuniform vec4 uInputSize;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\nvoid main(void)\n{\n    vec4 color = texture(uTexture, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        finalColor = color;\n        return;\n    }\n\n    float aspect = uInputSize.y / uInputSize.x;\n    vec2 center = uCenter.xy / uInputSize.xy;\n    float gradient = uRadius / uInputSize.x * 0.3;\n    float radius = uRadius / uInputSize.x - gradient * 0.5;\n    int k = uKernelSize - 1;\n\n    vec2 coord = vTextureCoord;\n    vec2 dir = vec2(center - coord);\n    float dist = length(vec2(dir.x, dir.y * aspect));\n\n    float radianStep = uRadian;\n    if (radius >= 0.0 && dist > radius) {\n        float delta = dist - radius;\n        float gap = gradient;\n        float scale = 1.0 - abs(delta / gap);\n        if (scale <= 0.0) {\n            finalColor = color;\n            return;\n        }\n        radianStep *= scale;\n    }\n    radianStep /= float(k);\n\n    float s = sin(radianStep);\n    float c = cos(radianStep);\n    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n\n        coord -= center;\n        coord.y *= aspect;\n        coord = rotationMatrix * coord;\n        coord.y /= aspect;\n        coord += center;\n\n        vec4 sample = texture(uTexture, coord);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample;\n    }\n\n    finalColor = color / float(uKernelSize);\n}\n",name:"radial-blur-filter"}),resources:{radialBlurUniforms:{uRadian:{value:0,type:"f32"},uCenter:{value:i.center,type:"vec2<f32>"},uKernelSize:{value:i.kernelSize,type:"i32"},uRadius:{value:i.radius,type:"f32"}}}}),bu(this,"uniforms"),bu(this,"_angle"),bu(this,"_kernelSize"),this.uniforms=this.resources.radialBlurUniforms.uniforms,Object.assign(this,i)}_updateKernelSize(){this.uniforms.uKernelSize=0!==this._angle?this.kernelSize:0}get angle(){return this._angle}set angle(t){this._angle=t,this.uniforms.uRadian=t*Math.PI/180,this._updateKernelSize()}get center(){return this.uniforms.uCenter}set center(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uCenter=t}get centerX(){return this.center.x}set centerX(t){this.center.x=t}get centerY(){return this.center.y}set centerY(t){this.center.y=t}get kernelSize(){return this._kernelSize}set kernelSize(t){this._kernelSize=t,this._updateKernelSize()}get radius(){return this.uniforms.uRadius}set radius(t){this.uniforms.uRadius=t<0||t===1/0?-1:t}};bu(wu,"DEFAULT_OPTIONS",{angle:0,center:{x:0,y:0},kernelSize:5,radius:-1});var Su=Object.defineProperty,Cu=(t,e,i)=>(((t,e,i)=>{e in t?Su(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Au=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ReflectionUniforms {\n  uMirror: f32,\n  uBoundary: f32,\n  uAmplitude: vec2<f32>,\n  uWavelength: vec2<f32>,\n  uAlpha: vec2<f32>,\n  uTime: f32,\n  uDimensions: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> reflectionUniforms : ReflectionUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uDimensions: vec2<f32> = reflectionUniforms.uDimensions;\n  let uBoundary: f32 = reflectionUniforms.uBoundary;\n  let uMirror: bool = reflectionUniforms.uMirror > 0.5;\n  let uAmplitude: vec2<f32> = reflectionUniforms.uAmplitude;\n  let uWavelength: vec2<f32> = reflectionUniforms.uWavelength;\n  let uAlpha: vec2<f32> = reflectionUniforms.uAlpha;\n  let uTime: f32 = reflectionUniforms.uTime;\n\n  let pixelCoord: vec2<f32> = uv * gfu.uInputSize.xy;\n  let coord: vec2<f32> = pixelCoord /uDimensions;\n  var returnColorOnly: bool = false;\n\n  if (coord.y < uBoundary) {\n    returnColorOnly = true;\n  }\n\n  let k: f32 = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);\n  let areaY: f32 = uBoundary * uDimensions.y / gfu.uInputSize.y;\n  let v: f32 = areaY + areaY - uv.y;\n  let y: f32 = select(uv.y, v, uMirror);\n\n  let amplitude: f32 = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / gfu.uInputSize.x;\n  let waveLength: f32 = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / gfu.uInputSize.y;\n  let alpha: f32 = select((uAlpha.y - uAlpha.x) * k + uAlpha.x, 1., returnColorOnly);\n\n  var x: f32 = uv.x + cos(v * 6.28 / waveLength - uTime) * amplitude;\n  x = clamp(x, gfu.uInputClamp.x, gfu.uInputClamp.z);\n  \n  return textureSample(uTexture, uSampler, select(vec2<f32>(x, y), uv, returnColorOnly)) * alpha;\n}\n\nfn rand(co: vec2<f32>) -> f32 \n{\n  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uMirror;\nuniform float uBoundary;\nuniform vec2 uAmplitude;\nuniform vec2 uWavelength;\nuniform vec2 uAlpha;\nuniform float uTime;\nuniform vec2 uDimensions;\n\nuniform vec4 uInputSize;\nuniform vec4 uInputClamp;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;\n    vec2 coord = pixelCoord / uDimensions;\n\n    if (coord.y < uBoundary) {\n        finalColor = texture(uTexture, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);\n    float areaY = uBoundary * uDimensions.y / uInputSize.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = uMirror > 0.5 ? v : vTextureCoord.y;\n\n    float _amplitude = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / uInputSize.x;\n    float _waveLength = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / uInputSize.y;\n    float _alpha = (uAlpha.y - uAlpha.x) * k + uAlpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - uTime) * _amplitude;\n    x = clamp(x, uInputClamp.x, uInputClamp.z);\n\n    vec4 color = texture(uTexture, vec2(x, y));\n\n    finalColor = color * _alpha;\n}\n",name:"reflection-filter"}),resources:{reflectionUniforms:{uMirror:{value:e.mirror?1:0,type:"f32"},uBoundary:{value:e.boundary,type:"f32"},uAmplitude:{value:e.amplitude,type:"vec2<f32>"},uWavelength:{value:e.waveLength,type:"vec2<f32>"},uAlpha:{value:e.alpha,type:"vec2<f32>"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Cu(this,"uniforms"),Cu(this,"time",0),this.uniforms=this.resources.reflectionUniforms.uniforms,Object.assign(this,e)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get mirror(){return this.uniforms.uMirror>.5}set mirror(t){this.uniforms.uMirror=t?1:0}get boundary(){return this.uniforms.uBoundary}set boundary(t){this.uniforms.uBoundary=t}get amplitude(){return Array.from(this.uniforms.uAmplitude)}set amplitude(t){this.uniforms.uAmplitude[0]=t[0],this.uniforms.uAmplitude[1]=t[1]}get amplitudeStart(){return this.uniforms.uAmplitude[0]}set amplitudeStart(t){this.uniforms.uAmplitude[0]=t}get amplitudeEnd(){return this.uniforms.uAmplitude[1]}set amplitudeEnd(t){this.uniforms.uAmplitude[1]=t}get waveLength(){return Array.from(this.uniforms.uWavelength)}set waveLength(t){this.uniforms.uWavelength[0]=t[0],this.uniforms.uWavelength[1]=t[1]}get wavelengthStart(){return this.uniforms.uWavelength[0]}set wavelengthStart(t){this.uniforms.uWavelength[0]=t}get wavelengthEnd(){return this.uniforms.uWavelength[1]}set wavelengthEnd(t){this.uniforms.uWavelength[1]=t}get alpha(){return Array.from(this.uniforms.uAlpha)}set alpha(t){this.uniforms.uAlpha[0]=t[0],this.uniforms.uAlpha[1]=t[1]}get alphaStart(){return this.uniforms.uAlpha[0]}set alphaStart(t){this.uniforms.uAlpha[0]=t}get alphaEnd(){return this.uniforms.uAlpha[1]}set alphaEnd(t){this.uniforms.uAlpha[1]=t}};Cu(Au,"DEFAULT_OPTIONS",{mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0});var Tu=Object.defineProperty,Pu=(t,e,i)=>(((t,e,i)=>{e in t?Tu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Mu=class t extends Et.d{constructor(...e){let i=e[0]??{};(Array.isArray(i)||"x"in i&&"y"in i)&&((0,d.t6)("6.0.0","RGBSplitFilter constructor params are now options object. See params: { red, green, blue }"),i={red:i},void 0!==e[1]&&(i.green=e[1]),void 0!==e[2]&&(i.blue=e[2])),i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct RgbSplitUniforms {\n    uRed: vec2<f32>,\n    uGreen: vec2<f32>,\n    uBlue: vec3<f32>,\n};\n\nstruct GlobalFilterUniforms {\n    uInputSize:vec4<f32>,\n    uInputPixel:vec4<f32>,\n    uInputClamp:vec4<f32>,\n    uOutputFrame:vec4<f32>,\n    uGlobalFrame:vec4<f32>,\n    uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> rgbSplitUniforms : RgbSplitUniforms;\n\n@fragment\nfn mainFragment(\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n    let r = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uRed.x / gfu.uInputSize.x, rgbSplitUniforms.uRed.y / gfu.uInputSize.y)).r;\n    let g = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uGreen.x / gfu.uInputSize.x, rgbSplitUniforms.uGreen.y / gfu.uInputSize.y)).g;\n    let b = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uBlue.x / gfu.uInputSize.x, rgbSplitUniforms.uBlue.y / gfu.uInputSize.y)).b;\n    let a = textureSample(uTexture, uSampler, uv).a;\n    return vec4<f32>(r, g, b, a);\n}\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec4 uInputSize;\nuniform vec2 uRed;\nuniform vec2 uGreen;\nuniform vec2 uBlue;\n\nvoid main(void)\n{\n   float r = texture(uTexture, vTextureCoord + uRed/uInputSize.xy).r;\n   float g = texture(uTexture, vTextureCoord + uGreen/uInputSize.xy).g;\n   float b = texture(uTexture, vTextureCoord + uBlue/uInputSize.xy).b;\n   float a = texture(uTexture, vTextureCoord).a;\n   finalColor = vec4(r, g, b, a);\n}\n",name:"rgb-split-filter"}),resources:{rgbSplitUniforms:{uRed:{value:i.red,type:"vec2<f32>"},uGreen:{value:i.green,type:"vec2<f32>"},uBlue:{value:i.blue,type:"vec2<f32>"}}}}),Pu(this,"uniforms"),this.uniforms=this.resources.rgbSplitUniforms.uniforms,Object.assign(this,i)}get red(){return this.uniforms.uRed}set red(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uRed=t}get redX(){return this.red.x}set redX(t){this.red.x=t}get redY(){return this.red.y}set redY(t){this.red.y=t}get green(){return this.uniforms.uGreen}set green(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uGreen=t}get greenX(){return this.green.x}set greenX(t){this.green.x=t}get greenY(){return this.green.y}set greenY(t){this.green.y=t}get blue(){return this.uniforms.uBlue}set blue(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uBlue=t}get blueX(){return this.blue.x}set blueX(t){this.blue.x=t}get blueY(){return this.blue.y}set blueY(t){this.blue.y=t}};Pu(Mu,"DEFAULT_OPTIONS",{red:{x:-10,y:0},green:{x:0,y:10},blue:{x:0,y:0}});var Iu=Object.defineProperty,Ou=(t,e,i)=>(((t,e,i)=>{e in t?Iu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const ku=class t extends Et.d{constructor(...e){let i=e[0]??{};(Array.isArray(i)||"x"in i&&"y"in i)&&((0,d.t6)("6.0.0","ShockwaveFilter constructor params are now options object. See params: { center, speed, amplitude, wavelength, brightness, radius, time }"),i={center:i,...e[1]},void 0!==e[2]&&(i.time=e[2])),i={...t.DEFAULT_OPTIONS,...i};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"\nstruct ShockWaveUniforms {\n    uTime: f32,\n    uOffset: vec2<f32>,\n    uSpeed: f32,\n    uWave: vec4<f32>,\n};\n\nstruct GlobalFilterUniforms {\n    uInputSize:vec4<f32>,\n    uInputPixel:vec4<f32>,\n    uInputClamp:vec4<f32>,\n    uOutputFrame:vec4<f32>,\n    uGlobalFrame:vec4<f32>,\n    uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;\n\n@fragment\nfn mainFragment(\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n\n    let uTime = shockwaveUniforms.uTime;\n    let uOffset = shockwaveUniforms.uOffset;\n    let uSpeed = shockwaveUniforms.uSpeed;\n    let uAmplitude = shockwaveUniforms.uWave[0];\n    let uWavelength = shockwaveUniforms.uWave[1];\n    let uBrightness = shockwaveUniforms.uWave[2];\n    let uRadius = shockwaveUniforms.uWave[3];\n    let halfWavelength: f32 = uWavelength * 0.5 / gfu.uInputSize.x;\n    let maxRadius: f32 = uRadius / gfu.uInputSize.x;\n    let currentRadius: f32 = uTime * uSpeed / gfu.uInputSize.x;\n    var fade: f32 = 1.0;\n    var returnColorOnly: bool = false;\n    \n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            returnColorOnly = true;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n    var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.uInputSize.xy);\n    dir.y *= gfu.uInputSize.y / gfu.uInputSize.x;\n\n    let dist:f32 = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        returnColorOnly = true;\n    }\n\n    let diffUV: vec2<f32> = normalize(dir);\n    let diff: f32 = (dist - currentRadius) / halfWavelength;\n    let p: f32 = 1.0 - pow(abs(diff), 2.0);\n    let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );\n    let offset: vec2<f32> = diffUV * powDiff / gfu.uInputSize.xy;\n    // Do clamp :\n    let coord: vec2<f32> = uv + offset;\n    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);\n\n    var clampedColor: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);\n    \n    if (boolVec2(coord, clampedCoord)) \n    {\n        clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n    // No clamp :\n    var finalColor = clampedColor;\n\n    return select(finalColor, textureSample(uTexture, uSampler, uv), returnColorOnly);\n}\n\nfn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool\n{\n    if (x.x == y.x && x.y == y.y)\n    {\n        return true;\n    }\n    \n    return false;\n}\n\nconst PI: f32 = 3.14159265358979323846264;\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"\nprecision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uCenter;\nuniform float uTime;\nuniform float uSpeed;\nuniform vec4 uWave;\n\nuniform vec4 uInputSize;\nuniform vec4 uInputClamp;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float uAmplitude = uWave[0];\n    float uWavelength = uWave[1];\n    float uBrightness = uWave[2];\n    float uRadius = uWave[3];\n\n    float halfWavelength = uWavelength * 0.5 / uInputSize.x;\n    float maxRadius = uRadius / uInputSize.x;\n    float currentRadius = uTime * uSpeed / uInputSize.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            finalColor = texture(uTexture, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - uCenter / uInputSize.xy);\n    dir.y *= uInputSize.y / uInputSize.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        finalColor = texture(uTexture, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );\n\n    vec2 offset = diffUV * powDiff / uInputSize.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);\n    vec4 color = texture(uTexture, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // finalColor = texture(uTexture, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;\n\n    finalColor = color;\n}\n",name:"shockwave-filter"}),resources:{shockwaveUniforms:{uTime:{value:i.time,type:"f32"},uCenter:{value:i.center,type:"vec2<f32>"},uSpeed:{value:i.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}}}}),Ou(this,"uniforms"),Ou(this,"time"),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,i)}apply(t,e,i,n){this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get center(){return this.uniforms.uCenter}set center(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uCenter=t}get centerX(){return this.uniforms.uCenter.x}set centerX(t){this.uniforms.uCenter.x=t}get centerY(){return this.uniforms.uCenter.y}set centerY(t){this.uniforms.uCenter.y=t}get speed(){return this.uniforms.uSpeed}set speed(t){this.uniforms.uSpeed=t}get amplitude(){return this.uniforms.uWave[0]}set amplitude(t){this.uniforms.uWave[0]=t}get wavelength(){return this.uniforms.uWave[1]}set wavelength(t){this.uniforms.uWave[1]=t}get brightness(){return this.uniforms.uWave[2]}set brightness(t){this.uniforms.uWave[2]=t}get radius(){return this.uniforms.uWave[3]}set radius(t){this.uniforms.uWave[3]=t}};Ou(ku,"DEFAULT_OPTIONS",{center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1});var Eu=Object.defineProperty,Ru=(t,e,i)=>(((t,e,i)=>{e in t?Eu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const zu=class t extends Et.d{constructor(...e){let i=e[0]??{};if(i instanceof x.g&&((0,d.t6)("6.0.0","SimpleLightmapFilter constructor params are now options object. See params: { lightMap, color, alpha }"),i={lightMap:i},void 0!==e[1]&&(i.color=e[1]),void 0!==e[2]&&(i.alpha=e[2])),i={...t.DEFAULT_OPTIONS,...i},!i.lightMap)throw Error("No light map texture source was provided to SimpleLightmapFilter");super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct SimpleLightmapUniforms {\n  uColor: vec3<f32>,\n  uAlpha: f32,\n  uDimensions: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> simpleLightmapUniforms : SimpleLightmapUniforms;\n@group(1) @binding(1) var uMapTexture: texture_2d<f32>;\n@group(1) @binding(2) var uMapSampler: sampler;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>,\n) -> @location(0) vec4<f32> {\n  let uColor = simpleLightmapUniforms.uColor;\n  let uAlpha = simpleLightmapUniforms.uAlpha;\n  let uDimensions = simpleLightmapUniforms.uDimensions;\n\n  let diffuseColor: vec4<f32> = textureSample(uTexture, uSampler, uv);\n  let lightCoord: vec2<f32> = (uv * gfu.uInputSize.xy) / simpleLightmapUniforms.uDimensions;\n  let light: vec4<f32> = textureSample(uMapTexture, uMapSampler, lightCoord);\n  let ambient: vec3<f32> = uColor * uAlpha;\n  let intensity: vec3<f32> = ambient + light.rgb;\n  let finalColor: vec3<f32> = diffuseColor.rgb * intensity;\n  return vec4<f32>(finalColor, diffuseColor.a);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMapTexture;\nuniform vec3 uColor;\nuniform float uAlpha;\nuniform vec2 uDimensions;\n\nuniform vec4 uInputSize;\n\nvoid main() {\n    vec4 diffuseColor = texture(uTexture, vTextureCoord);\n    vec2 lightCoord = (vTextureCoord * uInputSize.xy) / uDimensions;\n    vec4 light = texture(uMapTexture, lightCoord);\n    vec3 ambient = uColor.rgb * uAlpha;\n    vec3 intensity = ambient + light.rgb;\n    vec3 color = diffuseColor.rgb * intensity;\n    finalColor = vec4(color, diffuseColor.a);\n}\n",name:"simple-lightmap-filter"}),resources:{simpleLightmapUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:i.alpha,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}},uMapTexture:i.lightMap.source,uMapSampler:i.lightMap.source.style}}),Ru(this,"uniforms"),Ru(this,"_color"),Ru(this,"_lightMap"),this.uniforms=this.resources.simpleLightmapUniforms.uniforms,this._color=new Mt.Q,this.color=i.color??0,Object.assign(this,i)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,t.applyFilter(this,e,i,n)}get lightMap(){return this._lightMap}set lightMap(t){this._lightMap=t,this.resources.uMapTexture=t.source,this.resources.uMapSampler=t.source.style}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,i,n]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};Ru(zu,"DEFAULT_OPTIONS",{lightMap:x.g.WHITE,color:0,alpha:1});var Fu=Object.defineProperty,Uu=(t,e,i)=>(((t,e,i)=>{e in t?Fu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Du=class t extends Et.d{constructor(e){const{width:i,height:n}=Yt.v.defaultOptions;e={...t.DEFAULT_OPTIONS,start:{x:0,y:n/2},end:{x:i,y:n/2},...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct TiltShiftUniforms {\n  uBlur: vec2<f32>,\n  uStart: vec2<f32>,\n  uEnd: vec2<f32>,\n  uDelta: vec2<f32>,\n  uDimensions: vec2<f32>,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> tiltShiftUniforms : TiltShiftUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uBlur = tiltShiftUniforms.uBlur[0];\n  let uBlurGradient = tiltShiftUniforms.uBlur[1];\n  let uStart = tiltShiftUniforms.uStart;\n  let uEnd = tiltShiftUniforms.uEnd;\n  let uDelta = tiltShiftUniforms.uDelta;\n  let uDimensions = tiltShiftUniforms.uDimensions;\n\n  var color: vec4<f32> = vec4<f32>(0.0);\n  var total: f32 = 0.0;\n\n  let offset: f32 = random(position, vec3<f32>(12.9898, 78.233, 151.7182), 0.0);\n  let normal: vec2<f32> = normalize(vec2<f32>(uStart.y - uEnd.y, uEnd.x - uStart.x));\n  let radius: f32 = smoothstep(0.0, 1.0, abs(dot(uv * uDimensions - uStart, normal)) / uBlurGradient) * uBlur;\n\n  for (var t: f32 = -30.0; t <= 30.0; t += 1.0)\n  {\n    var percent: f32 = (t + offset - 0.5) / 30.0;\n    var weight: f32 = 1.0 - abs(percent);\n    var sample: vec4<f32> = textureSample(uTexture, uSampler, uv + uDelta / uDimensions * percent * radius);\n    sample = vec4<f32>(sample.xyz * sample.a, sample.a); // multiply sample.rgb with sample.a\n    color += sample * weight;\n    total += weight;\n  }\n\n  color /= total;\n  color = vec4<f32>(color.xyz / (color.a + 0.00001), color.a); // divide color.rgb by color.a + 0.00001\n\n  return color;\n}\n\n\nfn random(position: vec4<f32>, scale: vec3<f32>, seed: f32) -> f32\n{\n  return fract(sin(dot(position.xyz + seed, scale)) * 43758.5453 + seed);\n}",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"in vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uBlur;\nuniform vec2 uStart;\nuniform vec2 uEnd;\nuniform vec2 uDelta;\nuniform vec2 uDimensions;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float blur = uBlur[0];\n    float gradientBlur = uBlur[1];\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(uStart.y - uEnd.y, uEnd.x - uStart.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * uDimensions - uStart, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture(uTexture, vTextureCoord + uDelta / uDimensions * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    finalColor = color;\n}\n",name:"tilt-shift-axis-filter"}),resources:{tiltShiftUniforms:{uBlur:{value:new Float32Array([e.blur,e.gradientBlur]),type:"vec2<f32>"},uStart:{value:e.start,type:"vec2<f32>"},uEnd:{value:e.end,type:"vec2<f32>"},uDelta:{value:new Float32Array([0,0]),type:"vec2<f32>"},uDimensions:{value:new Float32Array([i,n]),type:"vec2<f32>"}}}}),Uu(this,"uniforms"),Uu(this,"_tiltAxis"),this.uniforms=this.resources.tiltShiftUniforms.uniforms,this._tiltAxis=e.axis}updateDimensions(t){const{uDimensions:e}=this.uniforms;e[0]=t.frame.width,e[1]=t.frame.height}updateDelta(){if(this.uniforms.uDelta[0]=0,this.uniforms.uDelta[1]=0,void 0===this._tiltAxis)return;const t=this.uniforms.uEnd,e=this.uniforms.uStart,i=t.x-e.x,n=t.y-e.y,r=Math.sqrt(i*i+n*n),s="vertical"===this._tiltAxis;this.uniforms.uDelta[0]=s?-n/r:i/r,this.uniforms.uDelta[1]=s?i/r:n/r}};Uu(Du,"DEFAULT_OPTIONS",{blur:100,gradientBlur:600});Object.defineProperty;var Bu=Object.defineProperty,Lu=(t,e,i)=>(((t,e,i)=>{e in t?Bu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Nu=class t extends Et.d{constructor(e){e={...t.DEFAULT_OPTIONS,...e};super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct TwistUniforms {\n  uTwist:vec2<f32>,\n  uOffset:vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> twistUniforms : TwistUniforms;\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n  return textureSample(uTexture, uSampler, unmapCoord(twist(mapCoord(uv))));\n}\n\nfn mapCoord(coord: vec2<f32> ) -> vec2<f32>\n{\n  var mappedCoord: vec2<f32> = coord;\n  mappedCoord *= gfu.uInputSize.xy;\n  mappedCoord += gfu.uOutputFrame.xy;\n  return mappedCoord;\n}\n\nfn unmapCoord(coord: vec2<f32> ) -> vec2<f32>\n{\n  var mappedCoord: vec2<f32> = coord;\n  mappedCoord -= gfu.uOutputFrame.xy;\n  mappedCoord /= gfu.uInputSize.xy;\n  return mappedCoord;\n}\n\nfn twist(coord: vec2<f32>) -> vec2<f32>\n{\n  var twistedCoord: vec2<f32> = coord;\n  let uRadius = twistUniforms.uTwist[0];\n  let uAngle = twistUniforms.uTwist[1];\n  let uOffset = twistUniforms.uOffset;\n\n  twistedCoord -= uOffset;\n  \n  let dist = length(twistedCoord);\n\n  if (dist < uRadius)\n  {\n    let ratioDist: f32 = (uRadius - dist) / uRadius;\n    let angleMod: f32 = ratioDist * ratioDist * uAngle;\n    let s: f32 = sin(angleMod);\n    let c: f32 = cos(angleMod);\n    twistedCoord = vec2<f32>(twistedCoord.x * c - twistedCoord.y * s, twistedCoord.x * s + twistedCoord.y * c);\n  }\n\n  twistedCoord += uOffset;\n  return twistedCoord;\n}\n",entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uTwist;\nuniform vec2 uOffset;\nuniform vec4 uInputSize;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= uInputSize.xy;\n    coord += uInputSize.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= uInputSize.zw;\n    coord /= uInputSize.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= uOffset;\n\n    float dist = length(coord);\n    float uRadius = uTwist[0];\n    float uAngle = uTwist[1];\n\n    if (dist < uRadius)\n    {\n        float ratioDist = (uRadius - dist) / uRadius;\n        float angleMod = ratioDist * ratioDist * uAngle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += uOffset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n    vec2 coord = mapCoord(vTextureCoord);\n    coord = twist(coord);\n    coord = unmapCoord(coord);\n    finalColor = texture(uTexture, coord);\n}\n",name:"twist-filter"}),resources:{twistUniforms:{uTwist:{value:[e.radius??0,e.angle??0],type:"vec2<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},...e}),Lu(this,"uniforms"),this.uniforms=this.resources.twistUniforms.uniforms}get radius(){return this.uniforms.uTwist[0]}set radius(t){this.uniforms.uTwist[0]=t}get angle(){return this.uniforms.uTwist[1]}set angle(t){this.uniforms.uTwist[1]=t}get offset(){return this.uniforms.uOffset}set offset(t){this.uniforms.uOffset=t}get offsetX(){return this.offset.x}set offsetX(t){this.offset.x=t}get offsetY(){return this.offset.y}set offsetY(t){this.offset.y=t}};Lu(Nu,"DEFAULT_OPTIONS",{padding:20,radius:200,angle:4,offset:{x:0,y:0}});var $u=Object.defineProperty,Vu=(t,e,i)=>(((t,e,i)=>{e in t?$u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const Gu=class t extends Et.d{constructor(e){const i=(e={...t.DEFAULT_OPTIONS,...e}).maxKernelSize??32;super({gpuProgram:Ot.B.from({vertex:{source:Va,entryPoint:"mainVertex"},fragment:{source:"struct ZoomBlurUniforms {\n    uStrength:f32,\n    uCenter:vec2<f32>,\n    uRadii:vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> zoomBlurUniforms : ZoomBlurUniforms;\n\n@fragment\nfn mainFragment(\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uStrength = zoomBlurUniforms.uStrength;\n  let uCenter = zoomBlurUniforms.uCenter;\n  let uRadii = zoomBlurUniforms.uRadii;\n\n  let minGradient: f32 = uRadii[0] * 0.3;\n  let innerRadius: f32 = (uRadii[0] + minGradient * 0.5) / gfu.uInputSize.x;\n\n  let gradient: f32 = uRadii[1] * 0.3;\n  let radius: f32 = (uRadii[1] - gradient * 0.5) / gfu.uInputSize.x;\n\n  let MAX_KERNEL_SIZE: f32 = ${MAX_KERNEL_SIZE};\n\n  var countLimit: f32 = MAX_KERNEL_SIZE;\n\n  var dir: vec2<f32> = vec2<f32>(uCenter / gfu.uInputSize.xy - uv);\n  let dist: f32 = length(vec2<f32>(dir.x, dir.y * gfu.uInputSize.y / gfu.uInputSize.x));\n\n  var strength: f32 = uStrength;\n\n  var delta: f32 = 0.0;\n  var gap: f32;\n\n  if (dist < innerRadius) {\n      delta = innerRadius - dist;\n      gap = minGradient;\n  } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n      delta = dist - radius;\n      gap = gradient;\n  }\n\n  var returnColorOnly: bool = false;\n\n  if (delta > 0.0) {\n    let normalCount: f32 = gap / gfu.uInputSize.x;\n    delta = (normalCount - delta) / normalCount;\n    countLimit *= delta;\n    strength *= delta;\n    \n    if (countLimit < 1.0)\n    {\n      returnColorOnly = true;;\n    }\n  }\n\n  // randomize the lookup values to hide the fixed number of samples\n  let offset: f32 = rand(uv, 0.0);\n\n  var total: f32 = 0.0;\n  var color: vec4<f32> = vec4<f32>(0.);\n\n  dir *= strength;\n\n  for (var t = 0.0; t < MAX_KERNEL_SIZE; t += 1.0) {\n    let percent: f32 = (t + offset) / MAX_KERNEL_SIZE;\n    let weight: f32 = 4.0 * (percent - percent * percent);\n    let p: vec2<f32> = uv + dir * percent;\n    let sample: vec4<f32> = textureSample(uTexture, uSampler, p);\n    \n    if (t < countLimit)\n    {\n      color += sample * weight;\n      total += weight;\n    }\n  }\n\n  color /= total;\n\n  return select(color, textureSample(uTexture, uSampler, uv), returnColorOnly);\n}\n\nfn modulo(x: f32, y: f32) -> f32\n{\n  return x - y * floor(x/y);\n}\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nfn rand(co: vec2<f32>, seed: f32) -> f32\n{\n  let a: f32 = 12.9898;\n  let b: f32 = 78.233;\n  let c: f32 = 43758.5453;\n  let dt: f32 = dot(co + seed, vec2<f32>(a, b));\n  let sn: f32 = modulo(dt, 3.14159);\n  return fract(sin(sn) * c + seed);\n}".replace("${MAX_KERNEL_SIZE}",i.toFixed(1)),entryPoint:"mainFragment"}}),glProgram:It.M.from({vertex:$a,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uStrength;\nuniform vec2 uCenter;\nuniform vec2 uRadii;\n\nuniform vec4 uInputSize;\n\nconst float MAX_KERNEL_SIZE = ${MAX_KERNEL_SIZE};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n    float minGradient = uRadii[0] * 0.3;\n    float innerRadius = (uRadii[0] + minGradient * 0.5) / uInputSize.x;\n\n    float gradient = uRadii[1] * 0.3;\n    float radius = (uRadii[1] - gradient * 0.5) / uInputSize.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / uInputSize.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * uInputSize.y / uInputSize.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / uInputSize.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture(uTexture, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture(uTexture, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${MAX_KERNEL_SIZE}",i.toFixed(1)),name:"zoom-blur-filter"}),resources:{zoomBlurUniforms:{uStrength:{value:e.strength,type:"f32"},uCenter:{value:e.center,type:"vec2<f32>"},uRadii:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Vu(this,"uniforms"),this.uniforms=this.resources.zoomBlurUniforms.uniforms,Object.assign(this,e)}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}get center(){return this.uniforms.uCenter}set center(t){Array.isArray(t)&&(t={x:t[0],y:t[1]}),this.uniforms.uCenter=t}get centerX(){return this.uniforms.uCenter.x}set centerX(t){this.uniforms.uCenter.x=t}get centerY(){return this.uniforms.uCenter.y}set centerY(t){this.uniforms.uCenter.y=t}get innerRadius(){return this.uniforms.uRadii[0]}set innerRadius(t){this.uniforms.uRadii[0]=t}get radius(){return this.uniforms.uRadii[1]}set radius(t){this.uniforms.uRadii[1]=t<0||t===1/0?-1:t}};Vu(Gu,"DEFAULT_OPTIONS",{strength:.1,center:{x:0,y:0},innerRadius:0,radius:-1,maxKernelSize:32});class ju extends h.mc{constructor(){super(),this.gameState={state:Sa.ReadyToShake,selectedValue:-1,userValue:-1,result:[],betDetail:{nai:[],bau:[],ga:[],ca:[],cua:[],tom:[]},coinPool:{nai:[],bau:[],ga:[],ca:[],cua:[],tom:[]}},this.targetResult=0,this.betTime=8,this.rewardByDices=[],this.coinWinArray=[],this.coinLoseArray=[],this.bettableValue=[],this.instructionText=["Bm  bt u lc","Chn  mun t cc","Bm vo t  xem kt qu"],this.errorText=["Khng  tin  t !!","S tin cc qu hn mc"],this.selectedCoinMark=new Wt.b,this.eslapseTime=0,this.getConfig(),this.topContainer=new wa(this,this.bettableValue),this.centerContainer=new Ia(this),this.bottomContainer=new ka(this),this.instructionTextUI=new re({text:this.instructionText[0],style:{align:"center",fontSize:20,fontFamily:"Archia Medium",fill:"white"}}),this.instructionTextUI.eventMode="static",this.instructionTextUI.position.set(Xo.width/2-this.instructionTextUI.width/2,Xo.height/2-30),this.instructionTextUI.anchor.set(.5),this.backgroundUI=new Ko({width:Xo.width,height:Xo.height,texture:"game_bg"}),this.addChild(this.backgroundUI),this.addHeader(),this.addChild(this.topContainer),this.addChild(this.centerContainer),this.addChild(this.bottomContainer),this.resize(),this.coinPoolUIContainer=new h.mc,this.addChild(this.coinPoolUIContainer),this.userValueUI=new re,this.addCurrentCoin(),this.addSettingButton(),setTimeout((()=>{this.selectedCoinMark=this.topContainer.values[0].getGlobalPosition(),this.topContainer.selectBetValue(this.topContainer.values[0]._id)}),1),this.dimUI=te.k.from("example_bg"),this.dimUI.width=Xo.width,this.dimUI.height=Xo.height,this.dimUI.alpha=0,this.addChild(this.dimUI),this.dimUI.eventMode="static",this.dimUI.on("pointerdown",(()=>{this.instructionTextUI.visible=!1,this.dimUI.interactive=!1,this.pressToShake()})),Ua.on(Da.UPDATE_RESULT,(({params:t})=>{console.log("dice data",t),this.gameState.result=t.result,this.centerContainer.showResult(this.gameState.result),this.targetResult=t.gold}))}getConfig(){const t=Xo.GameConfig,e=Xo.PlayerData;this.gameState={state:Sa.ReadyToShake,selectedValue:t.chipList[0],userValue:e.gold,result:[],betDetail:{nai:[],bau:[],ga:[],ca:[],cua:[],tom:[]},coinPool:{nai:[],bau:[],ga:[],ca:[],cua:[],tom:[]}},this.bettableValue=[];for(let e=0;e<t.chipList.length;e++)this.bettableValue.push({label:`${t.chipList[e]}`,value:t.chipList[e],icon:"coin"});this.betTime=t.maxTurnBet}update(t){const e=t/100;if(this.gameState.state===Sa.ShowResult){if(this.eslapseTime>.1){if(this.eslapseTime=0,this.coinWinArray.length>0){const t=this.coinWinArray.pop();if(t){const{x:e,y:i}=this.userValueUI.getGlobalPosition();ho.to(t.position,{x:e-40,y:i+10,duration:.5,ease:"back.out",onComplete:()=>{t.visible=!1}}),ho.to(t.scale,{x:.5,y:.5,duration:.6})}}if(this.coinLoseArray.length>0){const t=this.coinLoseArray.pop();t&&ho.to(t.scale,{x:0,y:0,duration:.5,ease:"back.out",onComplete:()=>{t.visible=!1}})}}0===this.coinWinArray.length&&0===this.coinLoseArray.length&&(this.gameState.coinPool.nai=[],this.gameState.coinPool.bau=[],this.gameState.coinPool.ga=[],this.gameState.coinPool.ca=[],this.gameState.coinPool.cua=[],this.gameState.coinPool.tom=[],this.coinPoolUIContainer.removeChildren(),this.gameState.state=Sa.ReadyToShake,this.gameState.userValue=this.targetResult,this.instructionTextUI.visible=!0,this.instructionTextUI.text=this.instructionText[0],this.instructionTextUI.position.set(Xo.width/2-this.instructionTextUI.width/2,Xo.height/2),this.dimUI.interactive=!0),this.gameState.userValue!=this.targetResult&&(this.gameState.userValue+=this.targetResult>this.gameState.userValue?1:-1),this.eslapseTime+=e}this.userValueUI.text=this.gameState.userValue.toLocaleString()}resize(){console.log("resize",Xo.width,Xo.height),this.backgroundUI.width=Xo.width,this.backgroundUI.height=Xo.height}onSelectedDefaultBet(t,e){this.gameState.selectedValue=t,this.selectedCoinMark.set(e.x,e.y),this.topContainer.selectBetValue(t)}chooseProperOne(t){return t>=0?this.bettableValue[t].value<=this.gameState.userValue?t:this.chooseProperOne(t-1):-1}betOnValue(t,e){if(this.betTime>0&&(this.gameState.state==Sa.Betting||this.gameState.state==Sa.MakeFirstBet)){const i=this.bettableValue.findIndex((t=>t.value==this.gameState.selectedValue)),n=this.chooseProperOne(i);if(!(n>=0))return;this.onSelectedDefaultBet(this.bettableValue[n].value,this.topContainer.values[n].getGlobalPosition()),console.log(`bet on ${t} with value: ${this.gameState.selectedValue}`);const r=new Ta(this.gameState.selectedValue.toString()),s=this.gameState.betDetail,o=this.gameState.coinPool;Object.keys(s).forEach((e=>{this.isKey(s,e)&&e===t&&(s[e].push(this.gameState.selectedValue),o[e].push(r))}));const a=this.selectedCoinMark;r.position.set(a.x,a.y),this.coinPoolUIContainer.addChild(r);let l=Xo.width/3/6,u=0;s[t].length>4&&(u=30),ho.to(r.position,{x:e.x-3*l+l*(s[t].length>4?s[t].length-5:s[t].length-1),y:e.y+(s[t].length%2==0?10:0)-u,duration:.5,ease:"back.out"}),this.gameState.userValue-=this.gameState.selectedValue,this.centerContainer.bowl.visible=!0,this.instructionTextUI.text=this.instructionText[2],this.instructionTextUI.position.set(Xo.width/2-this.instructionTextUI.width/2,Xo.height/2),this.gameState.state!=Sa.MakeFirstBet&&(this.gameState.state=Sa.MakeFirstBet),this.betTime--,this.centerContainer.betTimesUI.text=`Lt t cn li: ${this.betTime}`}}updateBetResult(t){var e,i;if(this.canOpenBowl()){this.gameState.result=[],this.rewardByDices=[],this.gameState.state=Sa.OpeningBet;const t=[],n=this.gameState.betDetail;Object.keys(n).forEach((e=>{this.isKey(n,e)&&n[e].length&&t.push({id:e,bet:n[e]})})),console.log("listBet",t),null===(i=null===(e=Na.Senders)||void 0===e?void 0:e.Game)||void 0===i||i.sendRequestPlay(t)}}dice(){return`bet_${Math.floor(Ca(1,7))}`}countInArray(t,e){return t.reduce(((t,i)=>t+(i===e?1:0)),0)}processCoinAnimation(){var t,e,i;this.centerContainer.bowl.interactive=!1;const n=this.gameState.betDetail,r=this.gameState.coinPool,s=Object.keys(n);let o=0;s.forEach((t=>{if(this.isKey(n,t)&&n[t].length>0){const e=this.countInArray(this.gameState.result,t);if(e>0){const i=n[t].reduce(((t,e)=>t+e),0);if(console.log(`${t} + ${i} ${e} times `),o+=i*(e+1),r[t]&&r[t].length>0)for(let e=r[t].length-1;e>=0;e--)this.coinWinArray.push(r[t][e])}else{const e=n[t].reduce(((t,e)=>t+e),0);if(r[t]&&r[t].length>0)for(let e=r[t].length-1;e>=0;e--)this.coinLoseArray.push(r[t][e]);console.log(`${t} - ${e} `)}}})),console.log(`Final: ${this.gameState.userValue} (${o>=0?"+":"-"} ${o})`),this.gameState.state=Sa.ShowResult,null===(t=this.centerContainer.betDice_1)||void 0===t||t.showResult(this.getRewardByKey(n,this.gameState.result[0])),null===(e=this.centerContainer.betDice_2)||void 0===e||e.showResult(this.getRewardByKey(n,this.gameState.result[1])),null===(i=this.centerContainer.betDice_3)||void 0===i||i.showResult(this.getRewardByKey(n,this.gameState.result[2])),s.forEach((t=>{this.isKey(n,t)&&(n[t]=[])})),this.betTime=Xo.GameConfig.maxTurnBet,this.centerContainer.betTimesUI.text=`Lt t cn li: ${this.betTime}`}getRewardByKey(t,e){if(this.isKey(t,e)&&t[e].length>0){const i=t[e].reduce(((t,e)=>t+e),0);return`+ ${i}`}return""}isKey(t,e){return e in t}pressToShake(){if(this.gameState.state==Sa.ReadyToShake){const t=ho.timeline();this.centerContainer.bowl.position.set(-100,100),this.centerContainer.bowl.visible=!0,this.centerContainer.bowl.interactive=!1,t.to(this.centerContainer.bowl,{x:Xo.width/2,y:Xo.height/5,duration:.5,ease:"back.in"}),t.to(this.centerContainer.shakingContainer,{duration:.1,x:"+=5",y:"+=20",repeat:10,yoyo:!0,ease:"sine.inOut",onComplete:()=>{this.centerContainer.bowl.interactive=!0,this.centerContainer.shakingContainer.position.set(0,Xo.height/11)}}),this.gameState.state=Sa.Betting,this.instructionTextUI.text=this.instructionText[1],this.instructionTextUI.position.set(Xo.width/2-this.instructionTextUI.width/2,Xo.height/2),this.instructionTextUI.visible=!0}}canOpenBowl(){return this.gameState.state==Sa.MakeFirstBet}addCurrentCoin(){const t=new h.mc,e=(new qt.A).rect(0,0,110,25).fill("#453003");e.position.set(20,3);const i=te.k.from("currency");i.width=30,i.height=30,this.userValueUI=new re({text:Xo.PlayerData.gold.toLocaleString(),style:{fontSize:15,fill:"white",fontFamily:"Archia Medium",align:"right"}}),this.userValueUI.anchor.set(1,0),this.userValueUI.position.set(115,5);const n=new _a({width:25,height:25,texture:"add_coin_btn",onClick:()=>{}});n.position.set(128,15),t.addChild(e),t.addChild(i),t.addChild(this.userValueUI),t.addChild(n),this.addChild(t),t.position.set(Xo.width-200,15)}addSettingButton(){const t=new _a({width:30,height:30,texture:"setting_btn",onClick:()=>{}});t.position.set(Xo.width-30,30),this.addChild(t)}addHeader(){const t=(new qt.A).rect(0,0,Xo.width,70).fill("#FFCF10");t.filters=[new Xl({offset:{x:2,y:2}})],this.addChild(t);const e=(new qt.A).rect(0,68,Xo.width,2).fill("white");e.alpha=.7,this.addChild(e);const i=te.k.from("back_button");i.position.set(10,18),i.eventMode="static",i.on("pointerup",(t=>{Xo.changeScreen(new _h)})),this.addChild(i)}}function Hu(t){t=Number(t);var e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%3600%60);return(e>0?e<10?"0"+e+":":e+":":"00:")+(i>0?i<10?"0"+i+":":i+":":"00:")+(n>0?n<10?"0"+n:n:"00")}var Wu=Object.defineProperty,Xu=(t,e,i)=>(((t,e,i)=>{e in t?Wu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class Yu extends h.mc{constructor(t){super(),Xu(this,"options"),Xu(this,"view"),Xu(this,"_type"),Xu(this,"children",[]),t&&this.init(t),t?.items?.forEach((t=>this.addChild(t))),this.on("added",(()=>this.arrangeChildren())),this.on("childAdded",(()=>this.arrangeChildren()))}init(t){this.options=t,t?.type&&(this.type=t.type),t?.children&&t.children.forEach((t=>this.addChild(t)))}set type(t){this._type=t,this.arrangeChildren()}get type(){return this._type}set elementsMargin(t){if(!this.options)throw new Error("List has not been initiated!");this.options.elementsMargin=t,this.arrangeChildren()}get elementsMargin(){return this.options?.elementsMargin??0}set padding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.padding=t,this.options.vertPadding=t,this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get padding(){return this.options?.padding??0}set vertPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.vertPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get vertPadding(){return this.options?.vertPadding??this.padding??0}set horPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.arrangeChildren()}get horPadding(){return this.options?.horPadding??this.padding??0}set leftPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.leftPadding=t,this.arrangeChildren()}get leftPadding(){return this.options?.leftPadding??this.horPadding}set rightPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.rightPadding=t,this.arrangeChildren()}get rightPadding(){return this.options?.rightPadding??this.horPadding}set topPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.topPadding=t,this.arrangeChildren()}get topPadding(){return this.options?.topPadding??this.vertPadding}set bottomPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.bottomPadding=t,this.arrangeChildren()}get bottomPadding(){return this.options?.bottomPadding??this.vertPadding}arrangeChildren(){let t=0,e=this.leftPadding,i=this.topPadding;const n=this.options?.elementsMargin??0;let r=this.parent?.width;this.rightPadding&&(r-=this.rightPadding),this.children.forEach(((s,o)=>{switch(this.type){case"vertical":s.y=i,s.x=e,i+=n+s.height;break;case"horizontal":s.x=e,s.y=i,e+=n+s.width;break;default:s.x=e,s.y=i,s.x+s.width>r&&o>0&&(i+=n+t,e=this.leftPadding,s.x=e,s.y=i,t=0),t=Math.max(t,s.height),e+=n+s.width}}))}removeItem(t){const e=this.children[t];e&&(this.removeChild(e),this.arrangeChildren())}}var qu=Object.defineProperty,Ku=(t,e,i)=>(((t,e,i)=>{e in t?qu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class Zu{constructor(t={}){Ku(this,"x"),Ku(this,"ax"),Ku(this,"dx"),Ku(this,"tx"),Ku(this,"_options"),this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}var Qu=Object.defineProperty,Ju=(t,e,i)=>(((t,e,i)=>{e in t?Qu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class th{constructor(){Ju(this,"done"),Ju(this,"to"),Ju(this,"_spring"),Ju(this,"_pos"),Ju(this,"_speed"),Ju(this,"_correctSpeed"),this._spring=new Zu,this._pos=0,this.to=0}start(t,e,i){this._speed=t,this._pos=e,this.to=i,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const n=this.to-this._pos,r=Math.abs(n)/n,s=Math.abs(this._speed)/this._speed;this._correctSpeed=r!==s}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}var eh=Object.defineProperty,ih=(t,e,i)=>(((t,e,i)=>{e in t?eh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class nh{constructor(t={}){ih(this,"position",0),ih(this,"constrain",!0),ih(this,"min",0),ih(this,"max",0),ih(this,"maxSpeed",400),ih(this,"_ease"),ih(this,"_offset",0),ih(this,"_prev",0),ih(this,"_speed",0),ih(this,"_hasStopped"),ih(this,"_targetSpeed",0),ih(this,"_speedChecker",0),ih(this,"_grab",0),ih(this,"_activeEase"),this.constrain=t.constrain??!0,this.maxSpeed=t.maxSpeed??400,this._ease=t.ease??new th}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(t=!1){this._hasStopped||(this.constrain?this._updateConstrain(t):this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?-1*this._speed:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(t=!1){const e=this.max;t?(this.value>0&&(this.value=0),this.value>0&&(this.value=0),this.value<this.max&&(this.value=this.max),this.value<this.max&&(this.value=this.max)):this.position>this.min||this.position<e||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,e)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}var rh=Object.defineProperty,sh=(t,e,i)=>(((t,e,i)=>{e in t?rh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class oh{constructor(t){sh(this,"xAxis"),sh(this,"yAxis"),sh(this,"_isDown"),sh(this,"_globalPosition"),sh(this,"_frame"),sh(this,"_bounds"),sh(this,"_dirty"),sh(this,"disableEasing",!1),this.xAxis=new nh({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new nh({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.disableEasing=t.disableEasing??!1,this._frame=new y.M,this._bounds=new y.M,this._globalPosition=new Wt.b}pointerDown(t){this._globalPosition=t,this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(this.disableEasing),this.yAxis.slide(this.disableEasing))}resize(t,e){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=e,this._dirty=!0}setBounds(t,e,i,n){this._bounds.x=t,this._bounds.width=e-t,this._bounds.y=i,this._bounds.height=n-i,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}var ah=Object.defineProperty,lh=(t,e,i)=>(((t,e,i)=>{e in t?ah(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);class uh extends h.mc{constructor(t){super(),lh(this,"background"),lh(this,"borderMask"),lh(this,"lastWidth"),lh(this,"lastHeight"),lh(this,"__width",0),lh(this,"__height",0),lh(this,"_dimensionChanged",!1),lh(this,"list"),lh(this,"_trackpad"),lh(this,"isDragging",0),lh(this,"interactiveStorage",[]),lh(this,"visibleItems",[]),lh(this,"pressedChild"),lh(this,"ticker",se.R.shared),lh(this,"options"),lh(this,"stopRenderHiddenItemsTimeout"),lh(this,"onMouseScrollBinding",this.onMouseScroll.bind(this)),lh(this,"dragStarTouchPoint"),lh(this,"isOver",!1),lh(this,"proximityRange"),lh(this,"proximityStatusCache",[]),lh(this,"lastScrollX"),lh(this,"lastScrollY"),lh(this,"proximityCheckFrameCounter",0),lh(this,"onProximityChange",new ra.HN),lh(this,"onScroll",new ra.HN),t&&this.init(t),this.ticker.add(this.update,this)}init(t){this.options=t,this.setBackground(t.background),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,this.proximityRange=t.proximityRange??0,this.list||(this.list=new Yu,super.addChild(this.list)),this.list.init({type:t.type,elementsMargin:t.elementsMargin,padding:t.padding,vertPadding:t.vertPadding,horPadding:t.horPadding,topPadding:t.topPadding,bottomPadding:t.bottomPadding,leftPadding:t.leftPadding,rightPadding:t.rightPadding}),this.addItems(t.items),this.hasBounds&&(this.addMask(),this.makeScrollable()),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.options.globalScroll=t.globalScroll??!0,this.options.shiftScroll=t.shiftScroll??!1,this.resize()}get hasBounds(){return!!this.__width||!!this.__height}addItems(t){t?.length&&t.forEach((t=>this.addItem(t)))}removeItems(){this.proximityStatusCache.length=0,this.list.removeChildren()}addItem(...t){if(t.length>1)t.forEach((t=>this.addItem(t)));else{const e=t[0];e.width&&e.height||console.error("ScrollBox item should have size"),e.eventMode="static",this.list.addChild(e),this.proximityStatusCache.push(!1),this.options.disableDynamicRendering||(e.renderable=this.isItemVisible(e))}return this.resize(),t[0]}removeItem(t){this.list.removeItem(t),this.proximityStatusCache.splice(t,1),this.resize()}isItemVisible(t,e=0){const i="vertical"===this.options.type||!this.options.type;let n=!1;const r=this.list;if(i){const i=t.y+r.y;i+t.height>=-e&&i<=this.options.height+e&&(n=!0)}else{const i=t.x+r.x;i+t.width>=-e&&i<=this.options.width+e&&(n=!0)}return n}get items(){return this.list?.children??[]}setBackground(t){this.background&&this.removeChild(this.background),this.options.background=t,this.background=new qt.A,this.addChildAt(this.background,0),this.resize()}addMask(){this.borderMask||(this.borderMask=new qt.A,super.addChild(this.borderMask),this.mask=this.borderMask),this.resize()}makeScrollable(){this._trackpad||(this._trackpad=new oh({disableEasing:this.options.disableEasing})),this.on("pointerdown",(t=>{this.renderAllItems(),this.isDragging=1,this.dragStarTouchPoint=this.worldTransform.applyInverse(t.global),this._trackpad.pointerDown(this.dragStarTouchPoint);const e=this.list.worldTransform.applyInverse(t.global);this.visibleItems.forEach((t=>{t.x<e.x&&t.x+t.width>e.x&&t.y<e.y&&t.y+t.height>e.y&&(this.pressedChild=t)}))})),this.on("pointerup",(()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=null,this.stopRenderHiddenItems()})),this.on("pointerover",(()=>{this.isOver=!0})),this.on("pointerout",(()=>{this.isOver=!1})),this.on("pointerupoutside",(()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=null,this.stopRenderHiddenItems()})),this.on("globalpointermove",(t=>{if(!this.isDragging)return;const e="horizontal"!==this.options.type,i=this.worldTransform.applyInverse(t.global);if(this.dragStarTouchPoint){const t=this.options.dragTrashHold??10;if("horizontal"===this.options.type){const e=i.x-this.dragStarTouchPoint.x;Math.abs(e)>t&&(this.isDragging=2)}else{const e=i.y-this.dragStarTouchPoint.y;Math.abs(e)>t&&(this.isDragging=2)}}this.dragStarTouchPoint&&2!==this.isDragging||(this._trackpad.pointerMove(i),this.pressedChild&&(this.revertClick(this.pressedChild),this.pressedChild=null),this.onScroll?.emit(e?this.scrollY:this.scrollX))})),document.addEventListener("wheel",this.onMouseScrollBinding,!0)}setInteractive(t){this.eventMode=t?"static":"auto"}get listHeight(){return this.list.height+this.list.topPadding+this.list.bottomPadding}get listWidth(){return this.list.width+this.list.leftPadding+this.list.rightPadding}resize(t=!1){if(this.hasBounds){if(this.renderAllItems(),this.borderMask&&(t||this._dimensionChanged||this.lastWidth!==this.listWidth||this.lastHeight!==this.listHeight)){this.options.width||(this.__width+=this.listWidth),this.options.height||(this.__height+=this.listHeight),this.borderMask.clear().roundRect(0,0,this.__width,this.__height,0|this.options.radius).fill(16711935).stroke(0),this.borderMask.eventMode="none";const t=this.options.background;this.background.clear().roundRect(0,0,this.__width,this.__height,0|this.options.radius).fill({color:t??0,alpha:t?1:1e-7}),"horizontal"===this.options.type?this.setInteractive(this.listWidth>this.__width):this.setInteractive(this.listHeight>this.__height),this.lastWidth=this.listWidth,this.lastHeight=this.listHeight}if(this._trackpad){const t=this.borderMask.width-this.list.width-this.list.leftPadding-this.list.rightPadding,e=this.borderMask.height-this.list.height-this.list.topPadding-this.list.bottomPadding;"vertical"===this.options.type?this._trackpad.yAxis.max=-Math.abs(e):("horizontal"===this.options.type||(this._trackpad.yAxis.max=-Math.abs(e)),this._trackpad.xAxis.max=-Math.abs(t))}this._dimensionChanged?(this.list.arrangeChildren(),this.stopRenderHiddenItems(),this._dimensionChanged=!1):this.updateVisibleItems(),this.lastScrollX=null,this.lastScrollY=null}}onMouseScroll(t){if(!this.isOver&&!this.options.globalScroll)return;this.renderAllItems();const e=this.options.shiftScroll?void 0!==t.deltaX||void 0!==t.deltaY:void 0!==t.deltaX;if("horizontal"===this.options.type&&e){const e=this.options.shiftScroll?t.deltaX:t.deltaY,i=this.list.x-e;if(this.listWidth<this.__width)this._trackpad.xAxis.value=0;else{const t=this.__width-this.listWidth,e=0;this._trackpad.xAxis.value=Math.min(e,Math.max(t,i))}this.onScroll?.emit(this._trackpad.xAxis.value)}else if(void 0!==t.deltaY){const e=this.list.y-t.deltaY;if(this.listHeight<this.__height)this._trackpad.yAxis.value=0;else{const t=this.__height-this.listHeight,i=0;this._trackpad.yAxis.value=Math.min(i,Math.max(t,e))}this.onScroll?.emit(this._trackpad.yAxis.value)}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.list.children.length-1):this.scrollTop()}scrollTop(){this.renderAllItems(),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.stopRenderHiddenItems()}renderAllItems(){clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=null,this.options.disableDynamicRendering||this.items.forEach((t=>{t.renderable=!0}))}stopRenderHiddenItems(){this.options.disableDynamicRendering||(this.stopRenderHiddenItemsTimeout&&(clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=null),this.stopRenderHiddenItemsTimeout=setTimeout((()=>this.updateVisibleItems()),2e3))}updateVisibleItems(){this.visibleItems.length=0,this.items.forEach((t=>{t.renderable=this.isItemVisible(t),this.visibleItems.push(t)}))}scrollTo(t){if(!this.interactive)return;const e=this.list.children[t];e&&(this.renderAllItems(),this._trackpad.xAxis.value="horizontal"===this.options.type?this.__width-e.x-e.width-this.list.rightPadding:0,this._trackpad.yAxis.value=this.options.type&&"vertical"!==this.options.type?0:this.__height-e.y-e.height-this.list.bottomPadding,this.stopRenderHiddenItems())}scrollToPosition({x:t,y:e}){void 0===t&&void 0===e||(this.renderAllItems(),void 0!==t&&(this.scrollX=-t),void 0!==e&&(this.scrollY=-e),this.stopRenderHiddenItems())}get height(){return this.__height}set height(t){this.__height=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}get width(){return this.__width}set width(t){this.__width=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}setSize(t,e){"object"==typeof t?(e=t.height??t.width,t=t.width):e=e??t,this.__width=t,this.__height=e,this._dimensionChanged=!0,this.resize(),this.scrollTop()}getSize(t){return(t=t||{width:0,height:0}).width=this.__width,t.height=this.__height,t}get scrollX(){return this._trackpad.xAxis.value}set scrollX(t){this._trackpad.xAxis.value=t}get scrollY(){return this._trackpad.yAxis.value}set scrollY(t){this._trackpad.yAxis.value=t}update(){if(!this.list)return;this._trackpad.update();const t="horizontal"===this.options.type?"x":"y";this.list[t]!==this._trackpad[t]&&(this.list[t]=this._trackpad[t]),this.options.disableProximityCheck||this._trackpad.x===this.lastScrollX&&this._trackpad.y===this.lastScrollY||(this.proximityCheckFrameCounter++,this.proximityCheckFrameCounter>=(this.options.proximityDebounce??10)&&(this.items.forEach(((t,e)=>{const i=this.isItemVisible(t,this.proximityRange);i!==this.proximityStatusCache[e]&&(this.proximityStatusCache[e]=i,this.onProximityChange.emit({item:t,index:e,inRange:i}))})),this.lastScrollX=this._trackpad.x,this.lastScrollY=this._trackpad.y,this.proximityCheckFrameCounter=0))}destroy(t){this.ticker.remove(this.update,this),document.removeEventListener("wheel",this.onMouseScrollBinding,!0),this.background.destroy(),this.list.destroy(),super.destroy(t)}restoreItemsInteractivity(){this.interactiveStorage.forEach((t=>{t.item.eventMode=t.eventMode})),this.interactiveStorage.length=0}revertClick(t){"auto"!==t.eventMode&&(oe.F.any?t.emit("pointerupoutside",null):t.emit("mouseupoutside",null),this.interactiveStorage.push({item:t,eventMode:t.eventMode}),t.eventMode="auto"),t instanceof h.mc&&t.children&&t.children.forEach((t=>this.revertClick(t)))}get scrollHeight(){return this.list.height}get scrollWidth(){return this.list.width}}class hh extends h.mc{constructor(t,e,i){super(),this.addMission(t,e,i)}addMission(t=0,e,i){const n=(new qt.A).roundRect(20,0,.9*Xo.width,100).fill("#FFF0DD");n.filters=[new Xl({})],this.addChild(n);const r=new re({text:e.name,style:{fontSize:17,fontFamily:"Archia Medium"}}),s=n.position.x+20,o=n.position.y;r.position.set(s+20,o+16),this.addChild(r);const a=te.k.from("currency");a.width=25,a.height=25,a.position.set(s+n.width-80,o+15),this.addChild(a);const l=new re({text:e.gold.toLocaleString(),style:{fill:"#23B082",fontSize:15,fontFamily:"Archia Medium"}});l.position.set(s+n.width-50,o+17),this.addChild(l);const u=new re({text:`${e.currentProgress}/${e.progress}`,style:{fontFamily:"Archia Medium",fontSize:15}});if(u.position.set(s+20,o+60),this.addChild(u),e.received){const t=new _a({text:e.buttonText,width:116,height:55,texture:"white_border_button",fill:16777215,fontSize:13});t.position.set(s+Xo.width-116,o+78),t.filters=[new nu],this.addChild(t)}else{const t=new _a({text:e.buttonText,width:116,height:55,texture:"white_border_button",fill:16777215,fontSize:13});t.position.set(s+Xo.width-116,o+78),this.addChild(t)}}}class ch extends h.mc{constructor(){var t,e;super(),this.addBackground(),this.addHeader(),null===(e=null===(t=Na.Senders)||void 0===t?void 0:t.Game)||void 0===e||e.sendGetChallenge(),Ua.on(Da.GET_MISSION_DATA,(({params:t})=>{const{currentCheckin:e,challenges:i}=t;this.addCheckinSession(e);let n=[];if(i&&i.length)for(let t=0;t<i.length;t++){const e=new hh(t,i[t],this);n.push(e)}const r=new uh({width:Xo.width,height:Xo.height-320,elementsMargin:10,bottomPadding:10,items:n});r.position.set(0,320),this.addChild(r)}))}addHeader(){const t=(new qt.A).rect(0,0,Xo.width,70).fill("#FFCF10");t.filters=[new Xl({offset:{x:2,y:2}})],this.addChild(t);const e=(new qt.A).rect(0,68,Xo.width,2).fill("white");e.alpha=.7,this.addChild(e);const i=new re({text:"Nhim v",style:{fontSize:20,fontFamily:"Archia Medium"}});i.anchor.set(.5),i.position.set(Xo.width/2,35),this.addChild(i);const n=te.k.from("back_button");n.position.set(10,18),n.eventMode="static",n.on("pointerup",(t=>{Xo.changeScreen(new _h)})),this.addChild(n)}addCheckinSession(t){const e=(new qt.A).roundRect(.05*Xo.width,100,.9*Xo.width,200).fill("#FFF0DD");e.filters=[new Xl({})],this.addChild(e);const i=te.k.from("checkin_icon");i.position.set(.05*Xo.width+20,120),this.addChild(i);const n=new re({text:"im danh mi ngy",style:{fontSize:16,fontFamily:"Archia Medium"}});n.anchor.set(0,0),n.position.set(.05*Xo.width+50,120),this.addChild(n);const r={x:.05*Xo.width+20,y:160},s={x:.05*Xo.width+20,y:230},o=Xo.GameConfig.dailyGold;for(let e=0;e<o.length;e++)e<4?this.addCheckInDay(e,75*e,0,r,o[e],t>e+1):this.addCheckInDay(e,75*(e-4),0,s,o[e],t>e+1)}addCheckInDay(t,e,i,n,r,s){const o=(new qt.A).roundRect(n.x+e,n.y+i,60,55,10).fill("white"),a=new re({text:"Ngy "+(t+1),style:{fontFamily:"Archia Medium",fontSize:14}}),l=te.k.from("currency");l.position.set(n.x+e+6,n.y+i+32),l.width=15,l.height=15,a.position.set(n.x+e+5,n.y+i+10);const u=new re({text:"+"+r,style:{fill:"green",fontSize:13,fontFamily:"Archia Medium"}});if(u.position.set(n.x+e+3+20,n.y+i+32),this.addChild(o),this.addChild(a),this.addChild(l),this.addChild(u),s){const t=te.k.from("check_icon");t.scale.set(.9),t.position.set(n.x+e+42,n.y+i-10),this.addChild(t),o.filters=[new xu({thickness:2,color:"#453003"})]}}addBackground(){const t=new Ko({width:Xo.width,height:Xo.height,texture:"game_bg"});this.addChild(t);const e=(new qt.A).rect(0,0,Xo.width,60).fill("#FFCF10");this.addChild(e)}update(t){}resize(){}}class dh extends h.mc{constructor(t,e,i){super();const n=.05*Xo.width;this.background=(new qt.A).roundRect(n,0,.9*Xo.width,70,10).fill("white"),this.background.alpha=.7,this.addChild(this.background);const r=new re({text:`#${e.rank}`,style:{fontFamily:"Archia Medium",fontSize:13}});r.anchor.set(.5),r.position.set(n+20,35),this.addChild(r);const s=te.k.from("screaming_sheep");s.width=40,s.height=40,s.anchor.set(.5),s.position.set(n+60,35),this.addChild(s);const o=new re({text:e.displayName,style:{fontFamily:"Archia Medium",fontSize:12}});o.position.set(n+90,35),o.anchor.set(0,.5),this.addChild(o);const a=te.k.from("currency");a.width=25,a.height=25,a.anchor.set(.5),a.position.set(Xo.width-110,35),this.addChild(a);const l=new re({text:`+ ${e.goldRank.toLocaleString()}`,style:{fontSize:13,fontFamily:"Archia Medium"}});l.anchor.set(0,.5),l.position.set(Xo.width-90,35),this.addChild(l)}}class fh extends h.mc{constructor(){var t,e;super(),this.addBackground(),this.addHeader(),null===(e=null===(t=Na.Senders)||void 0===t?void 0:t.Game)||void 0===e||e.sendLeaderboard(),Ua.on(Da.GET_LEADERBOARD,(({params:t})=>{const{myRank:e,ranks:i}=t;this.renderTopRank(i),this.addPlayersList(i,1),this.renderMyRank(e)}))}update(t){}resize(){}addHeader(){const t=(new qt.A).rect(0,0,Xo.width,70).fill("#FFCF10");t.filters=[new Xl({offset:{x:2,y:2}})],this.addChild(t);const e=(new qt.A).rect(0,68,Xo.width,2).fill("white");e.alpha=.7,this.addChild(e);const i=new re({text:"Bng Vng",style:{fontSize:20,fontFamily:"Archia Medium"}});i.anchor.set(.5),i.position.set(Xo.width/2,35),this.addChild(i);const n=te.k.from("back_button");n.position.set(10,18),n.eventMode="static",n.on("pointerup",(t=>{Xo.changeScreen(new _h)})),this.addChild(n)}addBackground(){const t=new Ko({width:Xo.width,height:Xo.height,texture:"game_bg"});this.addChild(t);const e=(new qt.A).rect(0,0,Xo.width,60).fill("#FFCF10");this.addChild(e);const i=te.k.from("leader_cup");i.anchor.set(.5),i.position.set(Xo.width/2,140),i.scale.set(.5),this.addChild(i)}addPlayersList(t,e){let i=[];if(t&&t.length&&t.length>e)for(let n=e-1;n<t.length;n++){const e=new dh(n,t[n],this);i.push(e)}const n=Xo.height/2.3,r=new uh({width:Xo.width,height:Xo.height-n,elementsMargin:10,bottomPadding:10,items:i});r.position.set(0,n),this.addChild(r)}renderTopRank(t){t.length>3&&(this.addTopRank(t[1],{x:-120,y:10}),this.addTopRank(t[0],{x:0,y:-40}),this.addTopRank(t[2],{x:120,y:10}))}addTopRank(t,e){const i=te.k.from("screaming_sheep");i.width=80,i.height=80,i.anchor.set(.5),i.position.set(Xo.width/2+e.x,Xo.height/2-200+e.y),this.addChild(i);const n=new re({text:t.displayName.toUpperCase(),style:{fontSize:15,fontFamily:"Archia Medium"}});n.anchor.set(.5),n.position.set(Xo.width/2+e.x,Xo.height/2-145+e.y),this.addChild(n);const r=new re({text:`+${t.goldRank.toLocaleString()}`,style:{fontSize:13,fontFamily:"Archia Medium"}});r.position.set(Xo.width/2+e.x-(r.width/2-20),Xo.height/2-125+e.y),this.addChild(r);const s=te.k.from("currency");s.width=20,s.height=20,s.position.set(Xo.width/2+e.x-(r.width/2+5),Xo.height/2-126+e.y),this.addChild(s)}renderMyRank(t){const e=new dh(t.rank,t,this);this.addChild(e),e.background.alpha=1,e.filters=[new Xl],e.position.set(0,Xo.height-100)}}class ph extends h.mc{constructor(t,e){super(),this.toastHeight=50,this.duration=300,this.eslapseTime=0;const i=(new qt.A).rect(0,0,Xo.width,this.toastHeight).fill("black");i.alpha=.5,this.addChild(i);const n=new re({text:t,style:{fontFamily:"Archia Medium",fontSize:20,fill:"white"}});if(n.anchor.set(.5),n.position.set(Xo.width/2,this.height/2),this.addChild(n),e){const t=te.k.from(e);t&&(t.width=30,t.height=30,t.anchor.set(.5),t.position.set(Xo.width/2-n.width/2-20,this.height/2),this.addChild(t))}this.position.set(0,Xo.height),Rr.to(this.position,{x:0,y:Xo.height-this.toastHeight,ease:"bounce"}),this.startPop=!0}update(t){this.startPop&&(this.eslapseTime<this.duration?this.eslapseTime+=t:(Rr.to(this.position,{x:0,y:Xo.height,ease:"sine"}),this.eslapseTime=0,this.startPop=!1))}resize(){}}const mh={width:300,height:100,title:"Fair Trade",description:"Dont let them run",buttonText:"i Xu",onClick:()=>{}};class gh extends h.mc{constructor(t={}){super();const e=Object.assign(Object.assign({},mh),t),{title:i,width:n,height:r,description:s}=e,o=(new qt.A).roundRect(0,0,n,r,30).fill("orange");o.filters=[new Al({type:0,angle:0,stops:[{color:"#E6C539",alpha:1,offset:1},{color:"#FFB725",alpha:1,offset:.8},{color:"#F02C2C",alpha:1,offset:0}]}),new xu({color:"white",thickness:4})],o.position.set((Xo.width-n)/2,0),this.addChild(o);const a=new re({text:i,style:{fontFamily:"Archia Medium",fontSize:22,fill:"white"}});a.anchor.set(.5),a.position.set(Xo.width/2,o.position.y+30),a.filters=[new Xl],this.addChild(a);const l=(new qt.A).roundRect(0,0,.9*n,.6*r).fill("#FFF0DD");l.position.set(o.position.x+20,o.position.y+o.height-20-.6*r),this.addChild(l);const u=new re({text:s,style:{fontSize:17,wordWrapWidth:.8*l.width,wordWrap:!0,fontFamily:"Archia Medium"}});u.position.set(l.position.x+15,l.position.y+20),this.addChild(u),this.position.set(0,-o.height);const h=new _a({width:180,height:80,texture:"white_border_button",text:e.buttonText,fill:16777215,onClick:()=>{e.onClick()}});h.position.set(Xo.width/2,l.position.y+l.height-50),this.addChild(h);const c=te.k.from("close_modal");c.anchor.set(.5),c.width=60,c.height=60,c.position.set(o.position.x+o.width/2,o.position.y+o.height+60),c.on("pointerup",(t=>{Xo.closeCurrentPopup()})),c.eventMode="static",this.addChild(c),Rr.to(this.position,{x:0,y:Xo.height/4,ease:"bounce"})}update(t){}resize(){}focus(){}blur(){}pause(){}}var vh=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class yh extends h.mc{constructor(){var t,e;super(),this.vui=0,this.vuiBalance=new re,this.addBackground(),this.addHeader(),null===(e=null===(t=Na.Senders)||void 0===t?void 0:t.Game)||void 0===e||e.sendShop(),Ua.on(Da.GET_SHOP,(({params:t})=>{const{vui:e,shop:i}=t;let n=[];if(i&&i.length){for(let t=0;t<Math.ceil(i.length/2);t++){const e=2*t;let r=new h.mc;const s=this.renderShopPackage(i[e]);if(s.position.set(Xo.width/2-s.width-10,0),r.addChild(s),i[e+1]){const t=this.renderShopPackage(i[e+1]);t.position.set(Xo.width/2+10,0),r.addChild(t)}console.log("push"),n.push(r)}const t=Xo.height/8,e=new uh({width:Xo.width,height:Xo.height-t,elementsMargin:10,bottomPadding:10,items:n});e.position.set(0,t),this.addChild(e)}e&&(this.vui=e,this.renderVUIBalance(e))})),Ua.on(Da.TOAST,(({params:t})=>{Xo.popToast(new ph(t.message,t.iconType))}))}update(t){}resize(){}addHeader(){const t=(new qt.A).rect(0,0,Xo.width,70).fill("#FFCF10");t.filters=[new Xl({offset:{x:2,y:2}})],this.addChild(t);const e=(new qt.A).rect(0,68,Xo.width,2).fill("white");e.alpha=.7,this.addChild(e);const i=new re({text:"i XU",style:{fontSize:20,fontFamily:"Archia Medium"}});i.anchor.set(.5),i.position.set(Xo.width/2,35),this.addChild(i);const n=te.k.from("back_button");n.position.set(10,18),n.eventMode="static",n.on("pointerup",(t=>{Xo.changeScreen(new _h)})),this.addChild(n)}renderVUIBalance(t){const e=te.k.from("vui_balance");e.anchor.set(1,.5),e.position.set(Xo.width-10,40),this.addChild(e),this.vuiBalance=new re({text:t.toLocaleString(),style:{fontFamily:"Archia Medium",fontSize:13,fill:"white"}}),this.vuiBalance.anchor.set(0,.5),this.vuiBalance.position.set(e.position.x-e.width+40,32),this.addChild(this.vuiBalance)}addBackground(){const t=new Ko({width:Xo.width,height:Xo.height,texture:"game_bg"});this.addChild(t)}renderShopPackage(t){console.log(t);const e=new h.mc,i=te.k.from("package"),n=i.width/i.height;i.width=Xo.width/2.2,i.height=i.width/n,e.addChild(i),this.loadRemoteImagePath(t.imagePath,e);const r=new re({text:t.value.toLocaleString(),style:{fontSize:18,fontFamily:"Archia Medium"}});r.anchor.set(.5),r.position.set(e.width/2,e.height-100),e.addChild(r);const s=te.k.from("currency");s.width=22,s.height=22,s.anchor.set(1,.5),s.position.set(e.width/2-(r.width/2+5),e.height-100),e.addChild(s);const o=new _a({text:t.price,texture:"white_border_button",width:140,height:60,fill:16777215,fontSize:18,icon:"vui_icon",iconSize:22,onClick:()=>{Xo.popModal(new gh({width:.85*Xo.width,height:Xo.height/3,title:"i xu",description:"Bn mun i theo gi ny ?",buttonText:"i ngay",onClick:()=>{var e,i;null===(i=null===(e=Na.Senders)||void 0===e?void 0:e.Game)||void 0===i||i.sendBuyPackage(t.id),this.vui-=t.price,this.vuiBalance.text=this.vui.toLocaleString(),Xo.closeCurrentPopup()}}))}});return o.anchor.set(.5),o.position.set(e.width/2,e.height-40),e.addChild(o),e}loadRemoteImagePath(t,e){return vh(this,void 0,void 0,(function*(){try{const i=yield Tt.load(t),n=te.k.from(i);n.anchor.set(.5),n.position.set(e.width/2,e.height/3);const r=n.width/n.height;n.width=60,n.height=n.width/r,e.addChild(n)}catch(t){console.log(t)}}))}blur(){this.filters=[new Gt]}focus(){this.filters=[]}}var xh=r(6908);class _h extends h.mc{constructor(){super(),this.remainRewardTime=0,this.eslapse=0,this.tick=100,this.addBackground(),this.addHeader(),this.addCurrentCoin(),this.addPlayerInfo(),this.addLogo("game_logo"),this.debugText=new re({style:{fontSize:13}}),this.addPlayButton(),this.addLeaderBoardButton(),this.addHtPButton(),this.addMissionButton(),this.remainRewardTimeUI=new re({style:{fontFamily:"Archia Medium",fontSize:12}}),this.rewardBag=new _a({width:90,height:90,offsetSlides:[2,2,2,2],texture:"check_in_btn",onClick:()=>{var t,e;this.rewardBag.interactive=!1,this.rewardBag.filters=[new nu],this.remainRewardTime<=0&&(null===(e=null===(t=Na.Senders)||void 0===t?void 0:t.Game)||void 0===e||e.sendOpenGiftTime())}}),this.addDailyReward(),this.addSettingButton(),Ua.on(Da.TOAST,(({params:t})=>{this.remainRewardTimeUI.visible=!0,this.remainRewardTime=Xo.GameConfig.giftTimeSecond,Xo.popToast(new ph(t.message,t.iconType))})),Ua.on(Da.MESSAGE_BOX,(({params:t})=>{Xo.popModal(new gh({width:.85*Xo.width,height:Xo.height/3,title:t.title,description:t.message,buttonText:"OK",onClick:()=>{Xo.closeCurrentPopup()}}))}));var t=new xh({threshold:15,timeout:1e3});this.debugText.text=`${window.ondevicemotion}`,t.start(),this.debugText.text=`is context secure: ${window.isSecureContext}`,window.addEventListener("shake",(function(){alert("shake!")}),!1),window.addEventListener("devicemotion",(t=>{this.debugText.text=`${t.acceleration.x} m/s2`,console.log(`${t.acceleration.x} m/s2`)}))}update(t){this.eslapse>this.tick&&(this.eslapse=0,this.remainRewardTime>0&&(this.remainRewardTime--,this.remainRewardTimeUI.text=Hu(this.remainRewardTime)),this.remainRewardTime<=0&&0==this.rewardBag.interactive&&(this.rewardBag.interactive=!0,this.rewardBag.filters=[],this.remainRewardTimeUI.visible=!1)),this.eslapse+=t}resize(){}onStartGameClick(){console.log("on start game click"),Xo.changeScreen(new ju)}addLogo(t){const e=te.k.from(t);e.anchor.set(.5),e.position.set(Xo.width/2,Xo.height/2.45),this.addChild(e)}addGameName(){const t=new re({text:"Bu Cua",style:{align:"center",fontSize:40,fontFamily:"Archia Medium",fill:"white",stroke:{color:"black",width:8,join:"round"}}});t.position.set(Xo.width/2,Xo.height/2.2),t.anchor.set(.5),this.addChild(t)}addPlayButton(){const t=new _a({width:208,height:86,onClick:this.onStartGameClick,texture:"play_btn"});t.position.set(Xo.width/2,Xo.height/1.4),this.addChild(t),this.debugText&&(this.debugText.position.set(0,t.position.y+50),this.debugText.text="Debug",this.addChild(this.debugText))}addMissionButton(){const t=new _a({width:90,height:90,texture:"mission_btn",onClick:()=>{Xo.changeScreen(new ch)}});t.position.set(50,125),this.addChild(t)}addHtPButton(){const t=new _a({width:150,height:60,texture:"htp_btn",onClick:this.onStartGameClick});t.position.set(Xo.width/2+80,Xo.height-60),this.addChild(t)}addLeaderBoardButton(){const t=new _a({width:150,height:60,texture:"leaderboard_btn",onClick:()=>{Xo.changeScreen(new fh)}});t.position.set(Xo.width/2-80,Xo.height-60),this.addChild(t)}addBackground(){const t=new Ko({width:Xo.width,height:Xo.height,texture:"game_bg"});this.addChild(t)}addWheel(){const t=te.k.from("border_circle");t.position.set(0,Xo.height/2-160),t.width=80,t.height=80;const e=new re({text:"0",style:{fill:"black",fontSize:30}});this.addChild(t),this.addChild(e),e.position.set(t.position.x+60,t.position.y+50),e.text=`${Xo.GameConfig.luckySpinDaily}`}addDailyReward(){this.rewardBag.position.set(Xo.width-50,125),this.remainRewardTime=Xo.PlayerData.remainingGiftTime,this.addChild(this.rewardBag),this.addChild(this.remainRewardTimeUI),this.remainRewardTimeUI.position.set(this.rewardBag.position.x-25,this.rewardBag.position.y+30),this.remainRewardTime>0&&(this.remainRewardTimeUI.text=Hu(this.remainRewardTime),this.rewardBag.filters=[new nu],this.rewardBag.interactive=!1)}addCurrentCoin(){const t=new h.mc,e=(new qt.A).rect(0,0,110,25).fill("#453003");e.position.set(20,3);const i=te.k.from("currency");i.width=30,i.height=30;const n=new re({text:Xo.PlayerData.gold.toLocaleString(),style:{fontSize:15,fill:"white",fontFamily:"Archia Medium",align:"right"}});n.anchor.set(1,0),n.position.set(115,5);const r=new _a({width:25,height:25,texture:"add_coin_btn",onClick:()=>{Xo.changeScreen(new yh)}});r.position.set(128,15),t.addChild(e),t.addChild(i),t.addChild(n),t.addChild(r),this.addChild(t),t.position.set(Xo.width-200,15)}addSettingButton(){const t=new _a({width:30,height:30,texture:"setting_btn",onClick:()=>{}});t.position.set(Xo.width-30,30),this.addChild(t)}addPlayerInfo(){const t=new re({text:Xo.PlayerData.displayName,style:{fontSize:15}});this.addChild(t),t.position.set(10,20)}addHeader(){const t=(new qt.A).rect(0,0,Xo.width,70).fill("#FFCF10");t.filters=[new Xl({offset:{x:2,y:2}})],this.addChild(t);const e=(new qt.A).rect(0,68,Xo.width,2).fill("white");e.alpha=.7,this.addChild(e)}blur(){this.filters=[new Gt]}focus(){this.filters=[]}}const bh={name:"prod",apiEndPoint:"https://lb.thitranbaovui.com/v1",assetEndPoint:"https://lb.thitranbaovui.com/v1",ssl:!0,host:"lb.thitranbaovui.com",port:80};class wh{__httpGet(t,e){return new Promise(((i,n)=>{let r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4==r.readyState&&r.status>=200&&r.status<400){var t=r.responseText;return i({status:r.status,data:JSON.parse(t)})}},r.addEventListener("error",(function(t){n(t)})),r.open("GET",t,!0),e){let t=e.headers;Object.keys(t).forEach((e=>{r.setRequestHeader(e,t[e])}))}else r.setRequestHeader("Content-Type","application/json");r.send()}))}__httpPost(t,e,i){return new Promise(((n,r)=>{let s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4==s.readyState&&s.status>=200&&s.status<400){var t=s.responseText;return n({status:s.status,data:JSON.parse(t)})}},s.addEventListener("error",(function(t){r(t)})),s.open("POST",t),i){let t=i.headers;Object.keys(t).forEach((e=>{s.setRequestHeader(e,t[e])}))}else s.setRequestHeader("Content-Type","application/json");s.send(JSON.stringify(e))}))}__httpPut(t,e,i){return new Promise(((n,r)=>{let s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4==s.readyState&&s.status>=200&&s.status<400){var t=s.responseText;return n({status:s.status,data:JSON.parse(t)})}},s.addEventListener("error",(function(t){r(t)})),s.open("PUT",t),i){let t=i.headers;Object.keys(t).forEach((e=>{s.setRequestHeader(e,t[e])}))}else s.setRequestHeader("Content-Type","application/json");s.send(JSON.stringify(e))}))}__httpDelete(t,e){return new Promise(((i,n)=>{let r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4==r.readyState&&r.status>=200&&r.status<400){var t=r.responseText;return i({status:r.status,data:JSON.parse(t)})}},r.addEventListener("error",(function(t){n(t)})),r.open("DELETE",t,!0),e){let t=e.headers;Object.keys(t).forEach((e=>{r.setRequestHeader(e,t[e])}))}else r.setRequestHeader("Content-Type","application/json");r.send()}))}}var Sh=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))};const Ch=new class extends wh{constructor(){super(),this._token=null,this.uid="null",this._env=null,this._accessTokenData=null,this._env=function(){const t=globalThis.ENV;return t?{name:t.name,apiEndPoint:t.apiEndPoint,assetEndPoint:t.assetEndPoint||t.assetsEndPoint,ssl:t.ssl,host:t.host,port:t.port}:bh}()}get environment(){return this._env}set environment(t){this._env=t}getAPIEndPoint(){return this._env?this._env.apiEndPoint:""}__signInSuccessHandler(t){this._accessTokenData=t,this._token=t.token||t.accessToken,this.uid=t.id}__makeHeader(t=!1){return!!t&&{header:{"Content-Type":"application/json",Authorization:`Bearer ${this._token}`}}}__parseResponse(t){let e=t.data;if((200===t.status||201===t.status)&&e&&e.status)return e;throw new Error("Invalid data format")}__parseReponseWithError(t){let e=this.__parseResponse(t);if(e){if(401===e.status.code)return console.log("show error dialog"),null;if(e.status.success)return e}return null}__errorHandler(t){console.log(t.message)}signInByTapTap(t){return Sh(this,void 0,void 0,(function*(){const e=`${this.getAPIEndPoint()}/auth/sign-in-taptap`;try{console.log("start calling",e,t);let i=yield this.__httpPost(e,{token:t},{headers:{"Content-Type":"application/json"}});console.log("result",i);let n=this.__parseResponse(i);if(n){if(n.status.success)return console.log("sign-in-taptap success"),this.__signInSuccessHandler(n.data),n.data;Ua.emit(Da.LOADING_MESSAGES,n.status.message)}return null}catch(t){return console.log("catch",t),this.__errorHandler(t),null}}))}checkToken(t){return Sh(this,void 0,void 0,(function*(){const e=`${this.getAPIEndPoint()}/auth/token`;try{let i=yield this.__httpGet(e,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),n=this.__parseResponse(i);if(n){if(n.status.success)return this._token=t,n.data;console.log(n.status.message)}return null}catch(t){return this.__errorHandler(t),null}}))}},Ah={getAccessTokenByKey(t,e){const i=`key_${t}`;return e=e||localStorage,console.log(`get ${i}`),e.getItem(i)},setAccessTokenByKey(t,e,i){const n=`key_${t}`;i=i||localStorage,console.log(`save ${n} with value: ${e}`),i.setItem(n,e)}};var Th=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))};const Ph=new class{login(t){return Th(this,void 0,void 0,(function*(){try{if(yield this._loginWithExistToken(t))return void console.log("_loginWithExistToken");let e=yield Ch.signInByTapTap(t);if(e){const t=e.token||e.accessToken;if(t&&Ch.environment){(yield this.connectToServer(t,Ch.environment))&&Ah.setAccessTokenByKey("token",t)}}}catch(t){console.log(t),t&&t.message&&Ua.emit(Da.LOADING_MESSAGES,t.message)}}))}_loginWithExistToken(t){return Th(this,void 0,void 0,(function*(){let t=Ah.getAccessTokenByKey("token");if(t){let e=yield Ch.checkToken(t);if(e&&Ch.environment){if(yield this.connectToServer(e.token,Ch.environment))return!0}}return console.log("--token null or expired--"),!1}))}connectToServer(t,e){return Th(this,void 0,void 0,(function*(){return!(!t||!(yield Na.basicAuthen(t).connect(e.host,e.port,e.ssl)))&&(console.log("connect server success"),!0)}))}__parseTokenFromURL(){let t=window.location.search;if(t.length>0){return new URLSearchParams(t).get("token")}let e=window.location.href||window.location.toString(),i=e.lastIndexOf("/");if(-1!==i){let t=e.substring(i+1);if(t&&!t.includes("."))return t.trim()}return null}};var Mh=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class Ih extends h.mc{constructor(){super(),this.assetLoaded=!1,this.socketConnected=!1,this.loading=!0,this.loadingTextUI=new re,this.loadingTextUI=new re({text:"Loading"}),this.loadingTextUI.anchor.set(.5),this.loadingTextUI.position.set(Xo.width/2-this.loadingTextUI.width,Xo.height/2),this.addChild(this.loadingTextUI),this.initializeLoader().then((()=>{console.log("--- asset loaded ---"),this.assetLoaded=!0})),this.connectSocket(),Ua.on(Da.GET_DATA,(t=>{console.log("--- socket connected ---"),this.socketConnected=!0;const e=t.params.leaderboard,i=t.params.player;Xo.GameConfig={chipList:e.chipList,closeTime:e.closeTime,endTime:e.endTime,startTime:e.startTime,dailyGold:e.dailyGold,giftTimeGold:e.giftTimeGold,giftTimeSecond:e.giftTimeSecond,gameBgImagePath:e.gameBgImagePath,homeBgImagePath:e.homeBgImagePath,isPublic:e.isPublic,leaderBoardId:e.leaderBoardId,luckySpinDaily:e.luckySpinDaily,luckySpintData:e.luckySpintData,maxTurnBet:e.maxTurnBet,shop:e.shop,rankRewards:e.rankRewards},Xo.PlayerData={displayName:i.displayName,gold:i.gold,leaderboardId:i.leaderboardId,luckySpinTurn:i.luckySpinTurn,remainingGiftTime:i.remainingGiftTime,userId:i.userId}})),Ua.on(Da.LOADING_MESSAGES,(t=>{this.loadingTextUI.text=t,this.loadingTextUI.position.set(Xo.width/2,Xo.height/2)}))}connectSocket(){return Mh(this,void 0,void 0,(function*(){var t,e;const i=Ph.__parseTokenFromURL();if(i)try{console.log("connect socket..."),this.loadingTextUI.text="connect socket...",yield Ph.login(i),null===(e=null===(t=Na.Senders)||void 0===t?void 0:t.Game)||void 0===e||e.sendGetData()}catch(t){console.log("fail login",t),t&&t.message&&(this.loadingTextUI.text=t.message)}}))}initializeLoader(){return Mh(this,void 0,void 0,(function*(){console.log("load asset.."),yield Tt.init({manifest:Yo});const t=Yo.bundles.map((t=>t.name));yield Tt.loadBundle(t)}))}gameLoaded(){Xo.changeScreen(new _h)}update(t){this.loading&&this.socketConnected&&this.assetLoaded&&(this.gameLoaded(),this.loading=!1)}resize(){}}var Oh=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))};Oh(void 0,void 0,void 0,(function*(){yield Xo.initialize(1087931),Xo.changeScreen(new Ih)}))})()})();